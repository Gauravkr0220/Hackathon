A Uniformly Bounded Correlation Function
for Spatial Point Patterns
Evgenia Martynova
evgenia.martynova@radboudumc.nl
Radboud University Medical Center
Nijmegen, The NetherlandsJohannes Textor
johannes.textor@ru.nl
Radboud University
Nijmegen, The Netherlands
ABSTRACT
A point pattern is a dataset of coordinates, typically in 2D or 3D
space. Point patterns are ubiquitous in diverse applications includ-
ing Geographic Information Systems, Astronomy, Ecology, Biology
and Medicine. Among the statistics used to quantify point pat-
terns, most are based on Ripleyâ€™s ğ¾-function, which measures the
deviation of the observed pattern from a completely random ar-
rangement of points. This approach is useful for constructing null
hypothesis tests, but Ripleyâ€™s ğ¾and its variants are less suitable as
quantitative effect sizes because their ranges and expected values
generally depend on the scale or the size of the region in which
the pattern is observed. To address this, we propose a new function
that behaves like a correlation coefficient for point patterns: it is
tightly bounded by -1 and 1, with a value of -1 corresponding to a
maximally dispersed arrangement of points, 0 indicating complete
spatial randomness, and 1 representing maximal clustering. These
properties are independent of scale and observation window size
assuming appropriate edge correction. Evaluating our function on
simulated data, we show that it has comparable statistical calibra-
tion and power to ğ¾-based baselines. We hope that the ease of
interpretation of our bounded function will facilitate the analysis
of spatial data across multiple fields.
CCS CONCEPTS
â€¢Mathematics of computing â†’Multivariate statistics; Cluster
analysis ; Exploratory data analysis.
KEYWORDS
spatial statistics, point pattern analysis, clustering
ACM Reference Format:
Evgenia Martynova and Johannes Textor. 2024. A Uniformly Bounded Cor-
relation Function for Spatial Point Patterns. In Proceedings of the 30th ACM
SIGKDD Conference on Knowledge Discovery and Data Mining (KDD â€™24),
August 25â€“29, 2024, Barcelona, Spain. ACM, New York, NY, USA, 12 pages.
https://doi.org/10.1145/3637528.3671891
1 INTRODUCTION
Stars in the sky, buildings in cities, fishes in the sea, cells in tissues,
and molecules on cell membranes are just a few examples of ob-
jects whose spatial configuration can be represented and analyzed
This work is licensed under a Creative Commons Attribution
International 4.0 License.
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Â©2024 Copyright held by the owner/author(s).
ACM ISBN 979-8-4007-0490-1/24/08.
https://doi.org/10.1145/3637528.3671891aspoint patterns : sets of points in 2D or 3D space. Technological
advances like automated digital microscopy have increased the va-
riety and size of available point pattern datasets. Spatial statistics is
a mature field that has produced well-established methodology to
analyze point patterns. The most important and fundamental point
pattern statistic is perhaps Ripleyâ€™s ğ¾-function [ 24], which com-
pares the number of neighbors of a random point within distance ğ‘Ÿ
to its expectation for a random spatial distribution. Higher values
ofğ¾indicate clustering, whereas lower values indicate dispersion
between objects. Various statistical significance tests have been
developed for ğ¾and its variants [1].
Spatial statistics is widely used in some fields, such as Ecology [ 4]
and Epidemiology [ 12], but less so in others like Molecular Biology
[3] or Pathology [ 33]. For instance, although there are applications
of Ripleyâ€™sğ¾to cell positions in tumor samples [ 38], simpler region-
based [ 5,18] or nearest-neighbor [ 15] analyses are more common.
These methods are easier to interpret, but as pointed out by Wilson
et al. [38], they are affected by various artefacts such as border
effects, density-dependence, and spatial heterogeneity that Ripleyâ€™s
ğ¾and its variants are designed to avoid.
This work is based on the hypothesis that the low adoption of
spatial statistics in some fields may be in part due to the lack of
a simple quantitative effect size. ğ¾is not an effect size because
its scale is proportional to the area of the region wherein a point
pattern is mapped, which makes it difficult to compare ğ¾values
across different samples and assess the scientific importance of
a statistically significant ğ¾. To address this issue, we propose a
statistic LCF(ğ‘Ÿ)that is based on Ripleyâ€™s ğ¾and has the following
properties:
(1) LCF(ğ‘Ÿ)is limited to the range [âˆ’1,1];
(2) For a random point pattern, LCF (ğ‘Ÿ)=0asymptotically;
(3)For a maximally clustered point pattern (i.e., all points over-
lap), LCF(r) =1.
(4)For a lattice, LCF(ğ‘Ÿ)=âˆ’1ifğ‘Ÿis smaller than the distance
between nearest neighbors.
These properties are inspired by the linear correlation coeffi-
cients that most scientists are familiar with. This motivates us to
call our statistic a local correlation function, LCF. Like all ğ¾-based sta-
tistics, LCF is a function of the spatial scale ğ‘Ÿ, which is an important
property because clustering and dispersion are not scale-invariant.
To our knowledge, there is no other ğ¾-based statistic that has simi-
lar properties to aid interpretation of the results. Moreover, as we
will show, naive centering and scaling of ğ¾do not result in a metric
that satisfies (1) - (4).
2177
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
This paper is structured as follows: first, we derive ğ¿ğ¶ğ¹(ğ‘Ÿ)based
on the above properties, discuss its relation to other ğ¾-based statis-
tics, and illustrate some of its fundamental properties using simu-
lated point patterns. Next, we empirically examine the calibration
and power of statistical tests constructed on LCF and show that
they are comparable to those of other ğ¾-based statistics. Finally, we
demonstrate how LCF(r) can be applied in practice by analyzing
the positions of immune cells in tumor biopsies and the locations
of air pollution and waste generation facilities.
2 BACKGROUND & RELATED WORK
2.1 Preliminaries and Definitions
Apoint pattern ğ‘ƒ={ğ‘1,...,ğ‘ğ‘›}withğ‘ğ‘–âˆˆğ‘Šis a set ofğ‘› ğ‘‘-
dimensional points contained in an observation window ğ‘ŠâŠ‚Rğ‘‘
with (hyper) volume |ğ‘Š|. For instance, a forest could be described
as a point pattern, where ğ‘Šis the 2D region considered as the
forest andğ‘ğ‘–are the positions of the trees. A point processPis a
random element whose realizations are point patterns in ğ‘Š. For
example, complete spatial randomness (CSR) â€“ or a Poisson point
process â€“ is a point process where ğ‘›follows a Poisson distribution
with parameter ğœ†|ğ‘Š|and, conditioned on a given ğ‘›, theğ‘ğ‘–are inde-
pendently drawn from the uniform distribution on ğ‘Š. The average
number of points per unit area ğœ†=E[ğ‘›]/|ğ‘Š|is called the intensity
of a point process and it uniquely defines a Poisson point process.
Generally, intensity can be a function of spatial location, but in this
work we consider only homogeneous intensity. An important basic
statistic to characterize point processes is the expected number of
neighbours of a random point within radius ğ‘Ÿ, which we denote as
ğ‘(ğ‘Ÿ). More formally, for a given point process Pand pointğ‘âˆ—âˆˆğ‘Š,
we define
ğ‘(ğ‘âˆ—,ğ‘Ÿ)=Eğ‘ƒâˆˆP[number of points in ğ‘ƒat distanceâ‰¤ğ‘Ÿofğ‘âˆ—]
(1)
and
ğ‘(ğ‘Ÿ)=Eğ‘ƒâˆˆP[Eğ‘âˆ—âˆˆğ‘ƒ[ğ‘(ğ‘âˆ—,ğ‘Ÿ)]]. (2)
Non-random point patterns can be characterized by comparison
to CSR. For example, clustering (perhaps caused by attraction be-
tween objects) can be defined as a local intensity of points that is
higher than expected from CSR; by contrast, dispersion (perhaps
caused by repulsion or inhibition) leads to a lower than expected
number of points near a reference point. Point patterns can exhibit
different characteristics at different spatial scales; e.g., a point pat-
tern consisting of dense clusters arranged on a 2D grid is clustered
at small scales and dispersed at the distance between clusters.
Various summary functions have been proposed to quantify and
test the non-randomness of point patterns at different spatial scales.
The influential Ripleyâ€™sğ¾-function is defined as:
ğ¾(ğ‘Ÿ)=ğœ†âˆ’1ğ‘(ğ‘Ÿ) (3)
Normalization by ğœ†allows comparing patterns of different den-
sities. Formally, ğ¾is a property of the underlying point process
that gave rise to an observed pattern; for a given point pattern, it is
empirically estimated as follows:
Ë†ğ¾(ğ‘Ÿ)=Ë†ğœ†âˆ’1Ë†ğ‘(ğ‘Ÿ)Ë†ğ‘(ğ‘Ÿ)=1
ğ‘›ğ‘›âˆ‘ï¸
ğ‘–=1âˆ‘ï¸
ğ‘—â‰ ğ‘–1(ğ‘‘ğ‘–ğ‘—<ğ‘Ÿ)ğ‘’ğ‘–ğ‘—(ğ‘Ÿ) (4)where 1is the indicator function and ğ‘‘ğ‘–ğ‘—is the Euclidean distance be-
tween points. The edge correction weight ğ‘’ğ‘–ğ‘—(ğ‘Ÿ)accounts for points
near the boundary of ğ‘Šfor which some neighbors within distance
ğ‘Ÿmight be unobserved. Many different edge correction methods
have been proposed [ 13,20,26]; throughout the paper, we assume
that the weights are chosen such that the monotonicity of ğ‘(ğ‘Ÿ)
is preserved, which is usually the case. The intensity ğœ†is often
assumed to be homogeneous and for convenience is estimated as
Ë†ğœ†=(ğ‘›âˆ’1)/|ğ‘Š|, since the number of neighbors is at most ğ‘›âˆ’1.
For example, for CSR in two dimensions, ğ¾(ğ‘Ÿ)=ğœ‹ğ‘Ÿ2.
To facilitate interpretation and testing deviation from CSR, sev-
eral variants of ğ¾have been proposed; here we focus on two
important ones in the two-dimensional case. First, the function
ğ»(ğ‘Ÿ)=âˆšï¸
ğ¾(ğ‘Ÿ)/ğœ‹âˆ’ğ‘Ÿhas expectation 0 and approximately constant
variance under CSR [ 6,25]. Since it is centered at 0 and depends on
ğ‘Ÿlinearly, visual assessment of ğ»is much easier. Second, the pair
correlation function (PCF) defined by
ğ‘ƒğ¶ğ¹(ğ‘Ÿ)=ğ¾â€²(ğ‘Ÿ)
2ğœ‹ğ‘Ÿ
isnon-cumulative, i.e., its value refers only to interpoint distances
equal toğ‘Ÿ, not all distancesâ‰¤ğ‘Ÿas for K and H. Thus, PCF is better
suited for accessing spatial dynamics at a given scale.
Allğ¾-based functions can be extended to quantify the co-localization
of two types of objects; for example, for a point process Pwith
multiple types of objects, the cross-ğ¾-function is defined as:
ğ¾ğ‘–ğ‘—(ğ‘Ÿ)=ğœ†âˆ’1
ğ‘—E[the number of neighbors of type ğ‘—within
distanceğ‘Ÿof a random point of type ğ‘–]
which can be estimated by
Ë†ğ¾ğ‘–ğ‘—(ğ‘Ÿ)=Ë†ğœ†âˆ’1
ğ‘—Ë†ğ‘ğ‘–ğ‘—(ğ‘Ÿ)Ë†ğ‘ğ‘–ğ‘—(ğ‘Ÿ)=1
ğ‘›ğ‘–ğ‘›ğ‘–âˆ‘ï¸
ğ‘˜=1ğ‘›ğ‘—âˆ‘ï¸
ğ‘™=11(ğ‘‘ğ‘˜ğ‘™<ğ‘Ÿ)ğ‘’ğ‘˜ğ‘™(ğ‘Ÿ)(5)
Hereğ‘›ğ‘–(ğ‘›ğ‘—) is the number of points of type ğ‘–(ğ‘—).
2.2 Related Work
Recent work in spatial statistics has focused on domain-specific
adaptations of the classical summary functions defined above. For
instance, cross-PCF extensions that account for the properties of
multi-channel microscopy data have been proposed: the neigh-
borhood correlation function distinguishes different types of co-
localization between 3 types of cells in tissue images [ 8], whereas
the weighted pair correlation function (wPCF) accounts for a pos-
sible uncertainty in cell type assignment [ 7]. Motivated by the
need in microbiology to analyze protein distribution on the cellu-
lar membrane of bacteria, Ward et al. proposed a generalized test
of CSR on arbitrary 3D convex shapes instead of Euclidean space
[36]. To address important spatial heterogeneities that arise in an-
imal ecology, Schiffers et al. investigated using the derivative of
the PCF as a new summary function [ 28]. Other relevant research
aims at estimating interaction distances from summary functions.
For example, Kiskowski et al. proposed using[ğ»ğ‘šğ‘ğ‘¥]or[ğ»â€²
ğ‘šğ‘–ğ‘›]to
estimate cluster diameters in a point pattern [16].
In contrast to these works, our research focuses on the require-
ment of a bounded and interpretable scale. The Hopkins statistic
of cluster tendency is bounded between 0and1and its expected
value for CSR is 0.5; however, it is a global index that aggregates
2178A Uniformly Bounded Correlation Function
for Spatial Point Patterns KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
information across all spatial scales [ 14]. The well-known nearest-
neighbor and empty-space summary functions are scale-specific
and bounded between 0and1[10]. However, their values are hard
to interpret as effect sizes because they are cumulative distribution
functions. A seemingly simple approach to obtaining a summary
function limited to [âˆ’1,1]and with an expected value of 0for CSR
is to normalize the H-function, the centered version of ğ¾, by its
maximum value [ 37]; we denote this normalized version as ğ»1(ğ‘Ÿ).
As can be seen from Equation 4, ğ¾â€™s supremum is generally not
constant: sup Ë†ğ¾(ğ‘Ÿ)=Ë†ğœ†âˆ’1ğ‘›âˆ’1Ãğ‘›
ğ‘–=1Ã
ğ‘—â‰ ğ‘–ğ‘’ğ‘–ğ‘—(ğ‘Ÿ). If we assume that
all points are observed, the expression simplifies to sup Ë†ğ¾(ğ‘Ÿ)=|ğ‘Š|
asğ‘’ğ‘–ğ‘—(ğ‘Ÿ)=1. Then,ğ»1(ğ‘Ÿ)=ğ»(ğ‘Ÿ)/ğ»ğ‘šğ‘ğ‘¥, ğ»ğ‘šğ‘ğ‘¥=âˆšï¸
|ğ‘Š|/ğœ‹is
bounded between sup Ë†ğ»(ğ‘Ÿ)=1âˆ’ğ‘Ÿ/ğ»ğ‘šğ‘ğ‘¥ andinfË†ğ»(ğ‘Ÿ)=âˆ’ğ‘Ÿ/ğ»ğ‘šğ‘ğ‘¥,
henceğ»1(ğ‘Ÿ)âˆˆ[âˆ’ 1,1]in the interval[0,ğ»ğ‘šğ‘ğ‘¥]. However, as we
will see, the bounds of ğ»1are not tight for all ğ‘Ÿ, and the actually
achievable maximum and minimum values depend on the obser-
vation window size, meaning that our requirements (3) and (4) are
not fulfilled.
In summary, we are not aware of previous work in which a
summary function that meets the requirements stated in the intro-
duction has been designed and formally analyzed.
3 THE LOCAL CORRELATION FUNCTION
In this section, we will derive the local correlation function and
show that it satisfies the requirements outlined in the introduction.
We will continue to discuss its asymptotic properties and estimation
for a given point pattern.
3.1 Derivation and Properties
Our LCF will be based on Ripleyâ€™s ğ¾, or more precisely, on the
underlying summary function ğ‘(ğ‘Ÿ), the expected number of points
within distance ğ‘Ÿof a random point (Equation 2). We first define
notions of â€œmaximalâ€ dispersion and clustering of a point process
that will serve to calibrate the minimum and maximum values of
the LCF, respectively.
Definition 3.1. A point processPwithğ‘(ğ‘Ÿ)=0ismaximally
dispersed at distance ğ‘Ÿ. Ifğ‘(ğ‘Ÿ)>0andğ‘(ğ‘Ÿ)=ğ‘(â„ğ‘Ÿ)for some
â„>1, thenPismaximally clustered at distanceğ‘Ÿ.
For example, the regular 2D square integer lattice Z2is maxi-
mally dispersed at distances ğ‘Ÿ<1; a point process with all points
contained in the unit circle is maximally clustered at ğ‘Ÿâ‰¥2.
Definition 3.1 suggests that a suitable building block for our LCF
is the ratio ğ‘(ğ‘Ÿ)/ğ‘(â„ğ‘Ÿ)for â€œsmallâ€â„(Figure 1A). This quantity
is bounded between 0 and 1, with both bounds being attainable.
In addition, we want the â€œmiddleâ€ of this range to correspond to
CSR. Since under CSR, the points are uniformly distributed in the
observation window, the expected number of points falling in any
regionğ´is proportional to its area, i.e. it is equal to ğœ†|ğ´|. Thus, the
following property holds:
Property 3.1. Takeğ‘Ÿ>0andâ„>1. Then for complete spatial
randomness, ğ‘(â„ğ‘Ÿ)=â„2ğ‘(ğ‘Ÿ).
Property 3.1 motivates a transformation of the ratio ğ‘(ğ‘Ÿ)/ğ‘(â„ğ‘Ÿ)
that maps the minimum value to -1, the maximum value to 1, and
the characteristic value 1/â„2to 0. With this, we arrive at the final
A
rhr
15 units
B
051015H-1.0-0.50.00.51.0LCF0153050100r0153050100rFigure 1: Design principle of LCF. A) LCF compares the
number of points within distances ğ‘Ÿandâ„ğ‘Ÿ(hereâ„=âˆš
2)
from a random point in the given pattern. This is moti-
vated by how the number of neighbors of a reference point
ğ‘âˆ—changes depending on the pattern type. For a dispersed
pattern (left, inhibition distance 15), Ë†ğ‘(ğ‘âˆ—,15)(inner circle)
is smaller than Ë†ğ‘(ğ‘âˆ—,15âˆš
2)(outer circle); for CSR (middle),
Ë†ğ‘(ğ‘âˆ—,15âˆš
2)â‰ˆ 2Ë†ğ‘(ğ‘âˆ—,15); for a clustered pattern (right, clus-
ter radius 15), Ë†ğ‘(ğ‘âˆ—,15âˆš
2)â‰ˆ Ë†ğ‘(ğ‘âˆ—,15)whenğ‘âˆ—is near the
cluster center. See Appendix A.1 for simulation details. B)
Ë†ğ»(ğ‘Ÿ)and Ë†ğ¿ğ¶ğ¹(ğ‘Ÿ)for the patterns from panel A. Dashed lines
show inhibition distance anthe cluster diameter.
LCF formula:
ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=(
2ğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)ğ‘
âˆ’1, ğ‘=ln 2
2 lnâ„, ğ‘(â„ğ‘Ÿ)>0
âˆ’1, ğ‘(â„ğ‘Ÿ)=0(6)
Note that although this function is specific to the 2D case, it can be
adapted to other dimensions.
Proposition 3.2. ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)âˆˆ[âˆ’ 1,1].
Proof. Forâ„,ğ‘Ÿ:ğ‘(â„ğ‘Ÿ)=0, ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=âˆ’1by definition.
Sinceğ‘(ğ‘Ÿ)â‰¤ğ‘(â„ğ‘Ÿ),ğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)âˆˆ[0,1]whenğ‘(â„ğ‘Ÿ)>0, and therefore
2(ğ‘(ğ‘Ÿ)/ğ‘(â„ğ‘Ÿ))ğ‘âˆ’1âˆˆ[âˆ’1,1]for anyğ‘. â–¡
Proposition 3.3. ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=âˆ’1for a maximally dispersed and
ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=1for a maximally clustered point process.
Proof. First, we consider ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=âˆ’1. This value occurs
whenğ‘(ğ‘Ÿ)=0, which is our definition of maximal dispersion at
distanceğ‘Ÿ, or whenğ‘(â„ğ‘Ÿ)=0, which implies ğ‘(ğ‘Ÿ)=0.
Forğ¿ğ¶ğ¹(ğ‘Ÿ,â„)=1ğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)ğ‘
=1â‡’ğ‘(ğ‘Ÿ)=ğ‘(â„ğ‘Ÿ). According
to Definition 3.1, this means maximal clustering at ğ‘Ÿ. â–¡
2179KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
Table 1: Properties of LCF compared to baselines
Metricâˆˆ[âˆ’1,1]â†’0for CSR =âˆ’1for MD =1for MC
ğ¾ âœ— âœ— âœ— âœ—
ğ» âœ— âœ“ âœ— âœ—
ğ»1 âœ“1âœ“ âœ— âœ—
PCF âœ— âœ— âœ— âœ—
LCF âœ“2âœ“ âœ“ âœ“2
MC: maximal clustering, MD: maximal dispersion.
1Holds forğ‘Ÿâˆˆ[0,ğ»ğ‘šğ‘ğ‘¥]and when edge correction is not necessary.
2Holds when monotonicity of ğ‘(ğ‘Ÿ)is preserved in the estimate Ë†ğ‘(ğ‘Ÿ).
Although given for the â€œtrueâ€ ğ¿ğ¶ğ¹ of a point process, Defini-
tion 3.1 and Propositions 3.2 and 3.3 also hold for Ë†ğ¿ğ¶ğ¹ estimated
from a given point pattern under the assumption that Ë†ğ‘(ğ‘Ÿ)is mono-
tonically non-decreasing. Figure 1 shows Ë†ğ¿ğ¶ğ¹(ğ‘Ÿ)and Ë†ğ»(ğ‘Ÿ)for dis-
persed, random, and clustered point patterns.
Lastly, we characterize the behavior of LCF under CSR. Since
LCF is a nonlinear function of ğ‘(ğ‘Ÿ)andğ‘(â„ğ‘Ÿ), it is not trivial
to establish its expectation for a given ğœ†. However, its asymptotic
behavior is easy to derive from the asymptotic consistency of ğ¾.
Our experiments in this paper suggest that the asymptotic regime
is reached relatively quickly, at least for the data we analyze.
Proposition 3.4. Consider the random point process Pwith in-
tensityğœ†. Asğœ†â†’âˆ, Ë†ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)â†’ 0in probability.
Proof. Asğœ†â†’âˆ ,Ë†ğ¾(ğ‘Ÿ)â†’ğœ‹ğ‘Ÿ2and Ë†ğ¾(â„ğ‘Ÿ)â†’ğœ‹â„2ğ‘Ÿ2in prob-
ability. Recall that Ë†ğ‘(ğ‘Ÿ)=ğœ†Ë†ğ¾(ğ‘Ÿ). Sinceğ‘”(ğ‘¥,ğ‘¦)=2(ğ‘¥/ğ‘¦)ğ‘âˆ’1is
a continuous function, we get Ë†ğ¿ğ¶ğ¹(ğ‘Ÿ,â„)â†’ 0by the continuous
mapping theorem. â–¡
Hence, we have verified that LCF satisfies the properties (1) -
(4) stated in the introduction. Table 1 highlights that none of the
classical summary functions possess all these desiderata. Although
both LCF and ğ»1are limited to[âˆ’1,1]under certain assumptions,
the assumption that guarantees the boundedness of LCF is much
milder. While, in practice, it is rare that all events occur inside of the
observation window, monotonicity of Ë†ğ‘(ğ‘Ÿ)usually holds. Uniform
bounds, crucial for a straightforward interpretation of the function
value, are a unique property of LCF.
Since LCF is based on Ripleyâ€™s ğ¾, we can benefit from the theory
and extensions developed for ğ¾. For example, a â€œcross-LCFâ€ can
be obtained by simply substituting ğ‘(ğ‘Ÿ)withğ‘ğ‘–ğ‘—(ğ‘Ÿ)as defined in
Equation 5:
ğ¿ğ¶ğ¹ğ‘–ğ‘—(ğ‘Ÿ)=(
2ğ‘ğ‘–ğ‘—(ğ‘Ÿ)
ğ‘ğ‘–ğ‘—(â„ğ‘Ÿ)ğ‘
âˆ’1ğ‘ğ‘–ğ‘—(â„ğ‘Ÿ)>0
âˆ’1, ğ‘ğ‘–ğ‘—(â„ğ‘Ÿ)=0
We now investigate asymptotic properties of a simplified version
of LCF to gain insight into how to choose the bandwidth parameter
â„.
3.2 Asymptotic Properties of LCF
Deriving asymptotic distributions of summary functions in spa-
tial statistics is challenging even for CSR due to the dependence
between point pairs and edge effects. Therefore, statistical testsconstructed around the ğ¾-function typically rely on Monte Carlo
simulations. For instance, Lang et al. [17] obtained an exact asymp-
totic distribution for ğ¾evaluated in a square observation window
under CSR. Even in this seemingly simple scenario, the derivations
are complex and no closed form can be obtained. Given these diffi-
culties, we instead choose to consider the asymptotic distribution
of a pointwise version of LCF centered at a given reference point
ğ‘âˆ—, which we assume to be well within ğ‘Šso that we can ignore
edge effects. We define
ğ¿ğ¶ğ¹(ğ‘âˆ—,ğ‘Ÿ,â„)=2ğ‘(ğ‘âˆ—,ğ‘Ÿ)
ğ‘(ğ‘âˆ—,â„ğ‘Ÿ)ğ‘
âˆ’1, ğ‘(ğ‘âˆ—,â„ğ‘Ÿ)>0
Proposition 3.5. Letğ‘Šbe an arbitrary observation window. If
ğ‘âˆ—,ğ‘Ÿandâ„are chosen such that the circle {ğ‘¥|âˆ¥ğ‘¥âˆ’ğ‘âˆ—âˆ¥â‰¤â„ğ‘Ÿ}lies
fully within ğ‘Š, then asymptotically:
ğ¿ğ¶ğ¹(ğ‘âˆ—,ğ‘Ÿ,â„,ğ‘›)âˆ¼N
0,1
ğ‘›|ğ‘Š|
ğœ‹ğ‘Ÿ2(ln 2)2
22(â„2âˆ’1)
(lnâ„)2â„2
The proof based on the Delta method is given in Appendix A.2.
This result provides two important insights. First, since the variance
is inversely proportional to ğ‘Ÿ2, the uncertainty of the estimate is
higher for lower ğ‘Ÿ. Second, even for this simplified LCF, the variance
diverges asâ„â†’1:limâ„â†’1â„2âˆ’1
(lnâ„)2â„2=limâ„â†’12
lnâ„=âˆ.
3.3 A Bandwidth-Free LCF
Proposition 3.5 implies that choosing a bandwidth parameter â„
empirically is not trivial: too large â„will lead to dilution across spa-
tial scales, whereas too small â„will lead to potentially unbounded
estimation error. Therefore, we suggest an approach to remove â„
from the definition of LCF.
Proposition 3.6. limâ„â†’1ğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)ğ‘
=exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
.
The proof is given in Appendix A.2. Thus, our revised bandwidth-
free definition of LCF is:
ğ¿ğ¶ğ¹(ğ‘Ÿ)=(
2 exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
âˆ’1, ğ‘(ğ‘Ÿ)>0
âˆ’1, ğ‘(ğ‘Ÿ)=0(7)
The requirements stated in the introduction still hold for (7):
Proposition 3.7. ğ¿ğ¶ğ¹(ğ‘Ÿ)âˆˆ[âˆ’1,1].
Proposition 3.8. ğ¿ğ¶ğ¹(ğ‘Ÿ)=âˆ’1for a maximally dispersed and
ğ¿ğ¶ğ¹(ğ‘Ÿ)=1for a maximally clustered point process.
Proofs are in Appendix A.2.
The appearance of the derivative ğ‘â€²(ğ‘Ÿ)in our bandwidth-free
LCF is reminiscent of the pair correlation function (PCF), and there
is indeed a relation between the two. Equation 7 can be rewritten
as follows:
ğ¿ğ¶ğ¹(ğ‘Ÿ)=2 exp
âˆ’ln 2
2ğ‘Ÿğ¾â€²(ğ‘Ÿ)
ğ¾(ğ‘Ÿ)
âˆ’1=2 exp
ğœ‹ğ‘Ÿ2ğ‘ƒğ¶ğ¹(ğ‘Ÿ)
ğ¾(ğ‘Ÿ)
(8)
This reveals that LCF can be interpreted as a version of PCF normal-
ized by the ratio ğ¾(ğ‘Ÿ)/ğœ‹ğ‘Ÿ2(i.e.,ğ¾divided by its expectation under
CSR) and mapped to the interval [âˆ’1,1]. For the same PCF value,
LCF increases when ğ¾(ğ‘Ÿ)/ğœ‹ğ‘Ÿ2>1(indicating clustering), and de-
creases in the opposite case (indicating dispersion). An important
2180A Uniformly Bounded Correlation Function
for Spatial Point Patterns KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
conceptual difference between LCF and PCF is that PCF is does not
behave like a statistical correlation because it is unbounded from
above, while LCF is designed to behave like a correlation coefficient.
Instead of setting a bandwidth parameter â„, Equation 8 requires
estimation of the derivative ğ‘â€²(ğ‘Ÿ). Estimating function derivatives
is a well-studied problem, and a wide array of techniques is available.
Given the monotonicity of Ë†ğ‘(ğ‘Ÿ), we chose to obtain a smooth
approximation using the shape constraint additive models (SCAM)
framework proposed by Pya et al. [22]. SCAM imposes constraints
on B-spline coefficients to achieve various shape properties, such
as monotonicity. As for all splines, the analytical computation of a
derivative is straightforward after the fit has been performed.
The key smoothing parameter of SCAM is the number of B-spline
basis functions ğ‘, which should be chosen so that the model can
approximate Ë†ğ‘(ğ‘Ÿ)well while avoiding overfitting. Unless stated
differently, throughout the paper we use a simple rule of thumb ğ‘=âˆšğ‘›, which we have found to work reasonably well empirically. The
parameterğ‘can also be tuned as described in [ 9], which we leave
for future work. Implementation details are given in Appendix A.3.
4 EMPIRICAL ANALYSIS
In this section, we first compare LCF to other summary functions
on the reference point processes: maximally dispersed, CSR, and
maximally clustered (Figure 2A). Next, we investigate simulated
point patterns to check whether LCF is able to detect characteris-
tic distances. Lastly, we perform calibration and power analyses
in comparison to ğ¾-based baselines. All summary functions are
estimated using isotropic edge correction.
Until now, we explicitly distinguished the population value of a
summary function from its estimate. Since we use only empirical
estimates in further analysis, we drop this distinction for brevity,
and all functions refer to empirical estimates. Detailed information
about the used point processes and significance testing is provided
in the Appendix.
4.1 LCF for Reference Point Patterns
The core idea of our work is that for a summary function to be
interpretable and suitable for comparing multiple samples, it is
essential to have a bounded scale with limits corresponding to
â€œextremeâ€ spatial arrangements. Here we demonstrate this visually
by comparing the plots of ğ¾,ğ»1,ğ‘ƒğ¶ğ¹, andğ¿ğ¶ğ¹ for realizations
of the reference point processes depicted in Figure 2A. The point
patterns are sampled in a squared observation window, and we vary
the window area as 1, 2, and 4. Since the spatial structure of our
reference point patterns is the same regardless of the observation
window, we would hope to see that the spatial statistics are not
affected by changing |ğ‘Š|.
Figure 2B shows that LCF indeed behaves in the most consistent
manner across the different window sizes. For all other summary
functions, the maximum value depends on |ğ‘Š|; this includes ğ»1,
which does have an upper bound of 1, but the actually attainable
value changes with ğ‘Š. The differences in the behavior of the sum-
mary functions become most clear on the lattice, which exhibits
clustering and dispersion intermittently for ğ‘Ÿ>ğ‘Ÿğ‘‘, sinceğ‘(ğ‘Ÿ)is a
stepwise function for this pattern. According to our Definition 3.1,
the lattice is maximally clustered in intervals where the number of
A
0.1 units
0.01.02.04.0K0.00.51.0H1
0.02.04.0PCF
-1.00.01.0LCF|W|= 1|W|= 2|W|= 4
00.500.500.51r
BFigure 2: LCF compared to baselines for reference point pat-
terns. A) Left: a triangular lattice of side length 0.15; center:
CSR; right: a dense cluster of radius 0.05. B) Summary func-
tions for the reference point patterns (colors correspond to
A) observed in windows of different sizes. The functions are
estimated for ğ‘Ÿâˆˆ[0,âˆšï¸
|ğ‘Š|/ğœ‹], sinceğ»1(ğ‘Ÿ)âˆˆ[âˆ’ 1,1]in this in-
terval. Note that PCF diverges for small ğ‘Ÿfor the maximally
clustered pattern.
neighbors is constant. LCF is indeed 1there, emphasizing that the
clustered and dispersed patterns have similar spatial structure in
these intervals. These sharp changes in spatial arrangement can be
noticed with other summary functions too, as their plots for the
dispersed pattern fluctuate around CSR. However, the difference
between dispersion and CSR appears insignificant for ğ¾andğ»1
considering the range. PCF captures the difference between disper-
sion and CSR much better, and rapidly drops to 0for the clustered
pattern. This behaviour is consistent with the inverse relationship
between PCF and LCF suggested by the Formula 8. However, inter-
pretation of PCF >1is not straightforward due to the lack of an
upper bound.
2181KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
4.2 LCF Extrema and Characteristic Distances
A
50 units
B
-101LCF
0100200300400H
0100200300PCF50    7012017050r
Figure 3: Identifying characteristic distances. A) Left: three
clusters with centroids located 120 units apart. Right: a real-
ization of the Matern process that produces randomly located
clusters. In both patterns, the clusters are circular with a ra-
dius of 25, and the points are uniformly distributed inside the
clusters. Simulations are performed in a 1000x1000 square,
from which a centered subregion is shown. B) Corresponding
plots of LCF, ğ», and PCF. Dashed lines show the characteris-
tic distances.
Figure 3 compares LCF, ğ», and PCF for two simulated point pat-
terns with known characteristic distances. Although we designed
the two patterns to have the same total intensity, the difference in
function magnitude is about 10-fold for both ğ»and PCF. This is
because, in addition to the dependence on |ğ‘Š|, the magnitude of
ğ»and PCF depends on the local density of the points. By contrast,
since LCF essentially compares the arrangement of points at differ-
ent scales, its value is much less dependent on the local density. As
a result, the spatial structure of two different patterns is easier to
compare.
The point pattern with three clusters has four characteristic
distances: the cluster diameter (50), the distance between cluster
centers (120), and the minimal and maximal distances between
points in clusters (70 and 170). By contrast, the Matern process is
characterised only by the cluster diameter (50). The ğ»function
does reflect the characteristic distances to some extent â€“ two local
maxima and one local minimum indicate attraction and repulsion
in the three-cluster pattern, while ğ»has a global maximum for theMatern process. However, due to the cumulative nature of ğ»and
its dependence on|ğ‘Š|, the positions of the extrema do not exactly
coincide with the interaction distances. By contrast, the extrema of
LCF and PCF do indicate the characteristic distances well, but as
pointed our in the previous section, the meaning of their extrema
is the opposite.
4.3 Statistical Analysis
To more formally investigate the capacity of LCF to detect devia-
tion from randomness in point patterns, we constructed statistical
tests based on LCF, ğ», and PCF and compared their calibration and
power.ğ»was chosen due to its popularity in applied analysis and
stabilized variance [ 1]. The comparison to PCF is natural because of
its close relation to LCF discussed above. Since the distributions of
the summary functions are not known in the general case, we use
Monte Carlo tests that approximate the null distribution by sam-
pling from the null hypothesis (in this case, CSR). For simplicity, we
perform the test at a single, fixed distance ğ‘Ÿâˆ—, which we hypothesize
to be an interaction distance. That is, ğ»(ğ‘Ÿâˆ—),ğ‘ƒğ¶ğ¹(ğ‘Ÿâˆ—), andğ¿ğ¶ğ¹(ğ‘Ÿâˆ—)
are the test statistics. As explained in [ 1], such a pointwise test is
valid whenğ‘Ÿâˆ—is chosen in advance.
4.3.1 Calibration. A perfectly calibrated statistical test produces
uniformly distributed p-values for samples from ğ»0, hence, the
fraction of samples for which ğ»0is rejected should be equal to
the significance level. The Monte Carlo test is set up as follows:
to approximate the null distribution, we draw 5000 point patterns
from the Poisson process and calculate their test statistics for all
considered functions. Then, ğ‘š=1000 more Poisson process realiza-
tions are tested for CSR; the corresponding two-sided p-values are
computed and used to calculate the Type I error at different signifi-
cance levels. Point patterns are simulated in a square observation
window, and the hypothesized interaction distance is set to ğ‘Ÿâˆ—=5.
We vary the sample size ğ‘›and the observation window area |ğ‘Š|.
Uncertainty is quantified by generating simulated null distributions
for the test statistics of ğ‘špoint patterns assuming CSR. 95% BCa
confidence intervals are computed [11].
Figure 4 shows the results of this analysis on a log10-log10
scale to emphasize the calibration for significance levels commonly
used in hypothesis testing. PCF is relatively well calibrated even
for small sample sizes, whereas LCF requires a larger sample size
thanğ»to achieve good calibration. At low intensities, LCF is overly
conservative at realistic significance levels <0.05. On the other hand,
ğ»and PCF show a â€œstepwiseâ€ calibration curve in almost all cases.
Regardless, all functions achieve good calibration when the sample
size is 100 and the observation window area is â‰¤2Â·104.
4.3.2 Power. To test the power of the different summary functions
to detect non-random point patterns, we used a Monte Carlo test
similar to the one described above but with the ğ‘€different point
patterns drawn from one of three non-random point processes.
Specifically, we used the Hardcore andStrauss processes to generate
dispersed point patterns; for clustering, we again used the Matern
cluster process. We performed a one-sided test for non-random
clustering (e.g., ğ»0:ğ¿ğ¶ğ¹=0vs.ğ»ğ‘:ğ¿ğ¶ğ¹>0) at the 0.05signifi-
cance level. All point patterns were simulated in a 200x200 square.
2182A Uniformly Bounded Correlation Function
for Spatial Point Patterns KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
1.250.6250.31252.51.250.62552.51.2525 points50 points100 points|W|2|W|4|W|-3-2-10-3-2-10-3-2-10-3-2-10
-3-2-10
-3-2-10log10 Significance levellog10 Type I errorHPCFLCF
Figure 4: Calibration of LCF, ğ», and PCF for different sample
sizes and observation window areas. |ğ‘Š|=2Â·104. The inten-
sity of the corresponding point process (units 10-4) is shown
in the top left corner of each panel. Shading: 95% confidence
intervals.
Uncertainty was quantified in the same way as in the calibration
analysis.
The Hardcore process inhibits the occurrence of point pairs
closer than a â€œhardcore distanceâ€ ğ‘…. In the Strauss process, a close
pair is accepted with the probability ğ›¾. The motivation for including
both Hardcore and Strauss processes is that for many real-world
objects, the Hardcore process is a realistic representation of random
spatial distribution because of spatial exclusion at distances resem-
bling the sizes of the objects. However, we expected the hardcore
inhibition to be straightforward to detect and additionally test the
summary functions on the more challenging Strauss process. The
Matern cluster process is characterised by the average number of
clustersğ‘›ğ‘, the cluster radius ğ‘…ğ‘and the intensity of the points
within clusters.
We conducted the power analysis for different effect sizes. The
Hardcore process with ğ‘…=0is equivalent to CSR, and a higher ğ‘…
corresponds to a stronger non-randomness. Similarly, by varying ğ›¾,
we can interpolate the Strauss process between CSR ( ğ›¾=1) and the
Hardcore process ( ğ›¾=0). In the Matern process, a smaller cluster
radius corresponds to a higher degree of clustering, and a very large
ğ‘…ğ‘produces a random arrangement of points.
For Hardcore and Strauss patterns, we set the inhibition distance
toğ‘Ÿâˆ—=5. For the Matern process, we set the cluster radius to
ğ‘Ÿâˆ—=5. However, for a fair comparison of the summary functions,
the choice of ğ‘Ÿâˆ—should account for the difference in their behavior.
For trueğ‘…ğ‘=5, LCF is designed to reach its maximum at ğ‘Ÿ=10,
whereas PCF drops to its expected value for CSR at ğ‘Ÿ=10. Therefore,
we test each function at the scale ğ‘Ÿwhere its power is maximal.
Specifically, although ğ»â€™s maximum does not correspond well to
H PCF LCF
A
0.00.51.0R = 5n = 60n = 120n = 240506070n013501350135R
B
0.00.51.0PowerR = 5, Î³ = 0.25n = 60n = 120n = 24040120200n00.5100.5100.511 - Î³
C
0.00.51.0Rc = 5 , np = 50n = 25n = 50n = 100203040506070n020406002040600204060RcFigure 5: Power analysis for LCF, ğ», and PCF. In each row,
the first panel varies the sample size at a fixed effect size,
while the others vary the effect size for fixed sample sizes.
Throughout, ğ‘›=number of points. A) Hardcore process, ğ‘…-
hardcore distance. B) Strauss process, ğ‘…- inhibition distance,
ğ›¾- probability of accepting a close pair. ğ‘…=5in all exper-
iments. C) Matern cluster process. ğ‘›ğ‘- average number of
clusters,ğ‘…ğ‘- cluster radius. ğ‘›ğ‘=50in all experiments. Shad-
ing: 95% confidence intervals (these are narrow and barely
thicker than the lines).
the domain size, we choose ğ‘Ÿâˆ—=10sinceğ»is cumulative. PCFâ€™s
maximum is expected to occur around ğ‘Ÿ=0, hence it is more
appropriate to take ğ‘Ÿâˆ—=5because at this distance PCF should still
significantly deviate from 1.
Figure 5 shows the results of our power analysis. For the in-
hibitory processes, PCF has lower power than ğ»and LCF, which
perform similarly for large samples, although ğ»has an edge for
intermediate sample sizes. However, for the average sample size
ğ‘›=120, LCF is more powerful than ğ»for detecting the Hardcore
process. For clustering, PCF and ğ»have almost identical power
curves and outperform LCF, especially for small effect sizes. This
can be explained by the fact that LCF reaches its maximum at the
cluster diameter, and its growth at smaller distances is slower than
ğ»â€™s, hence, the effect of increasing radius on its shape is stronger
than for other functions. Overall, in this analysis, detecting cluster-
ing appeared to be easier than detecting inhibition: even for a very
smallğ‘›=30, all functions had more than 50% power.
2183KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
A
-101
0100200300400500r, ÂµmLCF B
-101
0255075r, kmLCF
cDC2 pDC B cell Myeloid
C
0.190.330.300.070.050.050.030.030.550.540.74
0.260.00.20.40.60.8
n=71n=32n=63n=78AUC D
r = -0.62r = -0.74r = -0.33r = -0.761021031041021031040.00.20.40.6
0.00.20.40.6Number of cellsAUCAir Waste
E
0.260.360.140.150.510.75
0.20.40.60.8
n=45n=41AUC F
r = -0.21r = -0.291021030.20.40.6
0.20.40.6Number of facilitiesAUC
Figure 6: Example applications of LCF. A) Immune cells in tumor microarray biopsies (light blue - tumor, white - background,
brighter color corresponds to higher cell density) with corresponding LCF for each cell type. cDC2: conventional dendritic
cell, type 2; pDC: plasmacytoid dendritic cell. B) Air pollution and waste generation facilities in the state of Ohio and LCF per
facility type. C, E) Standardized AUCs for LCF plots for multiple tumor biopsies (C) or states (E). The x-axis shows how many
biopsies/states had sufficiently many cells/facilities for analysis. D, F) Relationships between LCF AUC and the number of cells
(D) or facilities (F) with Pearson correlation and loess regression line.
5 APPLICATIONS
In this section, we demonstrate how LCF can be used for exploratory
data analysis, both to analyze individual samples and for compar-
ing multiple, possibly heterogeneous, point patterns. We use two
publicly available datasets that contain multiple samples with com-
parable region sizes and objects of multiple types.
The first dataset consists of tumor biopsy images that show
different types of immune cells, namely conventional dendritic
cells of type 2 (cDC2), plasmacytoid dendritic cells (pDCs), myeloid
cells, and B cells [ 34]. Quantifying the spatial distribution of such
cells is important to understand how the cells interact with each
other, which can lead to biomarkers for therapy response [ 35].
Upon manual quality control (requiring at least half of the tissue
to be intact), we selected 78 images for analysis. To detect the
positions of the immune cells and identify their types, we used
the ImmuNet pipeline [ 32,34]. Tissue boundaries were found by a
segmentation algorithm implemented in the â€œinFormâ€ software (v
2.4.8, PerkinElmer). A representative sample is shown in Figure 6A.
The LCF plots reflect clear differences between the cell types: theLCF values are highest for B cells, which are indeed noticeably
clustered, and barely deviate from 0for the scattered myeloid cells.
A pronounced peak in LCF for cDC2s suggests that they could
interact at short distances (inset).
The second dataset contains coordinates of air pollution and
waste generation facilities in the USA [ 19]. Monogan et al. reported
significant differences between the spatial distributions of these
types of facilities. One may wonder whether the degree of cluster-
ing also differs. States with very small or large areas were removed
from the analysis, leaving us with 46 states. State boundaries were
obtained with the USA.state.boundaries R package (ver. 1.0.1).
Facility locations and the corresponding LCF plot for the state of
Ohio are shown in Figure 6B. LCF reflects the visually obvious fact
that waste generators are more clustered than air polluters, espe-
cially at large distances. Additionally, it reveals that air polluters
are more clustered at smaller distances (inset), which is harder to
see directly in the plots.
2184A Uniformly Bounded Correlation Function
for Spatial Point Patterns KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
To compare multiple samples, we extract a â€œglobal degree of
clusteringâ€ by taking the area under the LCF curve between pre-
specified values ğ‘Ÿminandğ‘Ÿmaxand dividing it by ğ‘Ÿmaxâˆ’ğ‘Ÿmin, result-
ing in a possible range from âˆ’1to1as for LCF itself. Small ğ‘Ÿ<ğ‘Ÿmin
are excluded due to the large variance of LCF, whereas overly large
ğ‘Ÿ>ğ‘Ÿmaxare less meaningful to analyze due to the edge effects.
For tumor images we set ğ‘Ÿğ‘šğ‘–ğ‘›=50ğœ‡ğ‘šandğ‘Ÿğ‘šğ‘ğ‘¥=500ğœ‡ğ‘šand for
industrial facilities ğ‘Ÿğ‘šğ‘–ğ‘›=7.5ğ‘˜ğ‘šandğ‘Ÿğ‘šğ‘ğ‘¥=75ğ‘˜ğ‘š. Point patterns
with less than 40 objects were excluded from the analysis.
The AUC analysis reveals that pDCs and B cells are the most
clustered immune cells in this dataset, while myeloid cells show
very little clustering (Figure 6C). These results are consistent with
the fact that tertiary lymphoid structures, which can form at the
site of infection and are hypothesized to boost the local immune
response, have a B cell follicle at their core [ 27,29,30]. In contrast,
the primary role of myeloid cells is to patrol tissues for pathogens,
which they then engulf and digest. They are, therefore, more likely
to be scattered. The difference in the degree of clustering of cDC2s
and pDCs is interesting since they have different origins and roles
in the immune response. There are no samples showing evidence of
repulsion between cells. Figure 6D shows that the number of cells
in a sample is negatively correlated with the LCF AUC for all cell
types. A possible explanation is that due to the spatial exclusion
between cells, clusters are less likely to form at high densities.
Figure 6E demonstrates that waste generators are more clustered
than air polluters. This effect might occur because if many air pol-
luters are placed close to each other, the maximum permitted level
of toxic substances in that area might be exceeded. This problem
does not have to be addressed when placing waste generation facil-
ities. The correlation between the number of facilities and LCFâ€™s
AUC is negative as well, but the correlation coefficients are lower
than for immune cells (Figure 6F).
6 CONCLUSION
Here, we have proposed the local correlation function (LCF), a new
summary function for point patterns with a bounded and inter-
pretable scale. LCF is based on Ripleyâ€™s ğ¾, and its closest relative
amongğ¾-based statistics is the pair correlation function (PCF). The
crucial difference between LCF and other summary functions is
that its extreme values, -1 and 1, are identical and attainable for
all observation window sizes |ğ‘Š|and all scales ğ‘Ÿ. This means that
LCF(ğ‘Ÿ)can be interpreted as the degree of clustering at distance
ğ‘Ÿ, and facilitates comparisons between multiple samples. As with
otherğ¾-based spatial statistics, researchers can analyze the entire
function graph of LCF for a single or a few patterns or construct
summary measures such as the area under the curve for joint anal-
ysis of many point patterns.
In our experiments, we estimated LCF based on a monotone
spline approximation of ğ‘(ğ‘Ÿ), the average number of neighbors
within distance ğ‘Ÿof a typical point, and its derivative. A simpler
plug-in estimator can also be used, but it requires tuning a band-
width parameter â„. We found that LCFâ€™s power and calibration
are more sensitive to sample size than those of ğ¾-based baselines,
although they become comparable at relatively small sample sizes.
We have limited this investigation to testing for deviation from
complete spatial randomness at a single distance ğ‘Ÿ; simultaneoustesting of multiple spatial scales [ 1] will be interesting to explore
in future work.
Some limitations of the LCF are inherited from Ripleyâ€™s ğ¾. It is
asymptotically consistent but generally not an unbiased estimator
of its population value, although the bias for complete spatial ran-
domness appeared to be small in our experiments. The complex
dependence structure of the input data (pairwise distances between
points) makes it difficult to establish exact or asymptotic results
on its distribution, and we provide only preliminary theory in this
paper. While it may appear that the use of monotone splines to
estimate LCF adds computational overhead, our initial tests showed
no major difference between the computational requirements for
LCF andğ¾, and we therefore did not to include empirical measure-
ments of runtime in this paper. We used the SCAM framework as a
â€œplug-inâ€ method to estimate ğ‘(ğ‘Ÿ)andğ‘â€²(ğ‘Ÿ)and chose the number
of basis functions asâˆšğ‘›, a somewhat ad hoc decision that can be
improved in future work. Finally, LCF is bounded under the as-
sumption that the estimated Ë†ğ‘(ğ‘Ÿ)is monotonically non-decreasing.
Although this is typically the case, it is important to further inves-
tigate the interactions with different edge correction strategies in
future work.
We found promising correspondences between LCF extrema
and the characteristic distances of simulated point patterns, but
did not investigate this in detail. Further research on the use of
LCF extrema to infer point process parameters is of interest, es-
pecially for a wider variety of cluster shapes and arrangements.
Additionally, it would be useful to determine the robustness of the
LCF extrema to increasing noise and decreasing sample size. Other
promising directions for future work include the investigation of
the pointwise LCF introduced in Section 3.2. This could be use-
ful for the exploratory data analysis of digital pathology images
containing tens of thousands of cells, e.g., to find regions of partic-
ularly clustered or dispersed cell arrangement. Using LCF to detect
and quantify clustering (dispersion) in high-dimensional data may
also be an interesting avenue; however, one would need to find an
approach to circumvent the curse of dimensionality.
In summary, we hope that the LCF will encourage the adoption
of spatial statistics in research communities where we think it is
currently underutilized, such as Biology. We have shown examples
of exploratory data analysis with LCF for two real datasets from
very different domains. For ease of use, we have implemented ğ¿ğ¶ğ¹
in an R package that follows the conventions and interfaces of the
popular package spatstat [2]. The R package is provided as online
material accompanying this manuscript, see Appendix B.
ACKNOWLEDGMENTS
This work was supported by a grant from the Hanarth Foundation to
JT. We thank Mihaela Mihaylova for proofreading this manuscript.
REFERENCES
[1]Adrian Baddeley, Peter J Diggle, Andrew Hardegen, Thomas Lawrence, Robin K
Milne, and Gopalan Nair. 2014. On tests of spatial pattern based on simulation
envelopes. Ecological Monographs 84, 3 (2014), 477â€“489.
[2]Turner R Baddeley A, Rubak E. 2015. Spatial Point Patterns: Methodology
and Applications with R (1st ed.). Number ISBN 9781482210200. Chap-
man and Hall/CRC Press, London. https://www.routledge.com/Spatial-
Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-
Turner/p/book/9781482210200/
2185KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
[3]Andrea Behanova, Anna Klemm, and Carolina WÃ¤hlby. 2022. Spatial Statistics
for Understanding Tissue Organization. Frontiers in Physiology 13 (Jan. 2022).
https://doi.org/10.3389/fphys.2022.832417
[4]Mariem Ben-Said. 2021. Spatial point-pattern analysis as a powerful tool in
identifying pattern-process relationships in plant ecology: an updated review.
Ecological Processes 10, 1 (2021), 1â€“23.
[5]Sneha Berry, Nicolas A. Giraldo, Benjamin F. Green, Tricia R. Cottrell, Julie E.
Stein, Elizabeth L. Engle, Haiying Xu, Aleksandra Ogurtsova, Charles Roberts,
Daphne Wang, Peter Nguyen, Qingfeng Zhu, Sigfredo Soto-Diaz, Jose Loy-
ola, Inbal B. Sander, Pok Fai Wong, Shlomit Jessel, Joshua Doyle, Danielle
Signer, Richard Wilton, Jeffrey S. Roskes, Margaret Eminizer, Seyoun Park,
Joel C. Sunshine, Elizabeth M. Jaffee, Alexander Baras, Angelo M. De Marzo,
Suzanne L. Topalian, Harriet Kluger, Leslie Cope, Evan J. Lipson, Ludmila
Danilova, Robert A. Anders, David L. Rimm, Drew M. Pardoll, Alexander S.
Szalay, and Janis M. Taube. 2021. Analysis of multispectral imaging with the
AstroPath platform informs efficacy of PD-1 blockade. Science 372, 6547 (June
2021). https://doi.org/10.1126/science.aba2609
[6]JE Besag. 1977. Comments on Ripleyâ€™s paper: Royal Statistical Society. Journal
39 (1977), 193â€“195.
[7]Joshua A Bull and Helen M Byrne. 2023. Quantification of spatial and phenotypic
heterogeneity in an agent-based model of tumour-macrophage interactions. PLOS
Computational Biology 19, 3 (2023), e1010994.
[8]Joshua A Bull, Eoghan J Mulholland, Simon J Leedham, and Helen M Byrne. 2024.
Extended correlation functions for spatial analysis of multiplex imaging data.
Biological Imaging 4 (2024), e2.
[9] Alan Y Chiang. 2007. Generalized additive models: an introduction with R.
[10] Peter J Diggle. 1979. On parameter estimation and goodness-of-fit testing for
spatial point patterns. Biometrics (1979), 87â€“101.
[11] Bradley Efron. 1987. Better bootstrap confidence intervals. Journal of the Ameri-
can statistical Association 82, 397 (1987), 171â€“185.
[12] Anthony C Gatrell, Trevor C Bailey, Peter J Diggle, and Barry S Rowlingson. 1996.
Spatial point pattern analysis and its application in geographical epidemiology.
Transactions of the Institute of British geographers (1996), 256â€“274.
[13] KH Hanisch. 2007. Some remarks on estimators of the distribution function of
nearest neighbour distance in stationary spatial point processes. Series Statistics
(2007).
[14] Brian Hopkins and John Gordon Skellam. 1954. A new method for determining
the type of distribution of plant individuals. Annals of Botany 18, 2 (1954), 213â€“
227.
[15] Amanda Janesick, Robert Shelansky, Andrew D. Gottscho, Florian Wagner,
Stephen R. Williams, Morgane Rouault, Ghezal Beliakoff, Carolyn A. Morrison,
Michelli F. Oliveira, Jordan T. Sicherman, Andrew Kohlway, Jawad Abousoud,
Tingsheng Yu Drennon, Seayar H. Mohabbat, and Sarah E. B. Taylor. 2023. High
resolution mapping of the tumor microenvironment using integrated single-
cell, spatial and in situ analysis. Nature Communications 14, 1 (Dec. 2023).
https://doi.org/10.1038/s41467-023-43458-x
[16] Maria A Kiskowski, John F Hancock, and Anne K Kenworthy. 2009. On the use
of Ripleyâ€™s K-function and its derivatives to analyze domain size. Biophysical
journal 97, 4 (2009), 1095â€“1103.
[17] Gabriel Lang and Eric Marcon. 2013. Testing randomness of spatial point patterns
with the Ripley statistic. ESAIM: Probability and Statistics 17 (2013), 767â€“788.
[18] Carlo C Maley, Konrad Koelble, Rachael Natrajan, Athena Aktipis, and Yinyin
Yuan. 2015. An ecological measure of immune-cancer colocalization as a prog-
nostic factor for breast cancer. Breast Cancer Research 17, 1 (2015), 1â€“13.
[19] James E Monogan III, David M Konisky, and Neal D Woods. 2017. Gone with the
wind: Federalism and the strategic location of air polluters. American Journal of
Political Science 61, 2 (2017), 257â€“270.
[20] J Ohser and D Stoyan. 1981. On the second-order and orientation analysis of
planar stationary point processes. Biometrical Journal 23, 6 (1981), 523â€“533.
[21] Natalya Pya. 2023. scam: Shape Constrained Additive Models. https://CRAN.R-
project.org/package=scam R package version 1.2-14.
[22] Natalya Pya and Simon N Wood. 2015. Shape constrained additive models.
Statistics and computing 25 (2015), 543â€“559.
[23] R Core Team. 2023. R: A Language and Environment for Statistical Computing. R
Foundation for Statistical Computing, Vienna, Austria. https://www.R-project.
org/
[24] Brian D Ripley. 1977. Modelling spatial patterns. Journal of the Royal Statistical
Society: Series B (Methodological) 39, 2 (1977), 172â€“192.
[25] Brian D Ripley. 1979. Tests ofâ€™randomnessâ€™ for spatial point patterns. Journal of
the Royal Statistical Society Series B: Statistical Methodology 41, 3 (1979), 368â€“374.
[26] Brian D Ripley. 1982. Edge effects in spatial stochastic processes. Statistics in
theory and practice. Essays in honour of Bertil Matern (1982).
[27] Catherine SautÃ¨s-Fridman, Florent Petitprez, Julien Calderaro, and Wolf Herman
Fridman. 2019. Tertiary lymphoid structures in the era of cancer immunotherapy.
Nature Reviews Cancer 19, 6 (2019), 307â€“325.
[28] Katja Schiffers, Frank M Schurr, Katja TielbÃ¶rger, Carsten Urbach, Kirk Moloney,
and Florian Jeltsch. 2008. Dealing with virtual aggregationâ€“a new index foranalysing heterogeneous point patterns. Ecography 31, 5 (2008), 545â€“555.
[29] Ton N Schumacher and Daniela S Thommen. 2022. Tertiary lymphoid structures
in cancer. Science 375, 6576 (2022), eabf9419.
[30] KarÂ¯Ä±na Sili n,a, Alex Soltermann, Farkhondeh Movahedian Attar, Ruben Casanova,
Zina M Uckeley, Helen Thut, Muriel Wandres, Sergejs Isajevs, Phil Cheng,
Alessandra Curioni-Fontecedro, et al .2018. Germinal centers determine the
prognostic relevance of tertiary lymphoid structures and are impaired by cor-
ticosteroids in lung squamous cell carcinoma. Cancer research 78, 5 (2018),
1308â€“1320.
[31] Leonard A Stefanski and Dennis D Boos. 2002. The Calculus of M-Estimation.
The American Statistician 56, 1 (Feb. 2002), 29â€“38. https://doi.org/10.1198/
000313002753631330
[32] Shabaz Sultan, Mark AJ Gorris, Lieke L van der Woude, Franka Buytenhuijs,
Evgenia Martynova, Sandra van Wilpe, Kiek Verrijp, Carl G Figdor, I Jolanda M
de Vries, and Johannes Textor. 2021. A Segmentation-Free machine learning
architecture for immune Land-scape phenotyping in solid tumors by multichannel
imaging. BioRxiv (2021), 2021â€“10.
[33] Huw D. Summers, John W. Wills, and Paul Rees. 2022. Spatial statistics is a
comprehensive tool for quantifying cell neighbor relationships and biological
processes via tissue image analysis. Cell Reports Methods 2, 11 (Nov. 2022), 100348.
https://doi.org/10.1016/j.crmeth.2022.100348
[34] Iris AE van der Hoorn, Evgenia Martynova, Beatriz Subtil, Jelena Meek, Kiek
Verrijp, Johannes Textor, Georgina FlÃ³rez-Grau, Berber Piet, Michel M van den
Heuvel, I Jolanda M de Vries, et al .2023. Detection of dendritic cell subsets in
the tumor microenvironment by multiplex immunohistochemistry. European
Journal of Immunology (2023), 2350616.
[35] Lieke L. van der Woude, Mark A.J. Gorris, Altuna Halilovic, Carl G. Figdor, and
I. Jolanda M. de Vries. 2017. Migrating into the Tumor: a Roadmap for T Cells.
Trends in Cancer 3, 11 (Nov. 2017), 797â€“808. https://doi.org/10.1016/j.trecan.2017.
09.006
[36] Scott Ward, Edward AK Cohen, and Niall Adams. 2021. Testing for complete spa-
tial randomness on three dimensional bounded convex shapes. Spatial Statistics
41 (2021), 100489.
[37] Angela C White, Carlo F Barenghi, and Nick P Proukakis. 2012. Creation and
characterization of vortex clusters in atomic Bose-Einstein condensates. Physical
Review A 86, 1 (2012), 013635.
[38] Christopher Wilson, Alex C. Soupir, Ram Thapa, Jordan Creed, Jonathan Nguyen,
Carlos Moran Segura, Travis Gerke, Joellen M. Schildkraut, Lauren C. Peres, and
Brooke L. Fridley. 2022. Tumor immune cell clustering and its association with sur-
vival in African American women with ovarian cancer. PLOS Computational Bi-
ology 18, 3 (March 2022), e1009900. https://doi.org/10.1371/journal.pcbi.1009900
A RESEARCH METHODS
A.1 Simulation Details
Figure 1. All point patterns are generated in a 400x400 square
with total intensity 3/(23Â·10). The Strauss process is used to gen-
erate point patterns with inhibition. In the Strauss process, a pair
of points that lie closer than the inhibition distance ğ‘…is accepted
with probability ğ›¾. We setğ‘…=15andğ›¾=0.4. The clustered point
pattern is drawn from a Thomas cluster process, which first ob-
tains the parent points by sampling a realization of the Poisson
process with intensity ğœ…and then replaces every parent point with
a Poisson distributed number of offspring with isotropic Gaussian
displacement from the parent point. We set the parent intensity
ğœ…to5/(24Â·103), the average number of offspring per cluster to
120and the standard deviation of the Gaussian to 7.5. This way on
average 95%of offspring are within 15units from the cluster centre.
Figure 2. The lattice is generated by creating a triangular grid
with a distance of ğ‘Ÿğ‘‘=0.15between points covering the observa-
tion window; the outcome of this point process is deterministic.
CSR is generated with intensity ğœ†=200for all observation window
sizes. The points in the dense cluster are uniformly distributed
within a disk of radius ğ‘Ÿğ‘=0.5located at the center of the ob-
servation window. The number of points per disk is drawn from
a Poisson distribution with parameter 200/ğœ‹ğ‘Ÿ2ğ‘; the intensity and
cluster radius are kept the same for all observation window sizes.
2186A Uniformly Bounded Correlation Function
for Spatial Point Patterns KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Figure 3. Point patterns are generated in a 1000x1000 square with
total intensity 2/103. To generate the pattern with three clusters, we
define three parent points as the vertices of an equilateral triangle
with side length 120and draw a Poisson process realization with
intensity 2/(3Â·103)in a disk with radius 25centered on each parent
point. The Matern process generates clusters by first drawing the
parent points from a Poisson process with intensity ğœ…and then
replacing every parent point with circular clusters with uniformly
distributed points. We set ğœ…=75/106, cluster radius to 25and the
average number of points per cluster to 2000/75. The central region
of size 365x300 is cropped for visualisation of both point patterns.
A.2 Proofs
Proof of Proposition 3.5. We consider a point pattern of ğ‘›+1
pointsğ‘1,...,ğ‘ğ‘›+1in the observation window ğ‘Š. A pointğ‘âˆ—, dis-
tanceğ‘Ÿand a scalar â„are chosen in such a way that the circle
ğ‘(ğ‘âˆ—,â„ğ‘Ÿ)âˆ©ğ‘Š=ğ‘(ğ‘âˆ—,â„ğ‘Ÿ), i.e. the circle centered at the point ğ‘âˆ—
lies fully within ğ‘Š. Defineğ‘‘âˆ—
ğ‘—:=âˆ¥ğ‘âˆ—âˆ’ğ‘ğ‘—âˆ¥.
We start with investigating the ratio:
ğ‘ğ‘›=ğ‘(ğ‘âˆ—,ğ‘Ÿ)
ğ‘(ğ‘âˆ—,ğ‘Ÿâ„)=Ã
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿ)
Ã
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿâ„)=1
ğ‘›Ã
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿ)
1
ğ‘›Ã
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿâ„)=ğ‘‹ğ‘›
ğ‘Œğ‘›
ğ‘‹ğ‘—=1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿ)represents a Bernoulli trial of whether ğ‘ğ‘—âˆˆ
ğ‘(ğ‘âˆ—,ğ‘Ÿ). For CSR, the probability of success is ğ‘=ğœ‹ğ‘Ÿ2
|ğ‘Š|(the fraction
of area within the circle ğ‘(ğ‘¥,ğ‘Ÿ)) andğœ‡ğ‘‹ğ‘—=ğ‘,ğœ2
ğ‘‹ğ‘—=ğ‘(1âˆ’ğ‘).
Similarly, for ğ‘Œğ‘—=1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿâ„),ğœ‡ğ‘Œğ‘—=ğ‘,ğœ2
ğ‘Œğ‘—=ğ‘(1âˆ’ğ‘)andğ‘=ğœ‹ğ‘Ÿ2â„2
|ğ‘Š|.
Sinceğ‘(ğ‘¥,ğ‘Ÿ)âŠ‚ğ‘(ğ‘¥,â„ğ‘Ÿ),ğ‘‹ğ‘—andğ‘Œğ‘—are correlated. Their covariance
is:
ğœğ‘‹ğ‘—ğ‘Œğ‘—=E[ğ‘‹ğ‘—ğ‘Œğ‘—]âˆ’E[ğ‘‹ğ‘—]E[ğ‘Œğ‘—]
=1
ğ‘›âˆ‘ï¸
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿ)1(ğ‘‘âˆ—
ğ‘—<â„ğ‘Ÿ)âˆ’ğ‘ğ‘
=1
ğ‘›âˆ‘ï¸
ğ‘—1(ğ‘‘âˆ—
ğ‘—<ğ‘Ÿ)âˆ’ğ‘ğ‘=ğ‘(1âˆ’ğ‘)
Therefore for a random vector ğ‘ˆğ‘ˆğ‘ˆğ‘—=[ğ‘‹ğ‘—,ğ‘Œğ‘—],ğœ‡ğœ‡ğœ‡ğ‘ˆğ‘ˆğ‘ˆğ‘—=[ğ‘,ğ‘]
andÎ£Î£Î£ğ‘ˆğ‘ˆğ‘ˆğ‘—=ğ‘(1âˆ’ğ‘)ğ‘(1âˆ’ğ‘)
ğ‘(1âˆ’ğ‘)ğ‘(1âˆ’ğ‘). Its average is ğ‘ˆğ‘ˆğ‘ˆğ‘›=1
ğ‘›Ã
ğ‘—ğ‘ˆğ‘ˆğ‘ˆğ‘—=
[1
ğ‘›Ã
ğ‘—ğ‘‹ğ‘—,1
ğ‘›Ã
ğ‘—ğ‘Œğ‘—]. According to the central limit theorem:
âˆšğ‘›(ğ‘ˆğ‘ˆğ‘ˆğ‘›âˆ’ğœ‡ğœ‡ğœ‡ğ‘ˆğ‘ˆğ‘ˆğ‘—)â†’N 2(0,Î£Î£Î£ğ‘ˆğ‘ˆğ‘ˆğ‘—)
This leads to the asymptotic approximation ğ‘ˆğ‘ˆğ‘ˆğ‘›âˆ¼N 2(ğœ‡ğœ‡ğœ‡ğ‘ˆğ‘ˆğ‘ˆğ‘—,1
ğ‘›Î£Î£Î£ğ‘ˆğ‘ˆğ‘ˆğ‘—)
andÎ£Î£Î£ğ‘ˆğ‘ˆğ‘ˆğ‘›=1
ğ‘›ğ‘(1âˆ’ğ‘)ğ‘(1âˆ’ğ‘)
ğ‘(1âˆ’ğ‘)ğ‘(1âˆ’ğ‘).
The asymptotic distribution of a ratio of sample averages ğ‘ğ‘›=
ğ‘‹ğ‘›
ğ‘Œğ‘›is [31]:
ğ‘ğ‘›âˆ¼Nğœ‡ğ‘‹ğ‘›
ğœ‡ğ‘Œğ‘›,1
ğœ‡2
ğ‘Œğ‘›
ğœ2
ğ‘Œğ‘›ğœ‡ğ‘‹ğ‘›
ğœ‡ğ‘Œğ‘›2
âˆ’2ğœğ‘‹ğ‘›ğ‘Œğ‘›ğœ‡ğ‘‹ğ‘›
ğœ‡ğ‘Œğ‘›+ğœ2
ğ‘‹ğ‘›
.
Now, we simplify the asymptotic expresion for ğœ2
ğ‘ğ‘›using the
expressions of ğœ2
ğ‘‹ğ‘›,ğœ2
ğ‘Œğ‘›,ğœ‡ğ‘‹ğ‘›andğœ‡ğ‘Œğ‘›derived above. Note that
ğ‘
ğ‘=1
â„2.ğœ2
ğ‘ğ‘›=1
ğ‘2ğ‘(1âˆ’ğ‘)
ğ‘›ğ‘2
ğ‘2âˆ’2ğ‘(1âˆ’ğ‘)
ğ‘›ğ‘
ğ‘+ğ‘(1âˆ’ğ‘)
ğ‘›
=1
ğ‘›1
ğ‘1
â„2
1âˆ’1
â„2
=1
ğ‘›1
ğ‘1
â„4
1âˆ’1
â„2
Thus, asymptotically ğ‘ğ‘›âˆ¼N
1
â„2,1
ğ‘›1
ğ‘1
â„4
1âˆ’1
â„2
.
LCF transforms the ratioğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)so that its expectation is 1/2for
CSR using the transformation ğ‘”(ğ‘¥)=ğ‘¥ğ‘,ğ‘=ln 2
2 lnâ„, therefore we
need to apply the same transformation ğ‘”to the distribution of ğ‘ğ‘›
to obtain the distribution of ğ¿ğ¶ğ¹(ğ‘âˆ—,ğ‘Ÿ,â„,ğ‘›). The Delta method can
be applied for this since ğ‘ğ‘›satisfies:
âˆšğ‘›(ğ‘ğ‘›âˆ’ğœ‡)â†’N( 0,ğœ2)
with finiteğœ‡=1
â„2andğœ2=1
ğ‘1
â„4
1âˆ’1
â„2
. Then:
âˆšğ‘›(ğ‘”(ğ‘ğ‘›)âˆ’ğ‘”(ğœ‡))â†’N( 0,ğœ2ğ‘”â€²(ğœ‡ğ‘§)2) (9)
Sinceğ‘”â€²(ğ‘¥)=ln 2
2 lnâ„1
ğ‘¥ğ‘¥ln 2
2 lnâ„we get:
ğ‘”â€²(ğœ‡ğ‘§)=1
22ln 2
lnâ„â„2
Plugging this, ğœ2andğ‘=ğœ‹ğ‘Ÿ2
|ğ‘Š|into Equation 9 we obtain:
âˆšğ‘›(ğ‘”(ğ‘ğ‘›)âˆ’0.5)â†’N
0,|ğ‘Š|
ğœ‹ğ‘Ÿ2(ln 2)2
24(â„2âˆ’1)
(lnâ„)2â„2
Therefore(ğ‘ğ‘›)ğ‘âˆ¼N
0.5,1
ğ‘›|ğ‘Š|
ğœ‹ğ‘Ÿ2(ln 2)2
24(â„2âˆ’1)
(lnâ„)2â„2
. Lastly, we scale
this expression by 2 and subtract 1 to arrive at the distribution for
LCF proper (Equation 6):
ğ¿ğ¶ğ¹(ğ‘âˆ—,ğ‘Ÿ,â„,ğ‘›)âˆ¼N
0,1
ğ‘›|ğ‘Š|
ğœ‹ğ‘Ÿ2(ln 2)2
22(â„2âˆ’1)
(lnâ„)2â„2
â–¡
Proof of Proposition 3.6.
lim
â„â†’1ğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)ğ‘
=lim
â„â†’1exp
lnğ‘(ğ‘Ÿ)
ğ‘(â„ğ‘Ÿ)ğ‘
=
lim
â„â†’1exp 
âˆ’ln 2
2 lnâ„
lnğ‘(â„ğ‘Ÿ)âˆ’ğ‘™ğ‘›ğ‘(ğ‘Ÿ)!
Changing variables as ğ‘Ÿ+ğœ–:=â„ğ‘Ÿ, we continue:
lim
ğœ–â†’0exp
âˆ’ln 2
2 ln 1+ğœ–
ğ‘Ÿ(lnğ‘(ğ‘Ÿ+ğœ–)âˆ’ğ‘™ğ‘›ğ‘(ğ‘Ÿ))
=
lim
ğœ–â†’0exp
âˆ’ln 2
2ğœ–
ln 1+ğœ–
ğ‘Ÿlnğ‘(ğ‘Ÿ+ğœ–)âˆ’ğ‘™ğ‘›ğ‘(ğ‘Ÿ)
ğœ–
=
lim
ğœ–â†’0exp
âˆ’ln 2
2ğœ–
ln 1+ğœ–
ğ‘Ÿğœ•lnğ‘(ğ‘Ÿ)
ğœ•ğ‘Ÿ
=
lim
ğœ–â†’0exp
âˆ’ln 2
2ğœ–
ln 1+ğœ–
ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
Substituting ğœ–=ğ‘Ÿğ‘§, we get:
lim
ğ‘§â†’0exp
âˆ’ln 2
2ğ‘§
ln 1+ğ‘§ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
=exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
2187KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Evgenia Martynova and Johannes Textor
â–¡
Proof of Proposition 3.7. Forğ‘Ÿ:ğ‘(ğ‘Ÿ)=0, ğ¿ğ¶ğ¹(ğ‘Ÿ)=âˆ’1
by definition. When ğ‘(ğ‘Ÿ)>0,ğ‘â€²(ğ‘Ÿ)â‰¥0sinceğ‘(ğ‘Ÿ)is monoton-
ically non-decreasing and ğ‘Ÿ>0as well. Thereforeln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)â‰¥0. It
follows that exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
âˆˆ[0,1], thereforeâˆ€ğ‘Ÿâ‰¥0ğ¿ğ¶ğ¹(ğ‘Ÿ)âˆˆ
[âˆ’1,1].
â–¡
Proof of Proposition 3.8. First, we consider ğ¿ğ¶ğ¹(ğ‘Ÿ)=âˆ’1. This
value occurs when ğ‘(ğ‘Ÿ)=0, which means maximum dispersion at
distanceğ‘Ÿ. Alternatively, this means exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
=0, which
would occur if the exponent argument is âˆ’âˆ. For finite observation
windows,ğ‘Ÿcannot approach infinity and since a smooth estimate
ofğ‘(ğ‘Ÿ)is used,ğ‘â€²(ğ‘Ÿ)is finite as well. Hence, ğ¿ğ¶ğ¹(ğ‘Ÿ)=âˆ’1only
for maximally regular patterns.
ğ¿ğ¶ğ¹(ğ‘Ÿ)=1yields exp
âˆ’ln 2
2ğ‘Ÿğ‘â€²(ğ‘Ÿ)
ğ‘(ğ‘Ÿ)
=1â‡’ğ‘â€²(ğ‘Ÿ)=0, hence
ğ‘(ğ‘Ÿ)=ğ‘. In essence, this means limğœ–â†’0ğ‘(ğ‘Ÿ+ğœ–)âˆ’ğ‘(ğ‘Ÿ)
ğœ–=0â‡’and
ğ‘(â„ğ‘Ÿ)=ğ‘(ğ‘Ÿ)if we takeâ„ğ‘Ÿ=ğ‘Ÿ+ğœ–.ğ‘(â„ğ‘Ÿ)=ğ‘(ğ‘Ÿ)is our definition
of maximal clustering at ğ‘Ÿ.
â–¡
A.3 Implementation Details
A.3.1 Approximation of Ë†ğ‘(ğ‘Ÿ)with SCAM. To obtain a better fit
we treat Ë†ğ‘(ğ‘Ÿ)as a piece-wise function and only use the spline
approximation ğ‘š(ğ‘Ÿ)when Ë†ğ‘(ğ‘Ÿğ‘–)>0:
Ëœğ‘(ğ‘Ÿ)=(
0,Ë†ğ‘(ğ‘Ÿ)=0
ğ‘š(ğ‘Ÿ),Ë†ğ‘(ğ‘Ÿ)>0(10)
Otherwise, the zero values of Ë†ğ‘(ğ‘Ÿ)would influence the SCAM
model too strongly, which would result in a poor fit for small dis-
tances. This is especially the case for patterns with low intensity
or repulsion. In addition, this ensures that ğ¿ğ¶ğ¹(ğ‘Ÿ)=âˆ’1when
ğ‘(ğ‘Ÿ)=0, as per definition.A.3.2 Implementation in R. Ë†ğ‘(ğ‘Ÿ)estimate is extracted from Rip-
leyâ€™sğ¾estimates obtained with the spatstat package (ver. 3.0-6)
[2]. This allows for out-of-the-box use of optimised implementa-
tions and standard edge correction methods. The scam package
(ver. 1.2-14) [ 21] is used to fit a monotonically increasing spline
approximation of Ë†ğ‘(ğ‘Ÿ)and the derivative is computed using the
splineDesign function from the splines package [23].
Estimates of ğ»PCF are obtained with the spatstat package
(ver. 3.0-6) as well.
A.4 Statistical Analysis Details
In all statistical analyses, we compare simulated point patterns with
fixed numbers of points by using a slightly increased intensity of a
Poisson process and then randomly subsampling the drawn point
patterns. It is a property of the Poisson process that its randomly
subsampled realization has a Poisson distribution as well [ 2]. Formal
descriptions of the Strauss and Matern cluster processes used in
simulations are given above.
A.4.1 Calibration. Letğ‘¡ğ‘™be the test statistic that corresponds to
theğ‘™â€™th point pattern drawn to simulate the null distribution in
the calibration analysis, ğ‘¡ğ‘š- test statistic of ğ‘šâ€™th point pattern
drawn to test for CSR and ğ‘¡ğ‘’- expected value of test statistics. In a
two-sided significance test, the p-value for the point pattern with
ğ‘¡ğ‘š<ğ‘¡ğ‘’, is computed as ğ‘ğ‘š=1
ğ¿Ãğ¿
ğ‘™=11(ğ‘¡ğ‘™â‰¤ğ‘¡ğ‘šorğ‘¡ğ‘™â‰¥ğ‘¡â€²ğ‘š),
whereğ‘¡â€²ğ‘šis the value at the same distance from ğ‘¡ğ‘’asğ‘¡ğ‘šon the right
(similarly for the case when ğ‘¡ğ‘š>ğ‘¡ğ‘’). Then, the rejection ratio at the
significance level ğ‘ isğ‘…=1
ğ‘€Ãğ‘€
ğ‘š=11(ğ‘ğ‘šâ‰¤ğ‘ ). For a one-sided test,
the p-value is ğ‘ğ‘š=1
ğ¿Ãğ¿
ğ‘™=11(ğ‘¡ğ‘™â‰¤ğ‘¡ğ‘š)orğ‘ğ‘š=1
ğ¿Ãğ¿
ğ‘™=11(ğ‘¡ğ‘™â‰¥ğ‘¡â€²ğ‘š)
B ONLINE RESOURCES
An R package implementing the local correlation function is avail-
able on GitHub at https://github.com/EvgeniyaMartynova/lcfstat.
Code for reproducing all analyses and figures is available on GitHub
at https://github.com/EvgeniyaMartynova/lcf_paper_figures. The
required data to reproduce Figure 6 can be downloaded from Zen-
odo at https://zenodo.org/records/11507398.
2188