Unsupervised Alignment of Hypergraphs with Different Scales
Manh Tuan Do
KAIST
Seoul, Republic of Korea
manh.it97@kaist.ac.krKijung Shin
KAIST
Seoul, Republic of Korea
kijungs@kaist.ac.kr
Abstract
People usually interact in groups, and such groups may appear on
different platforms. For instance, people often create various group
chats on messaging apps (e.g., Facebook Messenger and WhatsApp)
to communicate with families, friends, or colleagues. How do we
identify the same people across the two platforms based on the
information about the groups? This gives rise to the hypergraph
alignment problem, whose objective is to find the correspondences
between the sets of nodes of two hypergraphs. In a hypergraph, a
node represents a person, and each hyperedge represents a group
of several people. In addition, the two sets of hyperedges in the
two hypergraphs can vary significantly in scales as people may use
different apps at different time periods.
In this work, we propose and tackle the problem of unsupervised
hypergraph alignment. Given two hypergraphs with potentially dif-
ferent scales and without any side information or prior ground-truth
correspondences, we develop HyperAlign, a learning framework,
to find node correspondences across the two hypergraphs. Hyper-
Align directly addresses each challenge of the problem. In particu-
lar, it (a) extracts node features from the hypergraph topology, (b)
employs contrastive learning, as a â€œsupervised pseudo-alignmentâ€
task to pre-train the learning model (c) applies topological aug-
mentation to help a generative adversarial network to align the
two embedding spaces from the two hypergraphs. The purpose of
augmentation is to add virtual hyperedges from one hypergraph in
order to the other to resolve the scale difference and share infor-
mation across the two hypergraphs. Our extensive experiments on
12real-world datasets demonstrate the significant and consistent
superiority of HyperAlign over the baseline approaches.
CCS Concepts
â€¢Information systems â†’Data mining; Social networks.
Keywords
Hypergraph Alignment; Network Alignment; Scale Difference
ACM Reference Format:
Manh Tuan Do and Kijung Shin. 2024. Unsupervised Alignment of Hy-
pergraphs with Different Scales. In Proceedings of the 30th ACM SIGKDD
Conference on Knowledge Discovery and Data Mining (KDD â€™24), August
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Â©2024 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.367195525â€“29, 2024, Barcelona, Spain. ACM, New York, NY, USA, 12 pages. https:
//doi.org/10.1145/3637528.3671955
1 Introduction
How can we identify the same users across messaging apps such
as Facebook Messenger and WhatsApp based on the information
of the participants of the group chats? The problem of identify-
ing the user correspondences, across two sets of user groups, also
naturally arises from many other practical scenarios. Multiple sets
of user groups may appear on different platforms while involving
intrinsically similar sets of users. For example, researchers may list
their publication records, each of which is a group of co-authors,
on both Google Scholar and Research Gate. In another example,
users register accounts and engage in discussion threads, each
of which is a group of participating users, on multiple online fo-
rums. Establishing user correspondences across the sets of user
groups enables several applications1, including author name dis-
ambiguation [ 37] and identification of the right target users for
recommending friends or products [ 51]. It is often the case that
apart from the list of anonymized participants, no side information
is available due to privacy reasons. Furthermore, the two sets of
user groups can be very different in both scales and characteristics
as users may use one platform for a short period in the past then
switch to another platform and keep using it until the present.
This task is formulated as the hypergraph alignment problem,
where the objective is to find node correspondences between the
two node sets in two hypergraphs. Hypergraphs, which are the
general modeling of networks allowing multiple nodes to be in
the same group connection, naturally represent the group inter-
actions that are pervasive in practice [ 7,14,16,33,36,41]. In the
above scenarios, each node represents a user, and a hyperedge con-
stitutes a group of users sharing a group interaction. Apart from
social networks, hypergraph alignment has also proven applicable
in computer vision [ 34], chemistry [ 39], and biological research [ 30].
While one may assume the existence of node features and some
ground-truth node correspondences beside the given topologies,
these statistics might be unreliable and costly to obtain. Thus, in
this work, we assume an unsupervised setting where no side infor-
mation is known, and we are the first to tackle the unsupervised
hypergraph alignment problem relying solely on the topologies of
the two given hypergraphs.
Despite reflecting realistic scenarios and possessing potential
applications, the proposed problem poses a number of challenges:
(C1) The group interactions intrinsic to hypergraphs represent
complex information that cannot be fully captured by common
pairwise relationships [ 16,58],(C2) Due to privacy concerns, side
information of users, as node features, is not available, rendering
1To preserve privacy, this should only be performed upon usersâ€™ consent with proper
privacy protection techniques
 
609
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
it difficult to directly apply any learning-based methods, (C3) No
ground-truth node correspondences are available prior to training,
so it is mandatory to predict the correspondences for all nodes
simultaneously without any guidance even from a small subset of
nodes, and (C4) One hypergraph might be much larger and contain
hyperedges different from the other. Due to this disparity, it is not
straightforward to generalize from one hypergraph to another to
devise an alignment scheme.
For a specific case of hypergraphs, the graph alignment prob-
lem [ 49], which is the task of finding node correspondences in
two (or more) pair-wise graphs, has been well studied. The graph
alignment task has demonstrated various practical implications
in analyzing chemical compounds [ 6,50], semantic matching in
webs and databases [ 17,38], and entity matching in computer vi-
sion [ 10,53]. Recognizing such potential applications, numerous
methods have been proposed to tackle the alignment problem for
unipartite and bipartite graphs [5, 12, 13, 15, 20, 22, 25, 31].
One may represent each hypergraph as a unipartite graph, e.g.,
deriving the clique expansion, or a bipartite graph, e.g., by star
expansion (see Section 3.1), and apply these methods for the hyper-
graph alignment problem. However, they possess key limitations
when applied to our problem. Firstly, they are designed for the pair-
wise topology of graphs, but representing hyperedges by pair-wise
edges via the clique expansion always incurs information loss. In
addition, one hypergraph could have a much larger set of hyper-
edges compared with that of the other hypergraph. As a result,
any methods that rely on the star expansion and attempt to align
the respective hyperedge sets, which are node sets in the bipartite
graph representation, are likely to predict incorrectly, which in turn
leads to inaccurate predictions of node alignments.
To address the unsupervised hypergraph alignment task with
the aforementioned challenges, we introduce our method, Hyper-
Align, which makes no assumptions about the grouth-truth node
correspondences or node attributes and only leverages the hyper-
graph topology in a learning framework. HyperAlign first extracts
node features by properly extending struc2vec [46] to the hyper-
graph setting to address Challenges C1&C2.HyperAlign then
applies a Hypergraph Neural Network (HNN) to aggregate informa-
tion and learn the node embeddings via contrastive learning. This
contrastive learning acts as a supervised pseudo-alignment task
for pre-training the HNN to alleviate C3. After that, the method
applies a Generative Adversarial Network (GAN) to bridge the two
embedding spaces respective to the two hypergraphs. In order to
resolve the scale and information discrepancy, during the course
of training GAN, the topology of each hypergraph is augmented
based on the hyperedges of the counter-part hypergraph. This topo-
logical augmentation module addresses C4by affording the two
hypergraphs the same scale. Finally, the final node embeddings are
employed to predict node alignments across the two hypergraphs.
In short, our contributions in this research are three-fold:
â€¢New Problem: We formulate and tackle the problem of unsu-
pervised hypergraph alignment with unique challenges for the
first time, to the best of our knowledge.
â€¢Novel Method: We propose our method, HyperAlign, based
on three novel ideas: topological feature extraction, contrastive
learning as a proxy task, and topological augmentation.â€¢Extensive Experiments: We introduce various competitors and
variants of HyperAlign and perform experiments to demonstrate
a consistent and significant superiority of our method over those
baseline approaches.
Forreproducibility, the code and datasets are available at https:
//github.com/manhtuando97/HyperAlign.
The remaining sections of this paper are as follows: In Section 2,
we review some relevant work about hypergraphs and network
alignment. We introduce some preliminaries and formulate our
problem in Section 3. Our method is proposed in Section 4 and
evaluated in Section 5. Finally, we conclude our work in Section 6.
2 Related Work
Hypergraphs: Hypergraphs model group interactions in various
domains, such as research coauthorship, email records, online fo-
rums, or prescription labelling [ 7,16,57]. Most empirical studies
on hypergraphs focus on investigating individual real-world hy-
pergraphs for their structural patterns [ 7,16,28] and temporal
properties [ 8,24]. With the prevalence of representing datasets
as hypergraphs, there has been a growing interest in addressing
learning problems on hypergraphs, such as link prediction [ 26,55],
node classification [19, 27, 54], and clustering [2, 9, 64].
Supervised Network Alignment: Supervised network alignment
aims at identifying node correspondences across graphs given
that partial ground-truth correspondences are available in advance.
Based on the given correspondences and the graph topologies, the
task is to infer the correspondences of the remaining nodes. For
instance, COSNET [ 62] predicts the node correspondences that cap-
ture the neighborhood consistency at both the node and the graph
levels. On the other hand, CrossMNA [13],IONE [35],SNNA [31],
MINING [ 63], and cM2NE [ 52] leverage the given node correspon-
dences to learn the embeddings of the remaining nodes, which are
then employed for predicting correspondences. Some work targets
the alignment of hypergraphs assuming the existence of some prior
node correspondences [51] or hyperedge correspondences [60].
Unsupervised Network Alignment: As obtaining ground-truth
node correspondences is often difficult in various practical scenar-
ios, a line of work has tackled the problem of unsupervised graph
alignment. Several frameworks [ 5,25,61] assume the set of nodes
in one graph is a permutation of that of the other graph, formulate
graph alignment as an optimization problem, and find the optimal
solution to the problem as such permutation. Big-Align [25] also
employs an optimization approach to align two bipartite graphs.
On the other hand, REGAL [22] aggregates the degree informa-
tion of neighbors to compute a low-rank representation for each
node, which are used to predict correspondences. Following GAN-
based approaches, UUIL [32],DANA [15], and WAlign [20] employ
graph encoders to learn the node embeddings that minimize the
distance between the two embedding spaces of the two graphs.
Once the two embedding spaces are aligned, such embeddings are
utilized for matching nodes across the two graphs. Meanwhile,
Grad-Align+ [ 42] and SANA [ 43] train graph encoders with the aid
of augmentation to the node features or graph topology.
These existing methods are designed for the alignment of pair-
wise graphs, while our proposed method, HyperAlign, is the first to
address the unsupervised hypergraph alignment problem with the
 
610Unsupervised Alignment of Hypergraphs with Different Scales KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Table 1: Frequently used symbols.
Symb
ols Definition
Gğ‘–=(Vğ‘–,Eğ‘–)hyp
ergraph with node set Vğ‘–and hyperedge set Eğ‘–
Hğ‘–incidence
matrix of Gğ‘–
ğ‘šEthe
maximum size of a hyperedge in E
ğº[ğ‘™]ğ‘™-le
vel weighted complete graph of G
Xğ‘–no
de feature matrix of Gğ‘–
xğ‘–,ğ‘— featur
e vector of the ğ‘—-th node of Gğ‘–
Â¯Cğ‘–=(Â¯Gğ‘–,Â¯Xğ‘–)the
1st corrupted view of Gğ‘–
Ë†Cğ‘–=(Ë†Gğ‘–,Ë†Xğ‘–)the
2nd corrupted view of Gğ‘–
Î¦ hyp
ergraph encoder
Z(ğ‘˜)no
de vector matrix in layer (ğ‘˜)
Q(ğ‘˜)hyp
eredge vector in layer (ğ‘˜)
Â¯Zğ‘–and Ë†Zğ‘–no
de embedding matrices of Â¯Gğ‘–and Ë†Gğ‘–
âˆ¥ğ‘¥âˆ¥ğ¿2-norm
of vectorğ‘¥
ğ‘ (ğ‘¥,ğ‘¦)cosine
similarity of vectors ğ‘¥andğ‘¦
ğœ“ mapping
function as a neural network
G(.)generator
D
(.)discriminator
Zğ‘–final
node embedding matrix of Gğ‘–
zğ‘–,ğ‘— emb
edding vector of the ğ‘—-th node of Gğ‘–
entailed challenges. Methodologically, HyperAlign incorporates
novel ideas, including contrastive learning as a pseudo-alignment
task and topological augmentation for addressing scale differences.
The details of HyperAlign are outlined in Section 4.
3 Preliminaries & Problem Definition
3.1 Basic Concepts
In this section, we introduce some basic concepts. The key notations
can be found in Table. 1.
Hypergraphs: Ahypergraph is defined as G=(V,E), where V=
{ğ‘£1,...,ğ‘£|V|}is the set of nodes, and E={ğ‘’1,...,ğ‘’|E|}âŠ†2Vis the set
of hyperedges. Each hyperedgeğ‘’âŠ†Vis a set of|ğ‘’|(â‰¥2) nodes.2.
The matrix Hâˆˆ{0,1}|V|Ã—|E|in which H[ğ‘–][ğ‘—]=1ifğ‘£ğ‘–âˆˆğ‘’ğ‘—and0
otherwise is the incidence matrix ofG. Denoteğ‘šEas the maximum
size of a hyperedge in E, i.e.,ğ‘šE=maxğ‘’âˆˆE|ğ‘’|. A node having no
incident hyperedges is an isolated node.
Clique Expansion: The clique expansion of hypergraph Gis a
graph `ğº=(V,`ğ¸), where `ğ¸={{ğ‘¢,ğ‘£}|ğ‘¢,ğ‘£âˆˆV,âˆƒğ‘’âˆˆE,{ğ‘¢,ğ‘£}âŠ†ğ‘’}.
That is, `ğºis a graph in which two nodes ğ‘¢,ğ‘£âˆˆVare adjacent if
and only if there exists a hyperedge ğ‘’inEcontaining both ğ‘¢andğ‘£.
Star Expansion: Thestar expansion of hypergraph Gis a bipartite
graph Â´ğº=(V,U,Â´ğ¸), where U=E,Â´ğ¸={{ğ‘£,ğ‘¢}|ğ‘£âˆˆV,ğ‘¢âˆˆE,ğ‘£âˆˆğ‘¢}.
That is, Â´ğºis a bipartite graph in which the first node set is Vand
the second node set is E, andğ‘£âˆˆVandğ‘¢âˆˆUare adjacent if and
only ifğ‘£is incident to ğ‘¢inG.
Hypergraph Neural Networks (HNNs): HNNs are powerful tools
for learning node representations in hypergraphs. Recent HNNs [ 18,
19,23,56] commonly employ a two-step message-passing scheme:
node-to-hyperedge and hyperedge-to-node aggregations. They re-
cursively transform the representation vectors of hyperedges by
2In this study, for the sake of simplicity, we choose to exclude self-loops (i.e., hyperedges
of size 1) as they are not significantly helpful for alignment. Refer to the Online
Appendix [1] for the inspection of self-loopsaggregating information from their incident nodes and update the
representation vectors of nodes by aggregating information from
the incident hyperedges. Given Z(ğ‘˜)âˆˆR|V|Ã—ğ¹andQ(ğ‘˜)âˆˆR|E|Ã—ğ¹,
whereğ¹is the embedding dimension, as the node and hyperedge
representations at the ğ‘˜-layer of HNNs, the representation vectors
at the(ğ‘˜+1)-layer are computed as follows:
ğ‘(ğ‘˜+1)
ğ‘—=S(ğ‘˜+1)
Vâ†’E
ğ‘(ğ‘˜)
ğ‘—,{ğ‘§(ğ‘˜)
ğ‘–:ğ‘£ğ‘–âˆˆğ‘’ğ‘—}
,
ğ‘§(ğ‘˜+1)
ğ‘–=S(ğ‘˜+1)
Eâ†’V
ğ‘§(ğ‘˜)
ğ‘–,{ğ‘(ğ‘˜+1)
ğ‘—:ğ‘£ğ‘–âˆˆğ‘’ğ‘—}
,(1)
whereS(ğ‘˜+1)
Vâ†’EandS(ğ‘˜+1)
Eâ†’Vdenote the node-to-hyperedge and hyper-
edge-to-node aggregate functions at the (ğ‘˜+1)-layer, respectively,
and they often include multi-layer perceptrons for projection.
Contrastive Learning (CL): CL has proven effective in node rep-
resentation learning on (hyper)graphs [ 27,59]. The key idea is to
create two corrupted views Â¯Cand Ë†Cof the same network Gvia
perturbations of attributes and topologies and train an encoder to
maximize the agreement between node embeddings from Â¯Cand Ë†C.
Generative Adversarial Networks (GAN): GANs have been ap-
plied to tackle the graph alignment problem [ 15,20,32]. The discrim-
inator is trained to distinguish between the two node embedding
distributions, and the generator is trained to produce the node em-
beddings that minimize such distance. Once the node embeddings
are learned, each node is predicted to correspond with the node
having the most similar embedding in the counterpart graph.
3.2 Problem Definition
In this section, we define the problem and discuss the challenges.
Problem 1 (Unsupervised Hypergraph Alignment).
â€¢Given: two hypergraphs G1=(V1,E1)andG2=(V2,E2), where
|V1|â‰¤|V2|, without loss of generality,
â€¢Find: a correspondenceAâŠ‚ V1Ã—V2between V1andV2, where
|A|=min(|V1|,|V2|)=|V1|,
â€¢to Maximize: the number of correct alignments, i.e., |Aâˆ©C| ,
whereCâŠ‚ V1Ã—V2is the ground-truth node correspondences.
Unique Challenges: This problem poses a number of unique chal-
lenges. (C1) The group interactions intrinsic to hypergraphs render
any graph alignment methods improper as representing a hyper-
graph as a pair-wise graph always incurs information loss [ 16,58].
(C2) No node attributes are available. This absence reflects the
privacy protection in practice as the side information of users of-
ten remains strictly undisclosed. (C3) The problem assumes an
unsupervised setting, (i.e., there are no prior ground-truth node
correspondences or hyperedge correspondences). As a result, one
needs to rely solely on the topologies of the hypergraphs to predict
the correspondences for all nodes. (C4) Finally, the two respective
hyperedge sets might be substantially different in sizes. Therefore,
any attempts to represent the hypergraphs as bipartite graphs and
align the two bipartite graphs, i.e., aligning nodes and hyperedges
simultaneously, may risk being misled by incorrect predictions of
hyperedge alignments.
4 Proposed Method: HyperAlign
4.1 Overview (Figure 1 and Algorithm 1)
In this section, we provide an overview of our method HyperAlign
(see Algorithm 1), designed for addressing Problem 1 and its unique
 
611KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
Shared 
WeightsEncoder
ğœ±ğœ±
Encoder
ğœ±ğœ±Shared 
WeightsEncoder
ğœ±ğœ±
Encoder
ğœ±ğœ±ï¿½ğ’ğ’ğŸğŸ
ï¿½ğ’ğ’ğŸğŸ
ï¿½ğ’ğ’ğŸğŸ
ï¿½ğ’ğ’ğŸğŸShared 
WeightsEncoder
ğœ±ğœ±
Encoder
ğœ±ğœ±
Mapping ğğğ’ğ’ğŸğŸ
ğ’ğ’ğŸğŸğ’‡ğ’‡ğœ½ğœ½ï¿½ğ‘ªğ‘ªğŸğŸ
ï¿½ğ‘ªğ‘ªğŸğŸ
ï¿½ğ‘ªğ‘ªğŸğŸ
ï¿½ğ‘ªğ‘ªğŸğŸğ‘°ğ‘°ğŸğŸ
ğ‘°ğ‘°ğŸğŸğ‘°ğ‘°ğŸğŸâ€²
ğ‘°ğ‘°ğŸğŸâ€²Alignment PredictionContrast
Node Feature Masking
Membership MaskingSimilarity ComputationStep 4
Alignment Prediction
(ğ†ğ†ğŸğŸ,ğ—ğ—ğŸğŸ)Step 1
Feature Extraction
HyperFeatStep 2
Contrastive LearningStep 3              
Augmentation                                       GAN Training         
Original 
Incidence 
MatrixAugmented
Incidence 
Matrix
(ğ‘®ğ‘®ğŸğŸ,ğ‘¿ğ‘¿ğŸğŸ)Contrastğ†ğ†ğŸğŸ
ğ‘®ğ‘®ğŸğŸHyperFeatUpdate
Figure 1: Illustration of HyperAlign. In Step 1, node features are extracted from the topologies. For each hypergraph,
HyperAlign performs contrastive learning, i.e., â€œsupervised pseudo alignment", between two corrupted views in Step 2. In
Step 3, an adversarial framework is employed to align the two node embedding spaces of two augmented hypergraphs. Upon
obtaining embeddings, each node is predicted to correspond to the node having the most similar embeddings in Step 4.
challenges with three novel components: hypergraph feature ex-
traction, application of contrastive learning as a proxy task, and
topological augmentation.
HyperAlign utilizes the topology of each hypergraph to extract
node features, which is specialized to hypergraphs, to tackle Chal-
lenges C1&C2(Step 1). Then, it employs a Hypergraph Neural
Network (HNN) to output the node embeddings that are helpful
for alignment. For C3,HyperAlign first pre-trains the HNN pa-
rameters via a node contrastive learning task, which serves as a
â€œpseudo-alignment task" (Step 2). To this end, the method follows
an adversarial framework to align the two node embedding spaces,
assisted by topology augmentation (Step 3). The topological aug-
mentation module is proposed to afford the two input hypergraphs
the same scale, which addresses C4. Finally, HyperAlign predicts
the node alignments based on the similarities of the learned node
embeddings (Step 4). Figure 1 illustrates the steps of HyperAlign.
4.2 Step 1: HyperFeat- Feature Extraction
Given two hypergraphs G1andG2without any side information,
the first step of HyperAlign, HyperFeat, extracts node features
purely based on the topologies of G1andG2. The node features
serve as the input for the subsequent steps. HyperFeat is a proper
adaption of struc2vec [46] specialized to hypergraphs, which aims
to alleviate Challenges C1&C2of Problem 1. HyperFeat obtains
node features that preserve structural similarities, and the structural
similarities are defined based on the number of incident hyperedges
of different sizes, which are unique to hypergraphs.
In particular, nodes that are structurally similar are afforded
similar node features by HyperFeat. The key idea for HyperFeat
is to conduct a random walk to generate a corpus, a sequence of
nodes, and apply a language model to extract the node features
from the corpus. Structurally similar nodes tend to appear close to
each other in the corpus.
To achieve that, HyperFeat constructsğ‘‡level graphs from the
original hypergraph, each of which is a weighted undirected com-
plete graph. In the ğ‘˜-level graph, ğ‘˜=0,...,ğ‘‡âˆ’1, the weight ofAlgorithm 1: Overview of HyperAlign
Problem Input: hypergraphs G1=(V1,E1)andG2=(V2,E2)
Method Input: (a) number of contrastive learning iterations Î“cl,
(b) number of GAN training iterations Î“g,
(c) number of discriminator training iterations Î“d,
(d) number of reconstruction function training iterations Î“r
Output: predicted node correspondences AâŠ‚ V2Ã—V2
1/* Step 1: HyperFeat - Feature Extraction */
2Extract Xğ‘–from Gğ‘–,ğ‘–=1,2as in Section 4.2
3/* Step 2: HyperCL - Contrastive Learning */
4foriter=1,...,Î“cldo
5 forğ‘–=1,2do
6 Create corrupted views Â¯Cğ‘–,Ë†Cğ‘–from(Gğ‘–,Xğ‘–)
7 Update parameters of Î¦to minimizeLğ‘–
CL(Eq. (5))
8/* Step 3: HyperAug - GAN Training with Augmentation */
9ËœG1â†G1,ËœG2â†G2
10forepoch =1,...,Î“gdo
11 Z1,Z2=Î¦((ËœG1,X1)),ğœ“(Î¦(ËœG2,X2))
12 foriter=1,...,Î“ddo
13 TrainDto approximate Wasserstein distance of Z1andZ2
14 foriter=1,...,Î“rdo
15 Update parameters of r1andr2to minimizeLre(Eq. (7))
16 Update parameters of Î¦,ğœ“to minimizeLtotal(Eq. (8))
17 Augment ËœG1,ËœG2accordingly to Algorithm. 2
18/* Step 4: Alignment Prediction */
19Aâ†âˆ…
20forğ‘–=1,...,|V1|do
21ğ‘—=argmaxğ‘—=1,...,|V2|ğ‘ (z1,ğ‘–,z2,ğ‘—)
22 Predictğ‘£â€²
ğ‘—âˆˆV2={ğ‘£â€²
1,...,ğ‘£â€²
|V2|}as aligned with ğ‘£ğ‘–âˆˆV1
23Aâ†Aâˆª{( ğ‘£ğ‘–,ğ‘£â€²
ğ‘—)}
24returnA
the edge connecting nodes ğ‘¢andğ‘£is inversely proportional to the
structural difference in the ğ‘˜-hop neighborhoods of ğ‘¢andğ‘£. In other
words, the more similar the two neighborhoods are, the greater
the weight is. HyperFeat then conducts a random walk on these ğ‘‡
 
612Unsupervised Alignment of Hypergraphs with Different Scales KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
level graphs to generate the corpus. The details on how to define
the structural difference, construct the level graphs, conduct the
random walk, and obtain node features are explained as follows.
Structural Difference: We describe how to compute the struc-
tural difference between each node pair. In order to quantify the
structural identity of each node ğ‘¢in hypergraph G=(V,E), we
represent it by a incidence vector Î›ğ‘¢=[ğœ†ğ‘¢(2),...,ğœ†ğ‘¢(ğ‘”âˆ—)], where
ğ‘”âˆ—is the maximum hyperedge size in Eandğœ†ğ‘¢(ğ‘ )is the number of
hyperedges of size ğ‘ that are incident to ğ‘¢.
In our setting, the structural difference ğ‘‘ğ‘˜(ğ‘¢,ğ‘£)of theğ‘˜-hop
neighborhoods of nodes ğ‘¢andğ‘£is defined inductively as follows:
ğ‘‘ğ‘˜(ğ‘¢,ğ‘£)=ğ‘‘ğ‘˜âˆ’1(ğ‘¢,ğ‘£)+ğ‘š(ğ‘ (ğ‘ğ‘˜(ğ‘¢)),ğ‘ (ğ‘ğ‘˜(ğ‘£))),âˆ€ğ‘˜â‰¥1,(2)
whereğ‘‘0(ğ‘¢,ğ‘£)=âˆ¥Î›ğ‘¢âˆ’Î›ğ‘£âˆ¥1;ğ‘ğ‘˜(ğ‘¢)andğ‘ğ‘˜(ğ‘£)denote the set of
nodes that are exactly ğ‘˜-hops away from ğ‘¢andğ‘£, respectively3;
ğ‘ (ğ‘ğ‘˜(ğ‘¢))andğ‘ (ğ‘ğ‘˜(ğ‘£))denote the sequence of incidence vectors Î›
of such nodes, respectively; and ğ‘š(ğ‘ (ğ‘ğ‘˜(ğ‘¢)),ğ‘ (ğ‘ğ‘˜(ğ‘£)))is a distance
measure of such two sequences.
For each hyperedge size ğ‘”=2,...,ğ‘”âˆ—, we useğœ†ğ‘¤(ğ‘”)to denote the
number of size- ğ‘”incident hyperedges of each node ğ‘¤inğ‘ğ‘˜(ğ‘¢)and
ğ‘ğ‘˜(ğ‘£). We compute the Dynamic Time Warping [ 47] between two
respective sequences {ğœ†ğ‘¤(ğ‘”)}ğ‘¤âˆˆğ‘ (ğ‘ğ‘˜(ğ‘¢))and{ğœ†ğ‘¤â€²(ğ‘”)}ğ‘¤â€²âˆˆğ‘ (ğ‘ğ‘˜(ğ‘£))
ofğ‘ (ğ‘ğ‘˜(ğ‘¢))andğ‘ (ğ‘ğ‘˜(ğ‘£)). Let this value be ğ‘šğ‘”(ğ‘ (ğ‘ğ‘˜(ğ‘¢)),ğ‘ (ğ‘ğ‘˜(ğ‘£))).
After that, we then obtain ğ‘š(ğ‘ (ğ‘ğ‘˜(ğ‘¢))by taking the summation:
ğ‘š(ğ‘ (ğ‘ğ‘˜(ğ‘¢)),ğ‘ (ğ‘ğ‘˜(ğ‘£)))=Ãğ‘”âˆ—
ğ‘”=2ğ‘šğ‘”(ğ‘ (ğ‘ğ‘˜(ğ‘¢)),ğ‘ (ğ‘ğ‘˜(ğ‘£))).
Construction of Level Graphs: Based on the difference measure,
defined in Eq. (2), we describe how to construct the ğ‘‡level graphs
ğº[0],...,ğº[ğ‘‡âˆ’1]. The process is adapted from one used in [ 46],
which we refer readers to for in-depth understanding and details.
Forğ‘™=0,...,(ğ‘‡âˆ’1),ğº[ğ‘™]is a complete graph. In ğº[ğ‘™], the edge
between nodes ğ‘¢andğ‘£has weightğ‘’âˆ’ğ‘‘ğ‘™(ğ‘¢,ğ‘£), so a lower structural
difference (higher structural similarity) leads to a higher weight.
Random Walk: To generate a corpus, HyperFeat employs a bi-
ased Random Walk (RW) to generate a sequence of nodes. In each
time step, at node ğ‘›in theğ‘™-level graph ğº[ğ‘™], RW moves to another
node inğº[ğ‘™]or to nodeğ‘›in eitherğº[ğ‘™âˆ’1]orğº[ğ‘™+1]. In the former
case, the probability of moving to each node ğ‘£is proportional to the
weight of edge(ğ‘¢,ğ‘£). As a result, the proximity of any node ğ‘¢in the
corpus will likely include the nodes that are structurally similar to
ğ‘¢. In the latter case, RW moves to another level graph with different
edge weights. More details are explained in Appendix D.
Language Model: Once we obtain a corpus, we employ Skip-Gram
with Negative Sampling (SGNS) [ 40] to extract the node features
from the corpus. For a node ğ‘¢, SGNS aims to maximize the likelihood
of its context in the corpus, where the context of ğ‘¢is a window of
sizeWcentered on it. As structurally similar nodes tend to be in
close proximity, they are afforded similar node features.
In summary, for each hypergraph Gğ‘–(ğ‘–=1,2),HyperFeat ex-
tracts a node feature matrix Xğ‘–âˆˆR|Vğ‘–|Ã—ğ¹, which preserves the
structural similarity uniquely defined on hypergraphs.
We present some theoretical properties of HyperFeat in Sec-
tion 4.6 and show its empirical superiority over a straightforward
application of struc2vec [46] in Section 5.3.
3That is,ğ‘ğ‘˜(ğ‘¢)is the nodes exactly ğ‘˜-hop away from ğ‘¢in the clique expansion of G.4.3 Step 2: HyperCL- Contrastive Learning
After the node features in Step 1 are obtained, Step 2, referred
to as HyperCL, conducts Contrastive Learning (CL) (refer to Sec-
tion 3.1) in each input hypergraph to pre-train the Hypergraph
Neural Network Î¦. CL aims to maximize the similarity between the
representations of the same node across the two views Â¯Cand Ë†Cof
each hypergraph Gwhile minimizing the similarity between the
representations of different nodes.
This serves as a supervised proxy task for Problem 1 to address
Challenge C3. In particular, by performing node-level contrastive
learning on Â¯Cand Ë†C, we create a â€œsupervised pseudo-alignmentâ€
task whose objective is to maximize the similarity of the represen-
tations of the same node so that an alignment predictor can find the
exact node correspondences based on the representation vectors.
In other words, we pre-train Î¦aiming to solve the hypergraph
alignment between Â¯Cand Ë†Cwith ground-truths. In addition, via
CL, we encourage Î¦to represent different nodes in the same hy-
pergraph with dissimilar vectors to help the alignment step avoid
confusion among similar node representations when predicting
node correspondences.
For each input hypergraph Gğ‘–,ğ‘–=1,2,HyperCL creates two
corrupted views, obtains node embeddings in each view via Î¦, and
trains Î¦via an objective (Eq. (5)).
Creation of Views by Corruption: For each hypergraph G=
(V,E), its incidence matrix H, and its node feature matrix X(i.e.,
output of HyperFeat), we create two corrupted views, Â¯C=(Â¯G,Â¯X)
and Ë†C=(Ë†G,Ë†X), by performing the following operations for each:
â€¢Feature Masking We create a random binary mask of size ğ¹,
where each entry is independently sampled from a Bernoulli
distributionB(1âˆ’ğ‘ğ‘“), and use it to mask features of all nodes.
That is,ğ‘ğ‘“is the probability that each entry of Xis replaced with
0. We apply feature masking on Xto create Â¯Xand Ë†X.
â€¢Membership Masking We create a random binary mask of
sizeÃ|V|
ğ‘–=1Ã|E|
ğ‘—=1H[ğ‘–][ğ‘—](the number of non-zero entries in the
incidence matrix H), where each entry is independently sampled
from a Bernoulli distribution B(1âˆ’ğ‘ğ‘š), and use it to mask nodes
in the hyperedges. That is, ğ‘ğ‘šis the probability that each node
in each hyperedge is removed. We apply membership masking
onGto create Â¯Gand Ë†G.
Hypergraph Encoder: For each hypergraph Gand its node fea-
ture matrix X,Î¦embeds the nodes with representation vectors by
the two-step message-passing scheme as in Eq. (1). For HyperAlign,
Î¦uses the following aggregation functions [18]:
Q(ğ‘˜)=ğœ Dâˆ’1
EHğ‘‡Z(ğ‘˜âˆ’1)Î˜(ğ‘˜)
E+ğ‘(ğ‘˜)
E,
Z(ğ‘˜)=ğœ Dâˆ’1
VHQ(ğ‘˜)Î˜(ğ‘˜)
V+ğ‘(ğ‘˜)
V,(3)
where Z(0)=X;ğœdenotes a non-linear activation function; DEâˆˆ
N|E|Ã—|E|is the diagonal matrix where each diagonal entry is the size
of a hyperedge; DVâˆˆN|V|Ã—|V|is the diagonal matrix where each
diagonal entry is the number of incident hyperedges of each node;
Î˜(ğ‘˜)
EandÎ˜(ğ‘˜)
Vare trainable weight matrices; and ğ‘(ğ‘˜)
Eandğ‘(ğ‘˜)
V
are trainable bias vectors. The output of Î¦is the node embedding
matrix in the last layer. That is, for each corrupted view, Î¦outputs
a node embedding matrix: Â¯Z=Î¦(Â¯G,Â¯X)and Ë†Z=Î¦(Ë†G,Ë†X).
 
613KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
Training Objective: LetÂ¯ğ’›ğ‘—be theğ‘—-th row of Â¯Z, which denotes
the embedding vector of the ğ‘—-th node of Gin the view Â¯C. Similarly,
letË†ğ’›ğ‘—denote the embedding vector of the ğ‘—-th node of Gin the
view Ë†C. We aim to maximize the similarity of the representation
vectors of each node in both views while minimizing the similarity
with the representations of other nodes. In particular, Î¦is trained
to minimize Normalized Temperature-scaled Cross Entropy [11]:
â„“(Â¯ğ’›ğ‘—,Ë†ğ’›ğ‘—)=âˆ’logğ‘’ğ‘ (Â¯ğ’›ğ‘—,Ë†ğ’›ğ‘—)/ğœ
Ã|V|
ğ‘˜=1ğ‘’ğ‘ (Â¯ğ’›ğ‘—,Ë†ğ’›ğ‘˜)/ğœ, (4)
whereğ‘ (ğ‘¥,ğ‘¦)denotes the cosine similarity of vectors ğ‘¥andğ‘¦, and
ğœis a temperature hyperparameter. Based on this term, the final
loss for pre-training Î¦inHyperCL is defined as follows:
LCL=1
2|ğ‘‰|âˆ‘ï¸|ğ‘‰|
ğ‘—=1
â„“(Â¯ğ’›ğ‘—,Ë†ğ’›ğ‘—)+â„“(Ë†ğ’›ğ‘—,Â¯ğ’›ğ‘—)	
. (5)
In summary, for each input hypergraph Gğ‘–and its node features
Xğ‘–(i.e., output of HyperFeat), we create two corrupted views Â¯Cğ‘–
and Ë†Cğ‘–; and pre-train the encoder Î¦to minimizeLğ‘–
CLin Eq. (5). By
doing so, we leverage (a) the similarity between CL and Problem 1,
and (b) the pseudo-labels, which are only obtainable for CL.
4.4 Step 3: HyperAug- GAN Training with
Topological Augmentation
AfterÎ¦is pre-trained in Step 2, for Step 3, referred to as HyperAug,
we adopt a GAN to train Î¦to produce node embeddings that are
aligned across G1andG2. During the process, we propose topo-
logical augmentation to share information between the two input
hypergraphs. This augmentation also ensures that the two hyper-
graphs have the same number of hyperedges in order to resolve
their scale differences, i.e., Challenge C4.
GAN Training: Motivated by the effectiveness of GAN in aligning
graphs [ 15,20,32], we train an adversarial framework to align the
two node embedding spaces of the hypergraphs. Note that Hyper-
Align is agnostic to the GAN model, and we employ Wasserstein-
GAN [ 3] in this work. Particularly, the generator Gconsists of the
hypergraph encoder Î¦, pre-trained in HyperCL, and a neural net-
workğœ“:G=(Î¦,ğœ“).Gmaps the two hypergraphs with their node
feature matrices (from HyperFeat in Section 4.2) to two respective
node embedding matrices Z1,Z2:
Z1,Z2=G((G1,X1),(G2,X2))=Î¦(G1,X1),ğœ“(Î¦(G2,X2))(6)
Note that the parameters of Î¦are shared between G1andG2, and
an additional mapping function ğœ“is applied for the node embedding
matrix of G2to account for the differences between G1andG2.
The discriminatorDlearns to approximate the Wasserstein dis-
tance (or Earth-Mover Distance) WEM(Z1,Z2)between Z1andZ2.
The generatorGthen tries to minimize the distance by minimizing
the lossLgen=WEM(Z1,Z2). More details on Wasserstein GAN
are explained in Appendix E. Refer to the Online Appendix [ 1] for
a comparison of several GAN models in alignment performance.
Reconstruction Loss: To avoid mode collapse, i.e., the situation
when all the embeddings become the same vector, we include an
additional loss term to encourage Gto output node embeddings
that contain sufficient information to reconstruct the node featuresAlgorithm 2: Topological Augmentation
Input: (a) hypergraphs G1=(V1,E1)andG2=(V2,E2), (b) their
node embedding matrices Z1andZ2, (c) a valueğ‘¡âˆˆN,
Output: updated incidence matrix ËœH2ofG2
1Compute S2,1âˆˆR|V2|Ã—|V1|in which S2,1[ğ‘–,ğ‘—]=ğ‘ (z1,ğ‘–,z2,ğ‘—)
2Obtain Sâ€²
2,1from S2,1by
3 (i) keeping only the top ğ‘¡values in each column,
4 (ii) changing other entries to 0,
5 (iii) performing column-wise normalization
6Hâ€²
1â†Sâ€²
2,1H1
7ËœH2â†Column-Concat(H2,Hâ€²
1)
8return ËœH2
(i.e., output of HyperFeat). The loss term for reconstruction is:
Lre=âˆ‘ï¸|V1|
ğ‘–=1âˆ¥r1(z1,ğ‘–)âˆ’x1,ğ‘–âˆ¥+âˆ‘ï¸|V2|
ğ‘—=1âˆ¥r2(z2,ğ‘—)âˆ’x2,ğ‘—âˆ¥,(7)
where r1,r2are the reconstruction functions, as neural networks,
ofG1andG2that aim to minimize Lre.
Given a hyperparameter ğ›½âˆˆ[0,1], the total loss term for Gis:
Ltotal=ğ›½Lgen+(1âˆ’ğ›½)Lre (8)
Topological Augmentation: In order to assist GAN, we construct
virtual hyperedges from one hypergraph to augment the other. This
augmentation shares hyperedges across the two hypergraphs to
resolve their scale disparity, directly addressing Challenge C4.
For each hyperedge ğ‘’âˆˆE1, we augment a â€œsoft virtual hy-
peredge"ğ‘’â€²toE2, and vice versa. Each membership of a node
ğ‘£âˆˆV1,ğ‘£âˆˆğ‘’is translated into probabilistic memberships of ğ‘¡
nodes of V2inğ‘’â€². We repeat this for all nodes in ğ‘’to formğ‘’â€².
To achieve that, for any column H1[:][ğ‘˜]ofH1corresponding to
a hyperedge ğ‘’inE1, we construct a virtual column vector ğ‘(of|V2|
entries), corresponding to a virtual hyperedge ğ‘’â€², to augment to H2.
Inğ‘, all entries are first initialized with 0. For each node ğ‘£âˆˆV1,ğ‘£âˆˆğ‘’,
we select the top ğ‘¡nodes in V2having the representation vectors
(from Z2) bearing the highest similarities with that of ğ‘£(from Z1).
We denote them by ğ‘£â€²
1,...,ğ‘£â€²
ğ‘¡and denote such similarity values by
ğ‘ ğ‘£(ğ‘£â€²
ğ‘—),ğ‘—=1,...,ğ‘¡. After that, the entry corresponding to node ğ‘£â€²
ğ‘—
inğ‘is incremented withğ‘ ğ‘£(ğ‘£â€²
ğ‘—)
Ãğ‘¡
ğ‘™=1ğ‘ ğ‘£(ğ‘£â€²
ğ‘™)forğ‘—=1,...,ğ‘¡. By this, node ğ‘£
is represented in G2as â€œsoft correspondences" of the nodes in V2
having the most similar representation vectors with that of ğ‘£. We
repeat this step with other non-zero entries of H1[:][ğ‘˜]to fill inğ‘.
The sums of the entries in H1[:][ğ‘˜]andğ‘are both equal to|ğ‘’|.
We proceed similarly with all columns of H1to obtain their
corresponding virtual columns, which will be added to H2. We
stack these virtual columns, including ğ‘, to form an augmented
incidence matrix Hâ€²
1âˆˆR|V2|Ã—|E1|. We concatenate Hâ€²
1toH2to form
ËœH2âˆˆR|V2|Ã—(|E1|+|E2|). This is equivalent to adding â€œsoft virtual hy-
peredges" from G1toG2in which the binary incidence entries are
replaced with real-valued entries. The procedure is outlined in Algo-
rithm 2. Similarly, we add virtual columns, obtained from H2, toH1
to attain an updated incidence matrix ËœH1âˆˆR|V1|Ã—(|E1|+|E2|)forG1.
AsËœH1and ËœH2have the same number of columns, the hypergraphs
share the same scale after this topological augmentation.
At each iteration of GAN training, we conduct the aforemen-
tioned augmentations to create two augmented hypergraphs ËœG1and
 
614Unsupervised Alignment of Hypergraphs with Different Scales KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
ËœG2. In the next iteration, we compute Z1,Z2=G((ËœG1,X1),(ËœG2,X2)),
trainDaccording to Eq. (12), and trainGaccording to Eq. (8). Note
that to apply Î¦onËœGğ‘–, we only need to replace Hğ‘–in Eq. (3)with ËœHğ‘–
and update DEğ‘–andDVğ‘–, accordingly, based on the â€œsoft numberâ€
of incident nodes and hyperedges, respectively.
4.5 Step 4: Alignment Prediction
Given the respective embedding matrices Z1andZ2from Step
3,HyperAlign predicts the node correspondences between G1
andG2. Recall that, without loss of generality, we assume that
|V1|â‰¤|V2|. For each node ğ‘£ğ‘–âˆˆV1of embedding z1,ğ‘–, we predict
its correspondence among the nodes in V2={ğ‘£â€²
1,...,ğ‘£â€²
|V2|}as the
nodeğ‘£â€²
ğ‘—âˆˆV2having the most similar embedding z2,ğ‘—, i.e.,ğ‘—=
argmaxğ‘—=1,...,|V2|{ğ‘ (z1,ğ‘–,z2,ğ‘—)}. We repeat this for all nodes in V1
and return the set of all predicted correspondences A.
4.6 Theoretical Results
In this section, we present the time complexity and other theoretical
properties of HyperAlign. All proofs are presented in the Online
Appendix [1].
Letğ‘”âˆ—
ğ‘–denote the maximum hyperedge size in Eğ‘–,ğ‘–=1,2. The
time complexity HyperAlign, when considering all hyperparame-
ters of HyperAlign as constants, isOÃ2
ğ‘–=1ğ‘”âˆ—
ğ‘–(|Eğ‘–|+|Vğ‘–|2log|Vğ‘–|)
.
Also, our method has an OÃ2
ğ‘–=1(Ã
ğ‘’âˆˆEğ‘–|ğ‘’|+|Vğ‘–|log|Vğ‘–|)+| V1||V2|
space complexity. Refer to the Online Appendix [ 1] for the details.
Moreoever, we present the theoretical results for a special case
ofHyperFeat (Step 1). In this special case, HyperFeat only con-
siders the structural differences among nodes at a particular ğ‘™-hop
neighborhood and generates a sequence of nodes by Random Walk
on theğ‘™-level graph ğº[ğ‘™].
In the aforementioned case, we show that when the corpus length
ğ¿is sufficiently large, HyperFeat obtains the node features by
performing an implicit factorization of a constant matrix.
Theorem 3 (HyperFeat as Matrix Factorization). Assume
that HyperFeat only generates the corpus by Random Walk on one
level graphğº[ğ‘™]. When the corpus length ğ¿â†’âˆ , the embeddings
produced by HyperFeat result from an implicit factorization of a
constant matrix Mâˆ—.
One common approach when extracting node features based on
matrix factorization is to conduct Singular Value Decomposition
(SVD) on the matrix [ 22,29,44]. Let HyperFeat* be a version of
HyperFeat that extracts node feature matrix Xby performing
Singular Value Decomposition of Mâˆ—=UÎ£VT,X=Uâˆš
Î£.
In Theorem 4, we show that HyperFeat* can provide sufficient
conditions to conclude that two hypergraphs are non-isomorphic.
Two hypergraphs are isomorphic if one hypergraph is obtained
by applying a node permutation on the other. Hypergraph isomor-
phism [ 4] determines if two given hypergraphs are isomorphic,
which is a special case of the hypergraph alignment problem where
the two hypergraphs are only different by a node permutation.
Theorem 4 (HyperFeat* as Isomorphism Test). IfHyperFeat*
maps the nodes of hypergraphs H1andH2to two different sets of
node embeddings, H1andH2are not isomorphic.5 Experiments
5.1 Experiment Settings
Datasets: We use 12real-world hypergraphs across 6domains. The
details of the datasets are provided in Appendix C.
Dataset Preprocessing: Each dataset constitutes a list of time-
stamped hyperedges ğ‘’1,...,ğ‘’ğ‘‡âˆ—. The hypergraph G1is created by
collecting hyperedges ğ‘’1,...,ğ‘’ğ‘‡1(ğ‘‡1<ğ‘‡âˆ—). To replicate the practical
scenarios, we consider two ways to construct the hypergraph G2:
â€¢Configuration 1:G2consists of hyperedges ğ‘’ğ‘‡1+1,...,ğ‘’ğ‘‡âˆ—. This
reflects the scenario that people use one platform in the past
(forG1) and then switch to another platform (for G2).G1hasğ‘‡1
hyperedges, and G2hasğ‘‡2=ğ‘‡âˆ—âˆ’ğ‘‡1hyperedges.
â€¢Configuration 2:G2consists of hyperedges ğ‘’1,...,ğ‘’ğ‘‡âˆ—, soG2
hasğ‘‡2=ğ‘‡âˆ—hyperedges.. This reflects the scenario that each
hypergraph represents a snapshot of user history at two different
times in which a snapshot contains the list of hyperedges from
the beginning up to the time when the snapshot is taken.
We keep the original node ids for G1and permute them to ob-
tain the node ids for G2. Due to the space limit, in this section,
we only present the results for Configuration 1. The results for
Configuration 2 are reported in the Online Appendix [1].
Competitors: We consider the following competitors:
â€¢Big-Align: We apply Big-Align, an alignment method for bipar-
tite graphs, on the star expansions of the two hypergraphs.
â€¢REGAL: We apply the method xNetMF [ 22] to generate node
representations used for alignment. We consider two variants
REGAL-g andREGAL-h when applying xNetMF for the clique
expansion and the original hypergraph, respectively.
â€¢Grad-Align+: This method [ 42] incorporates degree information
to node features and trains a graph encoder to maximize the
similarity in representations of the two graphs.
â€¢SANA: SANA [ 43] augments each graph and optimizes a graph
encoder to align the original and augmented graphs.
â€¢UUIL: UUIL [32] uses GAN to minimize the distance between the
distributions of node embeddings of clique-expanded graphs.
â€¢DANA: This method [15] employs CyCleGAN, instead of GAN.
â€¢WAlign: WAlign [20] uses Wasserstein GAN instead of GAN.
More details on the competitors are in Appendix A.1.
Hyperparameter Selection: As the problem assumes an unsu-
pervised manner, we consider several sets of hyperparameters for
each method and report the performance of the globally best set of
hyperparameters. Details can be found in Appendix A.2.
Baselines: In addition, we also consider two simple baselines:
â€¢SVD: We obtain the node embeddings by applying Singular Value
Decomposition on the incidence matrix of each hypergraph and
employ the node embeddings for alignment prediction.
â€¢HyperFeat: We directly use the node features extracted in Step
1 -HyperFeat (Section 4.2) for alignment prediction.
Evaluation Metric: Given the setAof predicted node correspon-
dences and the ground-truth C, we evaluate each method by the
alignment accuracy ğ´, which is defined as ğ´=|Aâˆ©C|/|C| ,
i.e., (the number of correct predicted correspondences) / (the total
number of ground-truth correspondences).
 
615KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
Table 2: Means and standard deviations of alignment accuracy (in %) over five independent runs of all methods. The best
alignment accuracies are in bold. HyperAlign consistently outperforms the competitors and baselines.
Dataset SVD
HyperFeat Big-Align
REGAL-g REGAL-h Grad-Align+ SANA UUIL DANA WAlign HyperAlign
coauth-Ge
ology 19.18Â±0.05
22.23Â±0.82 25.18Â±0.67
27.63Â±0.59 32.58Â±0.73 33.04Â±0.93 35.78Â±1.04 33.47Â±1.24 35.62Â±1.08 34.62Â±1.14 45.02Â±1.18
coauth-Histor
y 18.03Â±0.07
19.67Â±0.41 20.75Â±0.34
26.28Â±0.27 27.97Â±0.36 28.03Â±0.87 28.48Â±0.92 28.23Â±1.07 28.44Â±1.27 28.59Â±1.02 37.94Â±0.98
contact-high 22.43Â±0.03
30.27Â±0.37 32.54Â±0.31
35.87Â±0.43 38.71Â±0.38 40.69Â±0.78 41.97Â±0.78 41.59Â±0.82 42.86Â±0.74 43.41Â±0.57 51.92Â±0.74
contact-primar
y26.78Â±0.04
32.51Â±0.33 31.29Â±0.28
36.28Â±0.25 38.57Â±0.41 41.64Â±0.81 42.19Â±0.78 40.43Â±0.57 42.25Â±0.67 43.08Â±0.73 53.27Â±0.65
email-Enr
on 25.91Â±0.01
33.19Â±0.27 34.85Â±0.41
36.31Â±0.35 39.46Â±0.38 40.36Â±0.81 41.07Â±0.62 39.68Â±0.71 40.87Â±0.73 41.23Â±0.78 48.41Â±0.72
email-Eu 24.49Â±0.02
31.27Â±0.29 31.95Â±0.38
34.31Â±0.42 35.85Â±0.46 36.29Â±0.73 37.52Â±0.78 37.12Â±0.54 38.51Â±0.58 38.73Â±0.61 49.76Â±0.73
NDC-classes 31.27Â±0.04
35.31Â±0.32 37.35Â±0.41
38.16Â±0.36 40.38Â±0.42 42.36Â±0.77 42.78Â±0.51 42.91Â±0.86 42.83Â±0.78 44.52Â±0.64 51.48Â±0.87
NDC-substances 32.25Â±0.11
36.05Â±0.38 38.17Â±0.43
41.68Â±0.31 44.13Â±0.43 46.04Â±0.65 45.61Â±0.87 45.27Â±0.77 46.85Â±0.81 47.19Â±0.73 57.84Â±0.96
thr
eads-ubuntu 21.43Â±0.04
26.52Â±0.44 28.47Â±0.53
34.59Â±0.56 37.53Â±0.51 40.67Â±0.94 42.15Â±0.81 39.84Â±0.71 42.07Â±0.83 43.94Â±0.89 53.37Â±1.04
thr
eads-math 22.69Â±0.06
25.23Â±0.51 27.39Â±0.49
31.83Â±0.43 32.28Â±0.52 32.85Â±0.91 33.47Â±1.02 32.41Â±0.91 33.83Â±0.84 34.13Â±0.73 44.06Â±1.12
Cora 24.59Â±0.06
31.37Â±0.45 30.88Â±0.63
33.29Â±0.38 35.46Â±0.53 37.72Â±0.93 38.11Â±0.97 36.83Â±0.89 38.25Â±1.04 37.94Â±1.13 50.63Â±1.14
Pubme
d 23.72Â±0.18
29.55Â±0.52 31.02Â±0.46
31.81Â±0.61 32.28Â±0.67 33.09Â±0.88 33.42Â±0.92 33.18Â±1.14 33.06Â±0.97 33.59Â±1.09 42.16Â±1.08
Table 3: Means and standard deviations of alignment ac-
curacy (in %) over five independent runs of five versions of
HyperAlign. The full-fledged version performs best, demon-
strating the effectiveness of the three key novel components
ofHyperAlign.
Dataset HyperAlign HA-s
HA-WC HA-WA HA-WAC
coauth-Ge
ology 45.02Â±1.18 43.06Â±1.03
42.17Â±1.13 41.84Â±1.06 36.47Â±1.09
coauth-History 37.94Â±0.98 35.92Â±0.89
35.31Â±0.92 33.89Â±0.94 30.37Â±1.04
contact-high 51.92Â±0.74 48.78Â±0.83
47.58Â±0.74 47.03Â±0.71 44.92Â±0.82
contact-primary 53.27Â±0.65 50.27Â±0.71
48.03Â±0.85 46.74Â±0.92 43.25Â±0.68
email-Enron 48.41Â±0.72 46.03Â±0.84
44.81Â±0.81 43.71Â±0.86 41.36Â±0.89
email-Eu 49.76Â±0.73 49.02Â±0.67
48.23Â±0.72 46.61Â±0.96 39.11Â±0.79
NDC-classes 51.48Â±0.87 49.92Â±0.79
49.15Â±0.83 47.98Â±0.86 45.08Â±0.76
NDC-substances 57.84Â±0.96 54.87Â±1.03
53.72Â±0.94 51.33Â±0.87 47.31Â±0.82
threads-ubuntu 53.37Â±1.04 50.64Â±0.82
49.14Â±0.93 48.41Â±1.08 45.18Â±0.97
threads-math 44.06Â±1.12 41.57Â±0.86
41.07Â±0.82 39.62Â±1.04 34.58Â±0.91
Cora 50.63Â±1.14 46.87Â±1.04
46.13Â±0.97 44.92Â±1.02 41.13Â±0.86
Pubmed 42.16Â±1.08 40.35Â±1.03
39.67Â±0.95 39.04Â±0.86 36.71Â±0.91
Evaluation settings: For each method, we report the average
alignment accuracy and standard deviation of 5independent runs.
Unless specified otherwise, the results are reported for Configura-
tion 1when the ratio ğ‘‡2:ğ‘‡1â‰ˆ2.
5.2 RQ1. Alignment Performance
In this section, we compare our method HyperAlign against the
baselines and competitors in terms of alignment accuracy. The
alignment accuracies of all methods in Configuration 1 when the
ratioğ‘‡2:ğ‘‡1â‰ˆ2are reported in Table 2. HyperAlign consistently
and significantly outperforms all the other methods.
In addition, we vary the ratio ğ‘‡2:ğ‘‡1and highlight the alignment
accuracies of HyperAlign and other methods in Figure 2. As the
level of difference between G1andG2increases, the performances
of all methods tend to decline, but HyperAlign consistently results
in the highest alignment accuracy.
5.3 RQ2. Ablation Study
We investigate the roles of HyperFeat, HyperCL, and the Topolog-
ical Augmentation module in HyperAug in the alignment accuracy
ofHyperAlign by comparing it with the following variants:
â€¢HA-s: This method is obtained by replacing HyperFeat with
struc2vec [46] to extract node features in Step 1.
â€¢HA-WC: This method is obtained by removing Step 2 -HyperCL,
the Contrastive Learning module, from HyperAlign.â€¢HA-WA: This method is obtained by removing Topological Aug-
mentation in Step 3 from HyperAlign.
â€¢HA-WAC: This method is obtaining by removing Contrastive
Learning (HyperCL) and Topological Augmentation (in Step 3)
from HyperAlign. Note that HA-WAC is equivalent to a simple
extension of WAlign that employs Hypergraph Neural Network
instead of Graph Neural Network.
As shown in Table 3, HyperAlign consistently outperforms HA-
s,HA-WA, and HA-WC across datasets. Also, all of the methods are
consistently more accurate than HA-WAC. This shows that all of
the three novel components of HyperAlign: HyperFeat- Feature
Extraction, HyperCL- Contrastive Learning as a proxy task, and the
Topological Augmentation module, to resolve the scale disparity,
inHyperAug contribute significantly to its performance.
To further examine the contribution of Contrastive Learning
and Topological Augmentation, we also vary the ratio ğ‘‡2:ğ‘‡1and
illustrate the performance of the variants of HyperAlign in Fig-
ure 3. While they all outperform WAlign, the performance decline
is severe for the variants (HA-WC, HA-WA, HA-WAC). These re-
sults illustrate the effectiveness of the Contrastive Learning and
Topological Augmentation modules in HyperAlign.
5.4 RQ3. Case Studies
We pinpoint several pairs of nodes in which each node is frequently
misaligned to correspond to the other. They represent nodes/objects
that are indeed very similar in practice. For example, in coauth-
Geology, the nodes representing prof. Stefan Schouten andprof. Jaap
Sinninghe DamstÃ©, who both serve as a Senior Research Leader in the
Department of Microbiology & Biogeochemistry of Royal Netherlands
Institute for Sea Research and have had 170joint research papers
(in the dataset), are frequently confused with each other. Similarly,
in email-Enron, the frequently confused nodes represent Ms. Louis
Kitchen andMr. John Lovorato who both work as Chief Operating
Officers of Enron Americas. In another example, in NDC-classes,
the node representing human insulin is often mistaken as the node
representing analog insulin, and vice versa.
Additionally, we conduct a misalignment analysis of Hyper-
Align and the competitors. Due to the space constraint, we present
the analysis in Appendix B.1. These results imply that while each
competitor only marginally complements HyperAlign, our method
can correctly predict correspondences for a larger portion of the
 
616Unsupervised Alignment of Hypergraphs with Different Scales KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
1 2 3 4
Ratio2040Accuracy (%)
coauth-Geology
1 2 3 4
Ratio2040
coauth-History
1 2 3 4
Ratio2040
contact-high
1 2 3 4
Ratio2550
contact-primary
1 2 3 4
Ratio2040
email-Enron
1 2 3 4
Ratio2040
email-Eu
1 2 3 4
Ratio2040Accuracy (%)
NDC-classes
1 2 3 4
Ratio4060
NDC-substances
1 2 3 4
Ratio2550
threads-ubuntu
1 2 3 4
Ratio2040
threads-math
1 2 3 4
Ratio2550
Cora
1 2 3 4
Ratio2040
PubmedHyperAlign WAlign DANA SANA REGAL-H Big-Align
Figure 2: Comparison in alignment accuracy of several methods when varying the difference ratio between the two hypergraphs.
As the ratio increases, the alignment task becomes more difficult, and HyperAlign consistently outperforms all the competitors.
1 2 3 4
Ratio304050Accuracy (%)
coauth-Geology
1 2 3 4
Ratio2040
coauth-History
1 2 3 4
Ratio4050
contact-high
1 2 3 4
Ratio4050
contact-primary
1 2 3 4
Ratio304050
email-Enron
1 2 3 4
Ratio304050
email-Eu
1 2 3 4
Ratio304050Accuracy (%)
NDC-classes
1 2 3 4
Ratio4060
NDC-substances
1 2 3 4
Ratio4050
threads-ubuntu
1 2 3 4
Ratio3040
threads-math
1 2 3 4
Ratio304050
Cora
1 2 3 4
Ratio2040
PubmedHyperAlign HyperAlign-WC HyperAlign-WA HyperAlign-WAC WAlign
Figure 3: Comparison in alignment accuracy of several variants of HyperAlign when varying the difference ratio between the
two hypergraphs. The variants of HyperAlign consistently outperform WAlign. As the ratio increases, the alignment task
becomes more difficult, and the performance decline is severe in these variants, showing the contributions of the Contrastive
Learning and Topological Augmentation modules in HyperAlign.
nodes misaligned by each competitor. Moreover, as the nodes mis-
aligned by HyperAlign can hardly be aligned correctly by other
methods, they are indeed difficult examples to align.
6 Conclusion
In this work, we introduce the problem of unsupervised hyper-
graph alignment, potentially with different scales, and discuss its
unique challenges. For this problem, we develop our method, Hy-
perAlign, which directly addresses each challenge of the problem
and predicts the node correspondences across two hypergraphs
in a completely unsupervised manner. HyperAlign utilizes the
hypergraph topology to extract node features, employs contrastive
learning as a pseudo-supervised alignment task, and employs gener-
ative adversarial networks to align the two node embedding spaces.
To resolve the scale disparity between the input hypergraphs, Hy-
perAlign conducts topological augmentation that shares hyper-
edges across the two hypergraphs during the learning process. We
demonstrate empirically that HyperAlign outperforms 8 compet-
ing methods significantly and consistently across 10 real-worlddatasets. Through extensive experiments, we also illustrate the
significant contribution to the performance of each novel mod-
ule of HyperAlign. The code and datasets are available at https:
//github.com/manhtuando97/HyperAlign.
Social networks are an important application domain of hyper-
graph alignment with diverse practical implications. It is worth
noting that alignment on social networks involves using user data,
and privacy preservation is crucial. Similarly to machine learning
techniques, hypergraph alignment on social networks should only
be performed upon user consent with proper privacy protection
measures. A promising research direction is to devise alignment
workflows coupled with techniques to minimize privacy concerns.
Acknowledgements
This work was supported by Institute of Information & Communications
Technology Planning & Evaluation (IITP) grant funded by the Korea govern-
ment (MSIT) (No. 2022-0-00871, Development of AI Autonomy and Knowl-
edge Enhancement for AI Agent Collaboration) (No. RS-2019-II190075, Arti-
ficial Intelligence Graduate School Program (KAIST)).
 
617KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
References
[1]2024. Code, Datasets, and Online Appendix. https://github.com/manhtuando97/
HyperAlign.
[2]Ilya Amburg, Nate Veldt, and Austin Benson. 2020. Clustering in graphs and
hypergraphs with categorical edge labels. In The Web Conference.
[3]Martin Arjovsky, Soumith Chintala, and LÃ©on Bottou. 2017. Wasserstein GAN.
arXiv:1701.07875 [stat.ML]
[4]LÃ¡szlÃ³ Babai and Eugene M Luks. 1983. Canonical labeling of graphs. In Proceed-
ings of the fifteenth annual ACM symposium on Theory of computing. 171â€“183.
[5]Mohsen Bayati, Margot Gerritsen, David F Gleich, Amin Saberi, and Ying Wang.
2009. Algorithms for large, sparse network alignment problems. In ICDM.
[6]Mohsen Bayati, David F Gleich, Amin Saberi, and Ying Wang. 2013. Message-
passing algorithms for sparse network alignment. ACM Transactions on Knowl-
edge Discovery from Data (TKDD) 7, 1 (2013), 1â€“31.
[7]Austin R Benson, Rediet Abebe, Michael T Schaub, Ali Jadbabaie, and Jon Klein-
berg. 2018. Simplicial closure and higher-order link prediction. Proceedings of
the National Academy of Sciences 115, 48 (2018), E11221â€“E11230.
[8]Austin R Benson, Ravi Kumar, and Andrew Tomkins. 2018. Sequences of sets. In
KDD.
[9]Samuel BulÃ² and Marcello Pelillo. 2009. A game-theoretic approach to hypergraph
clustering. In NeurIPS.
[10] Liqun Chen, Zhe Gan, Yu Cheng, Linjie Li, Lawrence Carin, and Jingjing Liu.
2020. Graph optimal transport for cross-domain alignment. In ICML.
[11] Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton. 2020. A
simple framework for contrastive learning of visual representations. In ICML.
[12] Xiyuan Chen, Mark Heimann, Fatemeh Vahedian, and Danai Koutra. 2020. Cone-
align: Consistent network alignment with proximity-preserving node embedding.
InCIKM.
[13] Xiaokai Chu, Xinxin Fan, Di Yao, Zhihua Zhu, Jianhui Huang, and Jingping
Bi. 2019. Cross-network embedding for multi-network alignment. In The Web
Conference.
[14] Guilherme Ferraz de Arruda, Giovanni Petri, and Yamir Moreno. 2020. Social
contagion models on hypergraphs. Physical Review Research 2, 2 (2020), 023032.
[15] Tyler Derr, Hamid Karimi, Xiaorui Liu, Jiejun Xu, and Jiliang Tang. 2021. Deep
adversarial network alignment. In CIKM.
[16] Manh Tuan Do, Se-eun Yoon, Bryan Hooi, and Kijung Shin. 2020. Structural
patterns and generative models of real-world hypergraphs. In KDD.
[17] AnHai Doan, Jayant Madhavan, Pedro Domingos, and Alon Halevy. 2004. On-
tology matching: A machine learning approach. Handbook on ontologies (2004),
385â€“403.
[18] Yihe Dong, Will Sawin, and Yoshua Bengio. 2020. HNHBN: Hypergraph networks
with hyperedge neurons. In ICML Graph Representation Learning and Beyond
Workshop.
[19] Yifan Feng, Haoxuan You, Zizhao Zhang, Rongrong Ji, and Yue Gao. 2019. Hy-
pergraph neural networks. In AAAI.
[20] Ji Gao, Xiao Huang, and Jundong Li. 2021. Unsupervised graph alignment with
wasserstein distance discriminator. In KDD.
[21] Aditya Grover and Jure Leskovec. 2016. node2vec: Scalable feature learning for
networks. In Proceedings of the 22nd ACM SIGKDD international conference on
Knowledge discovery and data mining. 855â€“864.
[22] Mark Heimann, Haoming Shen, Tara Safavi, and Danai Koutra. 2018. Regal:
Representation learning-based graph alignment. In CIKM.
[23] Jianwen Jiang, Yuxuan Wei, Yifan Feng, Jingxuan Cao, and Yue Gao. 2019. Dy-
namic Hypergraph Neural Networks.. In IJCAI.
[24] Yunbum Kook, Jihoon Ko, and Kijung Shin. 2020. Evolution of real-world hyper-
graphs: Patterns and models without oracles. In ICDM.
[25] Danai Koutra, Hanghang Tong, and David Lubensky. 2013. Big-align: Fast bipar-
tite graph alignment. In ICDM.
[26] Tarun Kumar, K Darwin, Srinivasan Parthasarathy, and Balaraman Ravindran.
2020. HPRA: Hyperedge prediction using resource allocation. In WebSci.
[27] Dongjin Lee and Kijung Shin. 2023. Iâ€™m Me, Weâ€™re Us, and Iâ€™m Us: Tri-directional
contrastive learning on hypergraphs. In AAAI.
[28] Geon Lee, Jihoon Ko, and Kijung Shin. 2020. Hypergraph motifs: concepts,
algorithms, and discoveries. (2020).
[29] Omer Levy and Yoav Goldberg. 2014. Neural word embedding as implicit matrix
factorization. NeurIPS (2014).
[30] Bo Li, Yong Zhang, Chengyang Zhang, Xinglin Piao, Yongli Hu, and Baocai
Yin. 2024. Multi-scale hypergraph-based feature alignment network for cell
localization. Pattern Recognition 149 (2024), 110260.
[31] Chaozhuo Li, Senzhang Wang, Yukun Wang, Philip Yu, Yanbo Liang, Yun Liu,
and Zhoujun Li. 2019. Adversarial learning for weakly-supervised social network
alignment. In AAAI.
[32] Chaozhuo Li, Senzhang Wang, Philip S Yu, Lei Zheng, Xiaoming Zhang, Zhoujun
Li, and Yanbo Liang. 2018. Distribution distance minimization for unsupervised
user identity linkage. In CIKM.
[33] Jianbo Li, Jingrui He, and Yada Zhu. 2018. E-tail product return prediction via
hypergraph-based local graph cut. In KDD.[34] Xiaowei Liao, Yong Xu, and Haibin Ling. 2021. Hypergraph neural networks for
hypergraph matching. In ICCV.
[35] Li Liu, William K Cheung, Xin Li, and Lejian Liao. 2016. Aligning Users across
Social Networks Using Network Embedding.. In IJCAI, Vol. 16.
[36] Qingshan Liu, Yuchi Huang, and Dimitris N Metaxas. 2011. Hypergraph with
sampling for image retrieval. Pattern Recognition 44, 10-11 (2011), 2255â€“2262.
[37] Bradley Malin. 2005. Unsupervised name disambiguation via social network
similarity. In SIAM Workshop on link analysis, counterterrorism, and security.
[38] Sergey Melnik, Hector Garcia-Molina, and Erhard Rahm. 2002. Similarity flooding:
A versatile graph matching algorithm and its application to schema matching. In
ICDE.
[39] Tom Michoel and Bruno Nachtergaele. 2012. Alignment and integration of
complex networks by hypergraph-based spectral clustering. Physical Review E
86, 5 (2012), 056111.
[40] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. 2013.
Distributed representations of words and phrases and their compositionality.
Advances in neural information processing systems 26 (2013).
[41] Min Ouyang, Michel Toulouse, Krishnaiyan Thulasiraman, Fred Glover, and
Jitender S Deogun. 2002. Multilevel cooperative search for the circuit/hypergraph
partitioning problem. IEEE Transactions on Computer-Aided Design of Integrated
Circuits and Systems 21, 6 (2002), 685â€“693.
[42] Jin-Duk Park, Cong Tran, Won-Yong Shin, and Xin Cao. 2022. GradAlign+:
Empowering gradual network alignment using attribute augmentation. In CIKM.
[43] Jingkai Peng, Fei Xiong, Shirui Pan, Liang Wang, and Xi Xiong. 2023. Robust Net-
work Alignment with the Combination of Structure and Attribute Embeddings.
InICDM.
[44] Jiezhong Qiu, Yuxiao Dong, Hao Ma, Jian Li, Kuansan Wang, and Jie Tang. 2018.
Network embedding as matrix factorization: Unifying deepwalk, line, pte, and
node2vec. In WSDM.
[45] Svetlozar Todorov Rachev et al .1990. Duality theorems for Kantorovich-
Rubinstein and Wasserstein functionals. (1990).
[46] Leonardo FR Ribeiro, Pedro HP Saverese, and Daniel R Figueiredo. 2017. struc2vec:
Learning node representations from structural identity. In KDD.
[47] Stan Salvador and Philip Chan. 2007. Toward accurate dynamic time warping in
linear time and space. Intelligent Data Analysis 11, 5 (2007), 561â€“580.
[48] Prithviraj Sen, Galileo Namata, Mustafa Bilgic, Lise Getoor, Brian Galligher, and
Tina Eliassi-Rad. 2008. Collective classification in network data. AI magazine 29,
3 (2008), 93â€“93.
[49] Rohit Singh, Jinbo Xu, and Bonnie Berger. 2008. Global alignment of multiple
protein interaction networks with application to functional orthology detection.
Proceedings of the National Academy of Sciences 105, 35 (2008), 12763â€“12768.
[50] Aaron Smalter, Jun Huan, and Gerald Lushington. 2008. Gpm: A graph pattern
matching kernel with diffusion for chemical compound classification. In 2008 8th
IEEE International Conference on BioInformatics and BioEngineering. IEEE, 1â€“6.
[51] Shulong Tan, Ziyu Guan, Deng Cai, Xuzhen Qin, Jiajun Bu, and Chun Chen. 2014.
Mapping users across networks by manifold alignment on hypergraph. In AAAI.
[52] Hao Xiong, Junchi Yan, and Li Pan. 2021. Contrastive multi-view multiplex
network embedding with applications to robust network alignment. In KDD.
[53] Minghao Xu, Hang Wang, Bingbing Ni, Qi Tian, and Wenjun Zhang. 2020. Cross-
domain detection via graph-induced prototype alignment. In CVPR.
[54] Naganand Yadati, Madhav Nimishakavi, Prateek Yadav, Vikram Nitin, Anand
Louis, and Partha Talukdar. 2019. HyperGCN: a new method of training graph
convolutional networks on hypergraphs. In NeurIPS.
[55] Naganand Yadati, Vikram Nitin, Madhav Nimishakavi, Prateek Yadav, Anand
Louis, and Partha Talukdar. 2020. NHP: Neural hypergraph link prediction. In
CIKM.
[56] Jaehyuk Yi and Jinkyoo Park. 2020. Hypergraph convolutional recurrent neural
network. In KDD.
[57] Hao Yin, Austin R Benson, Jure Leskovec, and David F Gleich. 2017. Local
higher-order graph clustering. In KDD.
[58] Se-eun Yoon, Hyungseok Song, Kijung Shin, and Yung Yi. 2020. How much and
when do we need higher-order information in hypergraphs? a case study on
hyperedge prediction. In The Web Conference.
[59] Yuning You, Tianlong Chen, Yongduo Sui, Ting Chen, Zhangyang Wang, and
Yang Shen. 2020. Graph contrastive learning with augmentations. In NeurIPS.
[60] Ron Zass and Amnon Shashua. 2008. Probabilistic graph and hypergraph match-
ing. In CVPR. IEEE.
[61] Jiawei Zhang and S Yu Philip. 2015. Multiple anonymized social networks
alignment. In ICDM.
[62] Yutao Zhang, Jie Tang, Zhilin Yang, Jian Pei, and Philip S Yu. 2015. Cosnet:
Connecting heterogeneous social networks with local and global consistency. In
KDD.
[63] Zhongbao Zhang, Shuai Gao, Sen Su, Li Sun, and Ruiyang Chen. 2023. MIN-
ING: Multi-granularity network alignment based on contrastive learning. IEEE
Transactions on Knowledge and Data Engineering (2023).
[64] Dengyong Zhou, Jiayuan Huang, and Bernhard SchÃ¶lkopf. 2006. Learning with
hypergraphs: Clustering, classification, and embedding. (2006).
 
618Unsupervised Alignment of Hypergraphs with Different Scales KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
A Additional Experimental Details
A.1 Details on the competitors
Big-Align is the method for aligning two bipartite graphs. We
represent each hypergraph as a bipartite graph connecting the set
of nodes and the set of hyperedges by star expansion. We apply Big-
Align to align the two star expansions, i.e., finding correspondences
between the two sets of nodes and correspondences between the
two sets of hyperedges across the two hypergraphs.
UUIL, DANA, Grad-Align+, and WAlign are learning graph
alignment methods that require input node features. For the evalu-
ation in Section 5, we apply each method on the clique expansions
of the two hypergraphs. We apply struc2vec [46] to generate the
node features for UUIL ,Grad-Align+, and WAlign as they assume
the existence of node features. We apply node2vec [21] to produce
node features for DANA accordingly to [15].
A.2 Hyperparameter Search
We describe the hyperparameter search space for HyperAlign and
the following competitors: REGAL-g, REGAL-h, DANA, Grad-
Align+, SANA, and WAlign as these methods that consider hyper-
parameter search in the original papers. For each competitor, we
tune the hyperparameters that its original paper analyzed. Refer to
the original papers for full descriptions of the hyperparameters.
REGAL-g &REGAL-h: We vary the hyperparameter values as
follows:
â€¢Numberğ‘˜of neighborhood hops: ğ‘˜âˆˆ{2,3,4}.
â€¢Discount factor ğ›¿for greater hop distances: ğ›¿âˆˆ{0.01,0.05}.
â€¢Node embedding dimension ğ‘¡log2|V|:ğ‘¡âˆˆ{2,6,10}.
DANA: We vary the hyperparameter values as follows:
â€¢Node feature dimension ğ¹(from node2vec[21]): ğ¹âˆˆ{64,128}.
â€¢Hidden layer dimension ğ‘‘of the discriminator: ğ‘‘âˆˆ{128,256,512}.
â€¢Weightğœ†of the Cycle Consistency Loss term in the objective:
ğœ†âˆˆ{1,5,25}.
Grad-Align+: We vary the hyperparameter values as follows:
â€¢Dimension of augmented attribute vectors ğ‘‘:ğ‘‘âˆˆ{20,30,40}.
SANA: We vary the hyperparameter values as follows:
â€¢Node embedding dimension ğ‘‘:ğ‘‘âˆˆ{64,128}.
WAlign: We vary the hyperparameter values as follows:
â€¢Numberğ‘˜of neighborhood hops to aggregate information for
the Graph Neural Networks: ğ‘˜âˆˆ{2,3,4}.
â€¢Hidden layer dimension ğ‘‘of the Graph Neural Networks: ğ‘‘âˆˆ
{128,256,512}.
HyperAlign: We vary the hyperparameter values as follows:
â€¢Node feature dimension ğ¹ofHyperFeat: ğ¹âˆˆ{64,128}.
â€¢Corruption rate of feature masking and membership .masking
(ğ‘ğ‘“,ğ‘ğ‘š)inHyperCL:(ğ‘ğ‘“,ğ‘ğ‘š)âˆˆ{( 0.1,0.1),(0.2,0.2),(0.3,0.3)}.
â€¢Numberğ‘¡of the most similar nodes to select to construct aug-
mented incidence matrices in the Topological Augmentation step
ofHyperAug: ğ‘¡âˆˆ{3,5}.
â€¢Weightğ›½of the generator loss term in Eq 8: ğ›½âˆˆ{0.99,0.95,0.9}.
B Additional results
In this section, we present additional experimental results for the
misalignment analysis of HyperAlign and the running time.
05001000Elapsed Time (s)coauth-Geology
05001000coauth-History
Method05001000Elapsed Time (s)threads-ubuntu
Method05001000threads-mathHyperAlign WAlign DANA SANA REGAL-H Big-AlignFigure 4: Comparison in running time among HyperAlign
and the strongest competitors. Big-Align tends to takes the
longest running time, the gap among all the other methods
is not substantial.
B.1 Misalignment Analysis
We present further analysis on the alignment performance of our
method HyperAlign. In particular, for each competitor, we measure
the following values:
â€¢O:The percentage of nodes incorrectly aligned by the competitor
that are correctly aligned by HyperAlign.
â€¢C:The percentage of nodes incorrectly aligned by HyperAlign
that are correctly aligned by the respective competitor.
The results for the analysis are reported in Table 4. Note that as
HyperAlign consistently performs best, the number of misaligned
nodes by any competitor is always greater than the number of nodes
that are incorrectly aligned by HyperAlign. The results suggest
that while each competitor only marginally complements Hyper-
Align, our method can correctly align a larger portion of the nodes
misaligned by the competitor. Moreover, as the nodes misaligned
byHyperAlign can hardly be aligned correctly by other methods,
they are indeed difficult examples to predict correspondences. .
B.2 Running Time
The comparison in running time HyperAlign and the strongest
competitors is highlighted in Figure 4. While Big-Align has the
longest running time, the difference among the other methods is
not substantial.
C Datasets
In this paper, we use 10hypergraph datasets [ 7] across 5domains
(2 datasets each domain) and 2co-citation datasets [ 48]. For each
dataset, we use its 3-core. Specifically, we eliminate non-distinguishable
nodes with identical structures, i.e., isolated nodes and isolated hy-
peredges, and retain the nodes with a sufficient number of incident
hyperedges, following the practice of [ 25]. The datasets we use are:
â€¢co-authorship (coauth-Geology andcoauth-History ): each node
is a researcher, and each hyperedge represents the list of co-
authors in a publication that results from the joint work of these
researchers. The research disciplines are Geology and History.
 
619KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Manh Tuan Do and Kijung Shin
Table 4: The percentage of nodes misaligned by each baseline/competitor that are correctly aligned by HyperAlign (O) and
the percentage of nodes misaligned by HyperAlign that are correctly aligned by that method (C). While each each only
complements HyperAlign slightly, HyperAlign considerably complements all baselines and competitors.
DatasetSVD
HyperFeat Big-Align REGAL-g REGAL-h Grad-Align+ SANA UUIL DANA WAlign
O
C O C O C O C O C O C O C O C O C O C
coauth-Ge
ology 33.28
1.92 30.73 2.02 28.13 2.19 28.37 5.71 27.31 10.86 22.92 6.13 18.94 5.32 23.09 6.93 22.13 8.82 19.24 3.96
coauth-History 28.13
5.07 23.98 1.61 26.85 6.59 25.41 11.39 24.29 12.13 19.68 6.86 19.61 7.35 17.98 5.14 20.62 8.47 19.56 7.44
contact-high 39.21
1.93 32.27 1.77 30.29 2.19 27.16 2.84 25.21 4.65 21.61 3.29 18.92 2.14 20.87 3.87 19.48 4.31 20.69 6.65
contact-primary 38.26
3.26 32.15 2.01 33.76 2.61 30.64 5.42 26.15 2.92 26.58 8.31 27.62 10.46 44.86 17.91 24.16 6.34 20.78 3.51
email-Enron 32.16
2.58 24.58 2.33 23.71 3.65 22.49 4.31 20.57 6.79 18.03 5.24 18.14 6.49 17.31 3.32 19.45 7.68 14.02 2.05
email-Eu 34.27
1.21 28.57 2.28 27.97 2.43 25.58 2.69 24.43 3.51 21.99 1.08 20.74 1.43 20.25 0.19 20.41 2.42 21.15 3.84
NDC-classes 31.75
3.32 26.31 1.75 26.87 5.57 26.97 6.92 22.67 4.98 19.42 4.27 18.76 4.19 20.59 6.56 19.33 4.95 17.22 5.35
NDC-substances 38.62
1.51 35.47 2.12 34.26 3.59 32.47 6.59 28.71 5.53 26.01 5.29 25.09 3.36 27.35 5.69 23.63 3.72 23.45 4.11
threads-ubuntu 42.08
2.41 37.25 1.12 38.78 6.09 33.72 7.02 32.11 9.04 27.13 7.28 24.34 6.14 27.63 6.63 27.76 10.25 21.55 5.69
threads-math 28.49
1.17 25.63 0.59 24.61 2.14 22.95 6.11 22.65 6.36 19.95 3.91 19.49 4.26 19.11 2.26 22.16 7.93 17.64 3.02
Cora 36.02
2.27 29.27 1.68 31.74 4.43 29.24 4.39 26.39 3.78 23.78 2.76 25.26 4.37 24.16 2.48 22.92 6.52 23.71 4.67
Pubmed 26.21
2.68 19.58 2.05 18.61 2.94 20.29 6.03 18.13 4.15 15.68 3.11 17.82 3.68 16.67 2.59 16.24 4.89 16.33 4.32
Table 5: Basic statistics of the 3-cores of the considered real-
world hypergraph after being preprocessed.
Dataset|V||E|
coauth-Geology 9,570 43,480
coauth-History 14,968 29,646
contact-high 327 7,818
contact-primary 242 12,704
email-Enron 143 1,457
email-Eu 900 24,912
NDC-classes 514 744
NDC-substances 1,754 6,288
threads-ubuntu 7,522 35,910
threads-math 9,655 78,865
Cora 1,217 1,348
Pubmed 3,503 7.614
â€¢contact (contact-high and contact-primary ): each node repre-
sents an individual student, and each hyperedge resents a group
interaction among several students (high school/primary school).
â€¢email (email-Enron andemail-Eu ): each node represents an email
address, and each hyperedge consists of the sender and recipients
of an email. The email records are collected from the company
Enron (email-Enron) or a European research institute (email-Eu).
â€¢drugs (NDC-classes andNDC-substances ): each node represents
a drug class/substance, and each hyperedge represents a drug
that consists of of several classes/substances.
â€¢threads (threads-ubuntu andthreads-math ): each node represents
a user in an online forum, and each hyperedge represents the list
of users asking/answer in a question thread4.
â€¢Co-citation (Cora andPubmed ): each node represents a paper,
and each hyperedge represents citation links.
Refer to Table 5 for their basic statistics.
D Additional Details of HyperFeat
In this section, we present additional details on Step 1 - HyperFeat.
Based on the structural difference ğ‘‘ğ‘™(.,.)at theğ‘™-level graph,
defined in Section 4.2, we measure the transition probabilities de-
scribed in the Random Walk.
4http://www.askubuntu.com or http://www.math.stackexchange.comLetw[ğ‘™]denote the sum of all edge weights in the ğ‘™-level graph:
w[ğ‘™]=âˆ‘ï¸
(ğ‘¢,ğ‘£)âˆˆ(V
2)ğ‘¤(ğ‘¢,ğ‘£)=âˆ‘ï¸
(ğ‘¢,ğ‘£)âˆˆ(V
2)ğ‘’âˆ’ğ‘‘ğ‘™(ğ‘¢,ğ‘£)(9)
In each time step, at node ğ‘›in theğ‘™-level graph ğº[ğ‘™], RW moves
to another node in ğº[ğ‘™]with probability ğ‘,ğ‘âˆˆ(0,1)or moves to
nodeğ‘›in eitherğº[ğ‘™âˆ’1]orğº[ğ‘™+1]with probability(1âˆ’ğ‘). In the
former case, the probability of moving to each node ğ‘£is equal to
ğ‘’âˆ’ğ‘‘ğ‘™(ğ‘›,ğ‘£)
Ã
ğ‘¡âˆˆV,ğ‘¡!=ğ‘¢ğ‘’âˆ’ğ‘‘ğ‘™(ğ‘›,ğ‘¡). As a result, the context of any node ğ‘¢will likely
include the nodes that demonstrate high structural similarities
(low structural differences) with ğ‘¢. In the latter case, the chances
for choosing ğº[ğ‘™âˆ’1]orğº[ğ‘™+1]arew[ğ‘™+1]/(w[ğ‘™âˆ’1]+w[ğ‘™+1])and
w[ğ‘™âˆ’1]/(w[ğ‘™âˆ’1]+w[ğ‘™+1]), respectively. As ğ‘‘ğ‘™+1(ğ‘¢,ğ‘£)â‰¥ğ‘‘ğ‘™âˆ’1(ğ‘¢,ğ‘£),
âˆ€ğ‘¢,ğ‘£âˆˆV,w[ğ‘™+1]â‰¤w[ğ‘™âˆ’1]and we prefer to generate nodes based
onğ‘‘ğ‘™+1as it tends to make each node more distinctive.
E Details of Wasserstein GAN
In this section, we provide additional details of the discriminator
Dand the generatorGin Step 3 (see Section 4.4) of HyperAlign.
Given the two respective node embedding distributions P1=
{z1,ğ‘–}|V1|
ğ‘–=1andP2={z2,ğ‘—}|V2|
ğ‘—=1of hypergraphs G1andG2, the dis-
criminatorDaims to approximate the Earth-Mover (EM) distance
or the Wasserstein-1 distance between P1andP2:
W(P1,P2)= inf
ğ›¾âˆˆÎ (P1,P2)E(z1,z2)âˆ¼ğ›¾[âˆ¥z1âˆ’z2âˆ¥], (10)
where Î (P1,P2)is the set of all joint distributions between P1and
P2. Due to the Kantorovich-Rubinstein duality [45], it holds that:
W(P1,P2)=sup
âˆ¥ğ‘“âˆ¥â‰¤1Ez1âˆ¼P1[ğ‘“(z1)]âˆ’Ez2âˆ¼P2[ğ‘“(z2)].(11)
Therefore,Dcan be expressed as a parametrized function ğ‘“ğœƒ, and
the parameters ğœƒare trained to minimize the following loss:
Ldis=âˆ’
Ez1âˆ¼P1[ğ‘“ğœƒ(z1)]âˆ’Ez2âˆ¼P2[ğ‘“ğœƒ(z2)]	
. (12)
OnceDis trained, by Eq. (12), the Wasserstein-1 distance W(P1,P2)
between P1andP2is approximated as W(P1,P2)â‰ˆEz1âˆ¼P1[ğ‘“ğœƒ(z1)]âˆ’
Ez2âˆ¼P2[ğ‘“ğœƒ(z2)], and that is the loss LgenforGto minimize to map
the two node embedding distributions of G1andG2closer:
Lgen=Ez1âˆ¼P1[ğ‘“ğœƒ(z1)]âˆ’Ez2âˆ¼P2[ğ‘“ğœƒ(z2)]. (13)
 
620