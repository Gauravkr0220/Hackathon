Revisiting Local PageRank Estimation on Undirected Graphs:
Simple and Optimal
Hanzhi Wang
Renmin University of China
Beijing, China
hanzhi_wang@ruc.edu.cn
Abstract
We propose a simple and optimal algorithm, BackMC , for local PageR-
ank estimation in undirected graphs: given an arbitrary target
nodeğ‘¡in an undirected graph ğºcomprising ğ‘›nodes andğ‘šedges,
BackMC accurately estimates the PageRank score of node ğ‘¡while
assuring a small relative error and a high success probability. The
worst-case computational complexity of BackMC is upper bounded
byğ‘‚
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
, whereğ‘‘mindenotes the minimum de-
gree ofğº, andğ‘‘ğ‘¡denotes the degree of ğ‘¡, respectively. Compared
to the previously best upper bound of ğ‘‚
logğ‘›Â·min
ğ‘‘ğ‘¡,ğ‘š1/2
(VLDB â€™23), which is derived from a significantly more complex
algorithm and analysis, our BackMC improves the computational
complexity for this problem by a factor of Î˜logğ‘›
ğ‘‘min
with a much
simpler algorithm. Furthermore, we establish a matching lower
bound of Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
for any algorithm that attempts
to solve the problem of local PageRank estimation, demonstrating
the theoretical optimality of our BackMC . We conduct extensive ex-
periments on various large-scale real-world and synthetic graphs,
where BackMC consistently shows superior performance.
CCS Concepts
â€¢Mathematics of computing â†’Graph algorithms; â€¢Informa-
tion systemsâ†’Data mining.
Keywords
local PageRank estimation, undirected graphs, worst-case scenario
ACM Reference Format:
Hanzhi Wang. 2024. Revisiting Local PageRank Estimation on Undirected
Graphs: Simple and Optimal. In Proceedings of the 30th ACM SIGKDD
Conference on Knowledge Discovery and Data Mining (KDD â€™24), August
25â€“29, 2024, Barcelona, Spain. ACM, New York, NY, USA, 9 pages. https:
//doi.org/10.1145/3637528.3671820
1 Introduction
PageRank is a celebrated metric for assessing node centrality in
graphs, originally introduced by Google for ranking web pages
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Â©2024 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3671820based on their prominence within the web network [ 9,28]. Over
the past two decades, PageRank has evolved into one of the most
popular graph centrality metrics, with widespread applications
across diverse fields. These include social network analysis [ 19],
spam detection [ 20], recommender systems [ 17], graph representa-
tion learning [ 10,21], chemical informatics [ 26], and bioinformat-
ics [27], and more [ 14]. The computation of PageRank has become
a fundamental aspect of modern network analysis.
In recent years, the exponential growth in network sizes has
sparked significant interest in the field of local PageRank estima-
tion [ 1,3,7,8,11,22â€“25,31,32]. This problem focuses on the
approximation of a given target nodeâ€™s PageRank score, with the
goal of exploring only a small portion of the graph. Various practi-
cal applications illustrate the utility of local PageRank estimation.
For example, in recommender systems, there is a growing need to
quickly approximate the PageRank scores of individual users during
online operations, as opposed to performing time-consuming global
computations of determining all nodesâ€™ PageRank scores within a
graph [ 11]. Similarly, in web search scenarios, website owners who
are interested in enhancing their search engine rankings may only
seek the PageRank score of their specific websites, not those of the
entire web [ 3]. Additionally, in social networks, users often desire
to gauge their PageRank-based popularity by efficiently probing
the friendship graph, rather than having to traverse the entire net-
workr [ 3,31]. Therefore, it is imperative to have highly efficient
algorithms for local PageRank estimation.
This paper focuses on local PageRank estimation in undirected
graphs1. We aim to address the problem of computing, with proba-
bility(1âˆ’ğ‘ğ‘“), a multiplicative(1Â±ğ‘)-approximation of the PageR-
ank score for a given target node ğ‘¡in an undirected graph ğºcom-
prisingğ‘›nodes andğ‘šedges. Bothğ‘andğ‘ğ‘“are constants set within
the(0,1)range (e.g.,ğ‘=ğ‘ğ‘“=0.1). This problem is of great impor-
tance from both theoretical and practical aspects.
Theoretical Motivations. Existing studies on local PageRank
estimation can be broadly divided into two categories. The first
category focuses on the approximation of a single nodeâ€™s PageRank
score on general directed graphs [ 7,8,23,25,32], while the second
specifically targets undirected graphs [ 22,31]. For directed graphs,
the best-known lower bound ofÎ©
min
ğ‘›1/2ğ‘‘1/2
max,ğ‘›1/3ğ‘š1/3
for
the worst-case computational complexity was established by Bres-
san, Peserico, and Pretto [ 7,8], whereğ‘‘maxdenotes the maxi-
mum outdegree of ğº. This lower bound indicates the improba-
bility of achieving a complexity bound of ğ‘‚(âˆšğ‘›)even on very
sparse directed graphs. Surprisingly, on undirected graphs, a recent
1Itâ€™s important to note, as formally established in [ 18], that the PageRank scores
in undirected graphs are not simply proportional to node degrees, despite common
misconceptions to the contrary often cited in the literature.
3036
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Hanzhi Wang
work [ 31] shows that the computational complexity of local PageR-
ank approximation can be improved to ğ‘‚
logğ‘›Â·min
ğ‘‘ğ‘¡,ğ‘š1/2
by leveraging the symmetry of PageRank vectors in undirected
graphs2. Here,ğ‘‘ğ‘¡denotes the degree of the target node ğ‘¡in the
undirected graph ğº. We note that this upper bound is even asymp-
totically better than the lower bound established for directed graphs.
This encouraging result underscores the theoretical significance
and necessity of exploring the complexity bounds of local PageRank
estimation on undirected graphs. However, the question of whether
this upper bound can be further improved remains open due to
the lack of lower bounds for undirected graphs [ 31]. To the best
of our knowledge, only a trivial lower bound of Î©(1)has been
established over the years. This gap in understanding motivates
our exploration in this area.
Applications Significance. Local estimation of PageRank scores
on undirected graphs is a versatile tool with a range of appli-
cations. A typical example is its use in Graph Neural Networks
(GNNs). The majority of GNN models are primarily designed for
undirected graphs, aiming to derive low-dimensional latent rep-
resentations of all training nodes from structural and feature in-
formation. A message-passing mechanism is typically employed
in existing GNN models for feature propagation. In particular, a
line of research [ 4,10,21,30] utilizes PageRank queries for effi-
cient feature propagation, where the initial feature vector serves
as the preference vector for PageRank computations (as detailed
in Section 2). In these models, feature propagation is essentially
akin to computing PageRank scores for a selected group of nodes in
semi-supervised learning tasks, like community classification on a
billion-scale graph Friendster [ 10], where feature vector entries are
binary and the number of training nodes is small. Thus, an efficient
local PageRank algorithm can greatly enhance the scalability of
GNN models in these contexts. Moreover, the simulation of random
walks in undirected graphs is a prevalent approach widely adopted
in various graph learning tasks [ 10,29,30,33]. While prior studies
have demonstrated the empirical efficacy of this method, they fall
short of providing a theoretical foundation for the optimality of gen-
erating random walks in undirected settings. This paper establishes
that merely generating random walks from a specified target node
achieves the optimal complexity for local PageRank computation.
Our findings aim to lay a theoretical foundation for the efficacy of
random walk simulations in undirected graphs, thereby informing
the design of graph learning methods tailored to such graphs.
1.1 Our Contributions
In this paper, we address the problem of locally estimating the
PageRank score of a target node ğ‘¡in an undirected graph ğº. We
achieve the following contributions:
â€¢We introduce BackMC , an algorithm that achieves the worst-case
computational complexity of ğ‘‚
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
, where
ğ‘‘minrepresents the minimum degree of the graph ğº,ğ‘‘ğ‘¡denotes
the degree of the target node ğ‘¡, andğ‘šis the total number of edges
inğº. This computational complexity notably improves upon the
2For readability, we hide multiplicative factors depending on the parameters ğ‘,ğ‘ğ‘“and
ğ›¼in theğ‘‚()notation, following [ 7,8,31,32]. These factors in our upper bound can
be found in Section 4.Table 1: Table of notations.
Notation Description
ğº=(ğ‘‰,ğ¸)undirected graph with node set ğ‘‰and edge set ğ¸
A,D adjacency and degree matrices of ğº
ğ‘›,ğ‘š numbers of nodes and edges in ğº
N(ğ‘¡) set of neighbors of ğ‘¡
ğ‘‘ğ‘¡ degree of node ğ‘¡
ğ‘‘max maximum degree of ğº
ğ‘‘min minimum degree of ğº
ğ… PageRank vector
ğ…(ğ‘¡),Ë†ğ…(ğ‘¡)real and estimated PageRank scores of node ğ‘¡
ğ…(ğ‘ ,ğ‘¡) Personalized PageRank score of node ğ‘¡w.r.t nodeğ‘ 
ğ›¼ teleport probability in defining PageRank
ğ‘ relative error parameter
ğ‘ğ‘“ failure probability parameter
previous best upper bound of ğ‘‚
logğ‘›Â·min
ğ‘‘ğ‘¡,ğ‘š1/2
, as docu-
mented for the SetPush algorithm [ 31], by a factor of Î˜logğ‘›
ğ‘‘min
.
Remarkably, although the complexity result of SetPush is de-
rived from a significantly complex analysis, the algorithm struc-
ture and theoretical analysis of our BackMC exhibit a surprising
simplicity.
â€¢We improve the lower bound for this problem from a trivial
bound of Î©(1)toÎ©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
. The matching upper
and lower bounds demonstrate that our BackMC has been optimal.
â€¢Beyond its theoretical optimality, BackMC distinguishes itself with
a clean algorithm structure and straightforward implementation,
and thus achieves exceptional empirical performance. We con-
duct extensive experiments on large-scale real-world and syn-
thetic graphs, and BackMC consistently outperforms all baseline
algorithms. Notably, it surpasses SetPush in both efficiency and
accuracy by up to three orders of magnitude.
2 Preliminaries
We denote the underlying undirected graph as ğº=(ğ‘‰,ğ¸), with
AandDrepresenting the adjacency and degree matrices of ğº,
respectively. The graph consists of ğ‘›=|ğ‘‰|nodes andğ‘š=|ğ¸|edges.
For any undirected edge (ğ‘¢,ğ‘£)inğº, nodesğ‘¢andğ‘£are termed as
neighbors. For a node ğ‘¢inğº, the set of its neighbors is denoted
asN(ğ‘¢), and its degree is represented by ğ‘‘ğ‘¢=|N(ğ‘¢)|. We further
defineğ‘‘max=maxğ‘¢âˆˆğ‘‰ğ‘‘ğ‘¢andğ‘‘min=minğ‘¢âˆˆğ‘‰ğ‘‘ğ‘¢as the maximum
and minimum degrees of ğº, respectively. We list frequently used
notations in Table 1 for quick reference.
2.1 PageRank
The PageRank vector ğ…of graphğºis defined as the stationary
distribution of the PageRank Markov chain [9, 28], satisfying:
ğ…=(1âˆ’ğ›¼)ADâˆ’1Â·ğ…+ğ›¼
ğ‘›Â·1, (1)
3037Revisiting Local PageRank Estimation on Undirected Graphs: Simple and Optimal KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
whereğ›¼âˆˆ(0,1)is the teleport probability, and 1is an all-one col-
umn vector of length ğ‘›. The vector 1/ğ‘›is termed as the preference
or personalized vector in PageRank.
For any node ğ‘¢inğº, the PageRank score of ğ‘¢, denoted by ğ…(ğ‘¢),
corresponds to the entry in ğ…associated with node ğ‘¢. It is well
known that ğ…(ğ‘¢)equals the probability that an ğ›¼-discounted ran-
dom walk, starting from a random source node uniformly chosen
inğ‘‰, terminates at node ğ‘¢[9,28]. Here, anğ›¼-discounted random
walk is a type of random walk where the length of the walk is a
random variable that takes on value â„“with probability ğ›¼(1âˆ’ğ›¼)â„“for
eachâ„“â‰¥0. In other words, at each step of the ğ›¼-discounted random
walk, there is a probability of ğ›¼that the walk will terminate, and a
probability of(1âˆ’ğ›¼)that the walk will continue to the next step.
Equation (1)implies that the following recursive equality holds
for any node ğ‘¢âˆˆğ‘‰.
ğ…(ğ‘¢)=âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)(1âˆ’ğ›¼)ğ…(ğ‘£)
ğ‘‘ğ‘£+ğ›¼
ğ‘›. (2)
Moreover, Wang and Wei [ 31] demonstrate that for any node ğ‘¢âˆˆğ‘‰,
ğ…(ğ‘¢)â‰¥max 
ğ›¼
ğ‘›,ğ›¼ğ‘‘ğ‘¢âˆšï¸
2(1âˆ’ğ›¼)
ğ‘›âˆšğ‘š!
. (3)
We present the proof below for the sake of completeness.
Proof of Eqation (3).By Equation (2), we have ğ…(ğ‘¢)â‰¥ğ›¼/ğ‘›
for any node ğ‘¢âˆˆğ‘‰. Applying ğ…(ğ‘¢)â‰¥ğ›¼/ğ‘›into Equation (2)further
yields that
ğ…(ğ‘¢)â‰¥âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)(1âˆ’ğ›¼)
ğ‘‘ğ‘£Â·ğ›¼
ğ‘›+ğ›¼
ğ‘›=ğ›¼
ğ‘›Â·Â©Â­
Â«âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)(1âˆ’ğ›¼)
ğ‘‘ğ‘£+1ÂªÂ®
Â¬.(4)
In particular, by the Cauchy-Schwarz inequality, we have
Â©Â­
Â«âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)1
ğ‘‘ğ‘£ÂªÂ®
Â¬Â·Â©Â­
Â«âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)ğ‘‘ğ‘£ÂªÂ®
Â¬â‰¥Â©Â­
Â«âˆ‘ï¸
ğ‘£âˆˆN(ğ‘¢)1ÂªÂ®
Â¬2
=ğ‘‘2
ğ‘¢.
It is important to note thatÃ
ğ‘£âˆˆN(ğ‘¢)ğ‘‘ğ‘£â‰¤2ğ‘š, therefore giving thatÃ
ğ‘£âˆˆN(ğ‘¢)1/ğ‘‘ğ‘£â‰¥ğ‘‘2ğ‘¢/2ğ‘š. By Plugging into Inequality (4), we have
ğ…(ğ‘¢)â‰¥ğ›¼
ğ‘›Â·(1âˆ’ğ›¼)ğ‘‘2ğ‘¢
2ğ‘š+1
=ğ›¼ğ‘‘ğ‘¢
ğ‘›Â·(1âˆ’ğ›¼)ğ‘‘ğ‘¢+2ğ‘š/ğ‘‘ğ‘¢
2ğ‘š
.
By the AM-GM inequality, we further have
ğ…(ğ‘¢)â‰¥ğ›¼ğ‘‘ğ‘¢
ğ‘›Â·2âˆšï¸
2(1âˆ’ğ›¼)ğ‘š
2ğ‘š=ğ›¼ğ‘‘ğ‘¢
ğ‘›Â·âˆšï¸
2(1âˆ’ğ›¼)âˆšğ‘š.
Combining these results gives the claimed inequality. â–¡
2.2 Personalized PageRank
Personalized PageRank (PPR) serves as an ego-centric counterpart
to PageRank, quantifying the probability that an ğ›¼-discounted ran-
dom walk, starting from a source node ğ‘¢, terminates at a target
nodeğ‘£. This is expressed as the PPR score of ğ‘£with respect to
ğ‘¢, symbolized by ğ…(ğ‘¢,ğ‘£). It follows naturally that the PageRank
score ofğ‘£is the average of ğ…(ğ‘¢,ğ‘£)across all nodes ğ‘¢in the graph,
formalized as
ğ…(ğ‘£)=1
ğ‘›Â·âˆ‘ï¸
ğ‘¢âˆˆğ‘‰ğ…(ğ‘¢,ğ‘£). (5)Table 2: Summary of computational complexities for esti-
mating the PageRank score of the target node ğ’•in undirected
graph ğ‘®. Results only applicable to undirected graphs are
marked with â˜….
Method Complexity Bound Notes
PowerIteration [28]ğ‘‚(ğ‘šlogğ‘›)
BackwardPush [24]ğ‘‚(logğ‘›Â·min(ğ‘›ğ‘‘ğ‘¡,ğ‘š)) â˜…
MC[13] ğ‘‚(ğ‘›)
RBS[32] ğ‘‚(ğ‘›logğ‘›)
Undir-BiPPR [22]ğ‘‚
ğ‘›1/2ğ‘‘1/2
ğ‘¡
â˜…
BPPPush [7] ğ‘‚
logğ‘›Â·min
ğ‘›3/4ğ‘‘1/4
max,ğ‘›5/7ğ‘š1/7
BPPPushâˆ—[8] ğ‘‚
logğ‘›Â·min
ğ‘›2/3ğ‘‘1/3
max,ğ‘›2/3ğ‘š1/6
SetPush [31] ğ‘‚
logğ‘›Â·min
ğ‘‘ğ‘¡,ğ‘š1/2
â˜…
BackMC (Ours) ğ‘‚
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
â˜…
Lower Bound (Ours) Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
â˜…
Specifically, on undirected graphs, PPR scores exhibit symmetry
for any pair of nodes (ğ‘¢,ğ‘£)âˆˆğ‘‰2:
ğ…(ğ‘¢,ğ‘£)Â·ğ‘‘ğ‘¢=ğ…(ğ‘£,ğ‘¢)Â·ğ‘‘ğ‘£. (6)
The proof of Equation (6) is detailed in [22].
2.3 Computational Model
In this paper, we adopt the standard RAM model for computational
complexity. To establish lower bounds, we consider query complex-
ity under the standard arc-centric graph access model [15,16], where
local algorithms can access the underlying graph only through a
graph oracle via several local queries and a global jump()operation.
This setting aligns well with practical situations with massive-scale
network structures. Specifically, for undirected graphs, the graph
oracle supports three elementary query operations, each taking
unit time: deg(ğ‘¢), which returns ğ‘‘ğ‘¢;neigh(ğ‘¢,ğ‘–), which returns the
ğ‘–-th node inN(ğ‘¢);jump(), which returns a random node uniformly
chosen from ğ‘‰. Algorithm 2 is an example on how to leverage
these query operations to sample random walks in the graph. The
query complexity of a graph algorithm is defined as the number
of elementary query operations invoked on the graph oracle. It is
worth noting that the query complexity of an algorithm serves as a
lower bound for its computational complexity.
3 Related Work
The problem of estimating PageRank scores locally was introduced
in [11], and, in its various forms, has received considerable attention
over the past decade [ 1,3,7,8,11,13,22â€“25,31,32]. These methods
can be broadly categorized into three groups based on their underly-
ing techniques. A summary of their complexity bounds is provided
in Table 2. In this section, we will briefly review these methods.
Section 4 will delve into the limitations of existing methods and
offer a detailed comparison with our BackMC algorithm.
The first category [ 2,5,6,13] is inspired by the probabilistic
interpretation of PageRank scores. The seminal work by Fogaras
3038KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Hanzhi Wang
et al. [ 13] introduced a Monte Carlo (MC) method that initiates a
series ofğ›¼-discounted random walks across the graph ğº, where each
random walk is generated from a uniformly random source node in
ğº. The MC method calculates the proportion of walks that terminate
at the given target node ğ‘¡, utilizing this ratio to approximate ğ…(ğ‘¡).
To achieve a multiplicative (1Â±ğ‘)-approximation of ğ…(ğ‘¡)with
probability 1âˆ’ğ‘ğ‘“, the expected computational complexity of the
MC method is upper bounded by ğ‘‚(ğ‘›). This result is applicable to
both directed and undirected graphs.
Another line of research [ 1,24,31,32] focuses on the estimation
ofğ…(ğ‘ ,ğ‘¡)for allğ‘ âˆˆğ‘‰, using Equation (5)to derive an estimate for
ğ…(ğ‘¡). These algorithms start with one unit of probability mass at
nodeğ‘¡and perform a sequence of push operations to distribute the
probability mass across the graph ğº. The push operation, applied to
nodeğ‘¢, redistributes the probability mass from node ğ‘¢to its neigh-
bors, following the recurrence equation in Equation (2). The seminal
paper [ 1] in this category introduces the ApproxContributions
algorithm, which achieves a worst-case computational complexity
ofğ‘‚(ğ‘›ğ‘‘ğ‘¡)for determinsitically computing a multiplicative (1Â±ğ‘)-
approximation of ğ…(ğ‘¡). It is worth noting that this result is only ap-
plicable to undirected graphs. On directed graphs, the running time
ofApproxContributions can only be bounded by ğ‘‚(ğ‘š)in expec-
tation over a uniform random choice of ğ‘¡âˆˆğ‘‰. Subsequent studies,
such as the BackwardPush algorithm by Lofgren and Goel [ 24],
improved the framework of ApproxContributions to achieve a
worst-case computational complexity of ğ‘‚(logğ‘›Â·min(ğ‘›ğ‘‘ğ‘¡,ğ‘š))on
undirected graphs and an average running time of ğ‘‚(ğ‘šlogğ‘›)over
allğ‘¡âˆˆğ‘‰on directed graphs. A recent advancement, RBS[32],
further improves the worst-case computational complexity of this
problem toğ‘‚(ğ‘›logğ‘›). This result applies to both directed and undi-
rected graphs. The key idea of RBSis to pre-sort the neighbors of
each node in ascending order of their degrees and, in each push op-
eration, propagate probability mass only to neighbors with small de-
grees. The SetPush algorithm [ 31] achieves the best-known worst-
case complexity of ğ‘‚
logğ‘›Â·min
ğ‘‘ğ‘¡,ğ‘š1/2
for estimating ğ…(ğ‘¡)on
undirected graphs. The algorithm critically depends on the symme-
try of PPR scores in undirected graphs. It employs a complex push
strategy to estimate ğ…(ğ‘¡,ğ‘ )for allğ‘ âˆˆğ‘‰, and then derives the ap-
proximation of ğ…(ğ‘¡)using the equation ğ…(ğ‘¡)=1
ğ‘›Â·Ã
ğ‘ âˆˆğ‘‰ğ‘‘ğ‘¡
ğ‘‘ğ‘ Â·ğ…(ğ‘¡,ğ‘ ),
as inferred from Equation (5) and (6).
Additionally, a set of papers presents novel results by combining
the Monte Carlo method and push operations. This idea was in-
troduced in the FastPPR algorithm [ 25], and further refined in the
BiPPR algorithm [ 23], both designed for directed graphs. An alterna-
tive version of BiPPR , referred to as Undir-BiPPR , has been tailored
for undirected graphs. Undir-BiPPR achieves a worst-case com-
putational complexity of ğ‘‚
ğ‘›1/2ğ‘‘1/2
ğ‘¡
for estimating ğ…(ğ‘¡). In the
recent work by Bressan, Peserico, and Pretto [ 7], a worst-case com-
putational complexity of ğ‘‚
logğ‘›Â·min
ğ‘›3/4ğ‘‘1/4
max,ğ‘›5/7ğ‘š1/7
was
achieved for general directed graphs. Subsequently, this bound was
further improved to ğ‘‚
logğ‘›Â·min
ğ‘›2/3ğ‘‘1/3
max,ğ‘›2/3ğ‘š1/6
in [8], es-
tablishing itself as the best-known worst-case complexity bound
for local PageRank approximation in directed graphs.
As for lower bounds, Bar-Yossef and Mashiach [ 3] have proven
that, in directed graphs, the lack of jump()operation imposes aAlgorithm 1: BackMC(ğº,ğ‘¡,ğ›¼,ğ‘›ğ‘Ÿ)
Input: undirected graph ğº=(ğ‘‰,ğ¸), target node ğ‘¡âˆˆğ‘‰,
damping factor ğ›¼, the number of random walks ğ‘›ğ‘Ÿ
Output: Ë†ğ…(ğ‘¡)as an estimate of ğ…(ğ‘¡)
1Ë†ğ…(ğ‘¡)â† 0
2forğ‘¤from 1toğ‘›ğ‘Ÿdo
3ğ‘£â†SampleNode(ğº,ğ‘¡,ğ›¼)
4 Ë†ğ…(ğ‘¡)â† Ë†ğ…(ğ‘¡)+1
ğ‘›ğ‘ŸÂ·ğ‘‘ğ‘¡
ğ‘›ğ‘‘ğ‘£//ğ‘(ğ‘¡)=ğ‘‘ğ‘¡
ğ‘›ğ‘‘ğ‘£
5return Ë†ğ…(ğ‘¡);
Algorithm 2: SampleNode(ğº,ğ‘¢,ğ›¼)
Input: undirected graph ğº=(ğ‘‰,ğ¸), source node ğ‘¢âˆˆğ‘‰,
damping factor ğ›¼
Output: a sampled node ğ‘£
1ğ‘£â†ğ‘¢
2while truedo
3 with probability ğ›¼returnğ‘£
4ğ‘£â†neigh(ğ‘£,randint(deg(ğ‘£)))//randint(deg(ğ‘£))
returns a uniformly random integer in [1,deg(ğ‘£)]
lower bound of Î©(ğ‘›)on the query complexity for locally approx-
imating ğ…(ğ‘¡). Moreover, Bressan, Peserico, and Pretto [ 7] have
shown that a lower bound of Î©
min
ğ‘›1/2ğ‘‘1/2
max,ğ‘›1/3ğ‘š1/3
elemen-
tary query operations is necessary in the worst case to estimate
ğ…(ğ‘¡)within a multiplicative ğ‘‚(1)factor with probability Î©(1)in
directed graphs. However, the lower bounds pertaining to the esti-
mation of ğ…(ğ‘¡)on undirected graphs remain unclear.
4 Algorithm
This section presents our BackMC algorithm. We demonstrate that
BackMC can achieve the following upper bound simply by generat-
ing a series of ğ›¼-discounted random walks from node ğ‘¡.
Theorem 1. Given an undirected graph ğºand a target node ğ‘¡âˆˆğ‘‰,
the expected computational complexity of BackMC for computing a
multiplicative(1Â±ğ‘)-approximation of ğ…(ğ‘¡)with probability at least
1âˆ’ğ‘ğ‘“isğ‘‚
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
.
Algorithm 1 provides the pseudocode for BackMC . At the heart
of Algorithm 1 is the SampleNode(ğº,ğ‘¡,ğ›¼)function, responsible
for simulating an ğ›¼-discounted random walk from node ğ‘¡inğº.
We define the indicator variable ğœ’ğ‘£, which takes on value 1if
SampleNode(ğº,ğ‘¡,ğ›¼)=ğ‘£. We also compute a temporary estima-
torğ‘(ğ‘¡)asğ‘(ğ‘¡)=Ã
ğ‘£âˆˆğ‘‰ğ‘‘ğ‘¡
ğ‘›Â·ğ‘‘ğ‘£Â·ğœ’ğ‘£. We invoke SampleNode(ğº,ğ‘¡,ğ›¼)
forğ‘›ğ‘Ÿtimes to obtain ğ‘›ğ‘Ÿindependent realizations of ğ‘(ğ‘¡), and take
their average as the final estimate Ë†ğ…(ğ‘¡)forğ…(ğ‘¡).
4.1 Analysis
This section presents the proof of Theorem 1. It is straightforward
thatğœ’ğ‘£is a Bernoulli random variable that takes on value 1with
probability ğ…(ğ‘¡,ğ‘£). Therefore, ğ‘(ğ‘¡)is an unbiased estimator for
ğ…(ğ‘¡)since ğ…(ğ‘¡)=(1/ğ‘›)Â·Ã
ğ‘£âˆˆğ‘‰ğ…(ğ‘¡,ğ‘£)Â·(ğ‘‘ğ‘¡/ğ‘‘ğ‘£), as inferred from
3039Revisiting Local PageRank Estimation on Undirected Graphs: Simple and Optimal KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Equation (5)and(6). It is important to note that BackMC computes
Ë†ğ…(ğ‘¡)by averaging ğ‘›ğ‘Ÿindependent realizations of ğ‘(ğ‘¡). Thus, Ë†ğ…(ğ‘¡)
also emerges as an unbiased estimator for ğ…(ğ‘¡).
We now proceed to bound the variance of the estimator Ë†ğ…(ğ‘¡)
generated by BackMC . It is well-known that the variance of the
Bernoulli random variable ğœ’ğ‘£is given by Var[ğœ’ğ‘£]=ğ…(ğ‘¡,ğ‘£)(1âˆ’
ğ…(ğ‘¡,ğ‘£))â‰¤ğ…(ğ‘¡,ğ‘£). It is worth noting that for all ğ‘£âˆˆğ‘‰, the random
variablesğœ’ğ‘£are negatively correlated since an ğ›¼-discounted random
walk can only terminate at a single node. Consequently, we have
Var[ğ‘(ğ‘¡)]â‰¤âˆ‘ï¸
ğ‘£âˆˆğ‘‰Varğ‘‘ğ‘¡
ğ‘›ğ‘‘ğ‘£Â·ğœ’ğ‘£
â‰¤âˆ‘ï¸
ğ‘£âˆˆğ‘‰ğ‘‘2
ğ‘¡
ğ‘›2ğ‘‘2ğ‘£Â·ğ…(ğ‘¡,ğ‘£).
By utilizing Equation (6), we can further derive that
Var[ğ‘(ğ‘¡)]â‰¤âˆ‘ï¸
ğ‘£âˆˆğ‘‰ğ‘‘ğ‘¡
ğ‘›2ğ‘‘ğ‘£Â·ğ…(ğ‘£,ğ‘¡)â‰¤ğ‘‘ğ‘¡
ğ‘›2ğ‘‘minÂ·âˆ‘ï¸
ğ‘£âˆˆğ‘‰ğ…(ğ‘£,ğ‘¡)=ğ‘‘ğ‘¡Â·ğ…(ğ‘¡)
ğ‘›Â·ğ‘‘min,
where we employ Equation (5)to assert that1
ğ‘›Â·Ã
ğ‘£âˆˆğ‘‰ğ…(ğ‘£,ğ‘¡)=ğ…(ğ‘¡).
Recall that BackMC computes Ë†ğ…(ğ‘¡)as the average of ğ‘›ğ‘Ÿindependent
realizations of ğ‘(ğ‘¡). As a result, we can bound the variance of the
estimator Ë†ğ…(ğ‘¡)inBackMC asVar[Ë†ğ…(ğ‘¡)]â‰¤ğ‘‘ğ‘¡Â·ğ…(ğ‘¡)
ğ‘›Â·ğ‘›ğ‘ŸÂ·ğ‘‘min.
Therefore, with ğ‘›ğ‘Ÿ=3ğ‘‘ğ‘¡
ğ‘2ğ‘›ğ…(ğ‘¡)ğ‘‘min, Chebyshevâ€™s inequality guar-
antees that
Pr{|Ë†ğ…(ğ‘¡)âˆ’ğ…(ğ‘¡)|â‰¥ğ‘ğ…(ğ‘¡)}â‰¤Var[Ë†ğ…(ğ‘¡)]
ğ‘2(ğ…(ğ‘¡))2â‰¤ğ‘‘ğ‘¡
ğ‘2ğ‘›ğ…(ğ‘¡)Â·ğ‘›ğ‘Ÿğ‘‘min=1
3.
Given that ğ…(ğ‘¡)â‰¥max
ğ›¼
ğ‘›,ğ›¼ğ‘‘ğ‘¡âˆš
2(1âˆ’ğ›¼)
ğ‘›âˆšğ‘š
(from Inequality (3)), we
can ensure that Pr{|Ë†ğ…(ğ‘¡)âˆ’ğ…(ğ‘¡)|â‰¥ğ‘ğ…(ğ‘¡)}â‰¤1/3by settingğ‘›ğ‘Ÿ=
3
ğ‘2ğ›¼ğ‘‘minÂ·min
ğ‘‘ğ‘¡,âˆšğ‘šâˆš
2(1âˆ’ğ›¼)
.
To further reduce the failure probability to ğ‘ğ‘“, we use the Median
trick. The core idea is to independently run BackMC multiple times
and take the median of the resulting Ë†ğ…(ğ‘¡)as the final estimate for
ğ…(ğ‘¡). Specifically, we use ğ‘›ğ‘što denote the number of BackMC runs.
For each integer ğ‘—âˆˆ[1,ğ‘›ğ‘š], we define the indicator variable ğ›¾ğ‘—,
which equals 1if theğ‘—-th run fails to achieve |Ë†ğ…(ğ‘¡)âˆ’ğ…(ğ‘¡)|<ğ‘Â·ğ…(ğ‘¡).
Based on the earlier proof, we have E
ğ›¾ğ‘—
=Pr
ğ›¾ğ‘—=1	
â‰¤1/3
whenğ‘›ğ‘Ÿ=3
ğ‘2ğ›¼ğ‘‘minÂ·min
ğ‘‘ğ‘¡,âˆšğ‘šâˆš
2(1âˆ’ğ›¼)
. Furthermore, we define ğ›¾=
Ãğ‘›ğ‘š
ğ‘—=1ğ›¾ğ‘—as the count of times BackMC fails to produce a satisfactory
approximation of ğ…(ğ‘¡). The probability that the median of these
estimates is not a multiplicative (1Â±ğ‘)-approximation of ğ…can thus
be quantified as Pr{ğ›¾â‰¥ğ‘›ğ‘š/2}. Given that E[ğ›¾]=Ãğ‘›ğ‘š
ğ‘—=1E
ğ›¾ğ‘—
â‰¤
ğ‘›ğ‘š/3, by Hoeffdingâ€™s inequality, ğ‘›ğ‘š=
18Â·ln(1/ğ‘ğ‘“)
yields:
Prn
ğ›¾â‰¥ğ‘›ğ‘š
2o
=Prn
ğ›¾âˆ’E[ğ›¾]â‰¥ğ‘›ğ‘š
6o
â‰¤expâˆ’ğ‘›ğ‘š
18
â‰¤ğ‘ğ‘“.
As a consequence, the total number of ğ›¼-discounted random
walks generated in ğºturns out to be
ğ‘›ğ‘ŸÂ·
18Â·ln(1/ğ‘ğ‘“)
=54Â·
log(1/ğ‘ğ‘“)
ğ‘2ğ›¼ğ‘‘minÂ·min 
ğ‘‘ğ‘¡,âˆšğ‘šâˆšï¸
2(1âˆ’ğ›¼)!
.
We observe that the expected length of each ğ›¼-discounted random
walk is 1/ğ›¼=ğ‘‚(1). Consequently, the expected running time ofthe entire process can be upper bounded by
ğ‘›ğ‘Ÿ
ğ›¼=54Â·
log(1/ğ‘ğ‘“)
ğ‘2ğ›¼2ğ‘‘minÂ·min 
ğ‘‘ğ‘¡,âˆšğ‘šâˆšï¸
2(1âˆ’ğ›¼)!
=ğ‘‚1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,âˆšğ‘š
.
This completes the proof of Theorem 1.
Remark. We note that the setting of ğ‘›ğ‘Ÿrequires explicit knowledge
ofğ‘šandğ‘‘min. As demonstrated in [ 7,8,12], this requirement can be
easily waived. To achieve this, we run BackMC with an initial value
forğ‘›ğ‘Ÿ(e.g.,ğ‘›ğ‘Ÿ=2). If we find that ğ‘›ğ‘ŸÂ·Ë†ğ…(ğ‘¡)=Î©(ğ‘âˆ’1ln(1/ğ‘ğ‘“))
during the process, standard concentration bounds allow us to
safely terminate BackMC and return Ë†ğ…(ğ‘¡)as a multiplicative(1Â±ğ‘)-
approximation of ğ…(ğ‘¡). In case this condition is not met, we double
the value of ğ‘›ğ‘Ÿand repeat the process. This modification does not
affect the validity of Theorem 1.
4.2 Comparison with Previous Methods
This subsection presents a thorough comparison between BackMC
and previous methods.
First, considering SetPush , it achieves the best-known worst-
case complexity of ğ‘‚ logğ‘›Â·min ğ‘‘ğ‘¡,âˆšğ‘šfor this problem, with
a hidden multiplicative factor of 1/ğ›¼3. In contrast, BackMC has a
worst-case computational complexity of ğ‘‚
1
ğ‘‘minÂ·min ğ‘‘ğ‘¡,âˆšğ‘š
,
with a more favorable multiplicative dependency on ğ›¼of1/ğ›¼2. This
complexity surpasses that of SetPush by a factor of Î˜(logğ‘›/ğ‘‘min).
Additionally, the improvement in the ğ›¼factor can be significant in
practice when ğ›¼is small (e.g., ğ›¼=0.01). Furthermore, in Section 5,
we will demonstrate that the complexity bound of our BackMC
is optimal, matching the lower bound of Î©
1
ğ‘‘minÂ·min ğ‘‘ğ‘¡,âˆšğ‘š
for this problem. It is also worth noting that BackMC offers a much
simpler algorithm and analysis compared to SetPush [31].SetPush
devises a complex push strategy to estimate ğ…(ğ‘¡,ğ‘ )for allğ‘ âˆˆğ‘‰,
and then compute the approximation of ğ…(ğ‘¡)using the equation
ğ…(ğ‘¡)=1
ğ‘›Â·Ã
ğ‘ âˆˆğ‘‰ğ‘‘ğ‘¡
ğ‘‘ğ‘ Â·ğ…(ğ‘¡,ğ‘ ), as inferred from Equation (5)and(6).
However, our analysis shows that this is unnecessary. To estimate
ğ…(ğ‘¡,ğ‘ ), generating ğ›¼-discounted random walks from node ğ‘¡suffices
to achieve optimal complexity.
For other previous methods, we now analyze the reasons why
these methods cannot achieve the optimal complexity results. First
of all, the MC method [ 2,5,6,13] estimates ğ…(ğ‘¡)directly, result-
ing in a computational complexity lower bound of Î©(ğ‘›)in anğ‘›-
node graph. Specifically, in an ğ‘›-node graph ğº, all butğ‘œ(ğ‘›)nodes
have PageRank scores ğ‘‚(1/ğ‘›). Therefore, the MC method needs
to generate Î©(ğ‘›)ğ›¼-discounted random walks, each initiated from
a uniformly random source node, in order to hit a target node ğ‘¡
with ğ…(ğ‘¡)=ğ‘‚(1/ğ‘›)at least once. For the push-based methods
likeApproxContributions [1] and BackwardPush [24], they can
perform Î©(ğ‘›)elementary query operations during a push opera-
tion at a node ğ‘¢withğ‘‘ğ‘¢=ğ‘‚(ğ‘›). The Undir-BiPPR method [ 22]
combines the MC method and push operations, thus inheriting
their drawbacks. The RBS,BPPPush , and BPPPushâˆ—methods are
three exceptions, each of which devises the original push operation.
However, RBS[32],BPPPush [7], and BPPPushâˆ—[8] are tailored for
general directed graphs and do not leverage the symmetry of PPR
3040KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Hanzhi Wang
s1s1t
s2s2u1u1
u2u2
/u1D4B0 /u1D4B0t
/u1D4AE /u1D4AEu1u1u2u2
/u1D4B0 /u1D4B0
â€¦ â€¦â€¦ â€¦â€¦ â€¦
Figure 1: Hard instances of the lower bound proof.
scores in undirected graphs. This limitation prevents them from
achieving optimality in undirected graphs due to the differences in
local PageRank estimation between undirected and directed graphs.
5 Lower Bounds
This section establishes the computational complexity lower bound
for the local approximation of ğ…(ğ‘¡). Specifically, we have Theorem 2
as shown below.
Theorem 2. Choose any integer ğ‘â‰¥2and any functions ğ‘š(ğ‘›)âˆˆ
Î©(ğ‘›),ğ‘‘min(ğ‘›)âˆˆÎ©(1)âˆ©ğ‘‚(ğ‘›). Consider any (randomized) algorithm
H(ğ‘¡)that estimates ğ…(ğ‘¡)within a multiplicative factor ğ‘‚(1)with
probability at least 1/ğ‘, whereHcan only access the unseen nodes
and edges in the underlying graph via a graph oracle. Then, for every
sufficiently large ğ‘›, there exists an undirected graph ğºsuch that:
(1)The graphğºcontains Î˜(ğ‘›)nodes and Î˜(ğ‘š)edges, and its mini-
mum degree is Î˜(ğ‘‘min);
(2)The graphğºcontains a node ğ‘¡with degree ğ‘‘ğ‘¡, such thatH(ğ‘¡)
requires Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
elementary query operations
in expectation in the arc-centric graph-access model.
Let us outline the proof first for ease of understanding. We estab-
lish Theorem 2 by constructing (ğ‘+1)graphs as hard instances for
estimating ğ…(ğ‘¡). These graphs are carefully designed so that any al-
gorithm requires Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
elementary query oper-
ations in the arc-centric graph access model to distinguish between
them. However, distinguishing these graphs is essential for any algo-
rithm to produce an approximation of ğ…(ğ‘¡)within a multiplicative
factorğ‘‚(1)with a probability of at least 1/ğ‘. Hence, we establish
a query complexity lower bound of Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
for
estimating ğ…(ğ‘¡). As detailed in Section 2.3, the query complexity
of an algorithm is a lower bound for its computational complexity,
thus establishing Theorem 2.
We present the formal proof of Theorem 2 in the following.
Proof. We construct(ğ‘+1)graphsğº(0),ğº(1),...,ğº(ğ‘)as hard
instances for estimating ğ…(ğ‘¡). In graphğº(ğ‘–), the target node ğ‘¡has
Î˜(ğ‘‘ğ‘¡)neighbors, which can be divided into (ğ‘–+1)groups. Each of
the firstğ‘–groups, denoted by S(ğ‘—)forğ‘—âˆˆ[0,ğ‘–), hasÎ˜(ğ‘‘min)neigh-
bor nodes, while the last group, denoted by U, contains Î˜(ğ‘š1/2)
neighbors. In the first ğ‘–groups, each neighbor node has a degree of
Î˜(ğ‘‘min), whereas in the(ğ‘–+1)-th group, each neighbor node has
a degree of Î˜(ğ‘š1/2). Additionally, we add isolated nodes to these
graphs, ensuring that the number of nodes in each graph is Î˜(ğ‘›).
Figure 1 illustrates graphs ğº(1)andğº(0).
We denote the PageRank score of ğ‘¡in graphğº(ğ‘–)asğ…ğ‘–(ğ‘¡). We
will demonstrate that for each ğ‘–âˆˆ[1,ğ‘],ğ…ğ‘–(ğ‘¡)=(1+Î©(1))Â·ğ…ğ‘–âˆ’1(ğ‘¡).Specifically, in graph ğº(ğ‘–), each node ğ‘ belonging to group S(ğ‘—)
forğ‘—âˆˆ[0,ğ‘–)has a Personalized PageRank (PPR) score ğ…(ğ‘ ,ğ‘¡)=
Î˜(1/ğ‘‘min). Furthermore, each node ğ‘¢âˆˆ U in graphğº(ğ‘–)has
a PPR score ğ…(ğ‘¢,ğ‘¡)=Î˜(1/ğ‘š1/2). Additionally, the PPR score
of nodeğ‘¡to itself is ğ…(ğ‘¡,ğ‘¡)=Î˜(1/ğ‘›). Thus, according to Equa-
tion (5), the PageRank score of node ğ‘¡in graphğº(ğ‘–)isğ…ğ‘–(ğ‘¡)=
Î˜
1
ğ‘›
1+ğ‘–Â·ğ‘‘minÂ·1
ğ‘‘min+ğ‘š1/2Â·1
ğ‘š1/2
=Î˜
1
ğ‘›
. The difference
ğ…ğ‘–(ğ‘¡)âˆ’ğ…ğ‘–âˆ’1(ğ‘¡)=Î˜
1
ğ‘›Â·ğ‘‘minÂ·1
ğ‘‘min
=Î˜
1
ğ‘›
, which corroborates
the assertion that ğ…ğ‘–(ğ‘¡)=(1+Î©(1))Â·ğ…ğ‘–âˆ’1(ğ‘¡)for eachğ‘–âˆˆ[1,ğ‘].
Furthermore, letG(ğ‘–)represent the set of all ğ‘›!graphs that are
isomorphic to ğº(ğ‘–)obtained through permutation of node labels.
Consider an undirected graph ğº, chosen uniformly at random fromÃğ‘
ğ‘–=1G(ğ‘–). Any algorithmH(ğ‘¡)is required to identify the specific
setG(ğ‘–)from which ğºoriginates. Failing this, the probability that
H(ğ‘¡)can estimate ğ…(ğ‘¡)within a multiplicative factor of ğ‘‚(1)di-
minishes to at most 1/(ğ‘+1), a result deemed unacceptable.
Finally, in the arc-centric graph access model, we contend that
any algorithmH(ğ‘¡)must execute Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
queries
in expectation to distinguish between graphs ğº(ğ‘–âˆ’1)andğº(ğ‘–)for
anyğ‘–âˆˆ[1,ğ‘]. By our design,H(ğ‘¡)must detect at least one node
in groupS(ğ‘–âˆ’1)to discern the difference between graphs ğº(ğ‘–âˆ’1)
andğº(ğ‘–), given that other sections of the two graphs remain in-
distinguishable. It is important to note that H(ğ‘¡)can explore un-
seen nodes in the underlying graph only through interactions with
the graph oracle, utilizing the three elementary query operations:
deg(Â·),neigh(Â·,Â·), and jump(). When employing the jump()query,
H(ğ‘¡)is expected to perform Î©(ğ‘›/ğ‘‘min)jump queries to detect a
node in groupS(ğ‘–âˆ’1)with probability at least 1/ğ‘. However, this
complexity, Î©(ğ‘›/ğ‘‘min), exceeds the stated lower bound asymptoti-
cally. Consequently, the viable strategy for H(ğ‘¡)is only local ac-
cess through neigh(ğ‘¡,Â·)anddeg(Â·)queries. This approach requires
H(ğ‘¡)to perform Î©
ğ‘š1/2
ğ‘‘min
queries on average to detect at least one
node inS(ğ‘–âˆ’1). Notably, Î˜
ğ‘š1/2
ğ‘‘min
=Î˜ğ‘‘ğ‘¡
ğ‘‘min
, given that ğ‘‘ğ‘¡=
Î˜(ğ‘‘min+ğ‘š1/2)=Î˜(ğ‘š1/2)holds in these hard instances. This sub-
stantiates the proposed lower bound of Î©
1
ğ‘‘minÂ·min
ğ‘‘ğ‘¡,ğ‘š1/2
,
thereby concluding the proof. â–¡
6 Experiments
In this section, we experimentally evaluate our BackMC algorithm
against other baseline methods on large-scale real-world and syn-
thetic graphs.
Environment. We conduct all the experiments on a Linux server
with an Intel (R) Xeon(R) Gold 6126@2.60GHz CPU and 500GB
memory. All the methods are implemented in C++ and compiled in
g++ with the O3 optimization turned on.
Methods and Parameters. We compare our BackMC against six
baseline methods, including MC[13],BackwardPush [24],RBS[32],
SetPush [31],Undir-BiPPR3[22], and BPPPushâˆ—[8]. Additionally,
3Itâ€™s worth noting that Undir-BiPPR [22] is initially implemented as a combination of
forward push and MC, which however is impractical under the graph access model
due to theğ‘‚(ğ‘›)time required to identify all nodes for pushing in the initial state.
Instead, we implement Undir-BiPPR by combining backward push and MC, ensuring
anğ‘‚(ğ‘›1/2ğ‘‘1/2
ğ‘¡)complexity under the graph access model.
3041Revisiting Local PageRank Estimation on Undirected Graphs: Simple and Optimal KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
10-710-610-510-410-310-210-1100101102103104
query time(s)10-310-210-1Relative ErrorYT
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-410-310-210-1100101102103104
query time(s)10-410-310-210-1Relative ErrorLJ
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-410-310-210-1100101102103104105106
query time(s)10-410-310-210-1Relative ErrorTW
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-210-1100101102103104105
query time(s)10-410-310-210-1100Relative ErrorFR
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
Figur
e 2: actual Relative Error v.s. query time (seconds), the target node ğ’•sampled uniformly, ğ›¼=0.2
10-510-410-310-210-1100101102103104
query time(s)10-310-210-1Relative ErrorYT
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-510-410-310-210-1100101102103104
query time(s)10-310-210-1Relative ErrorLJ
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-310-210-1100101102103104105106
query time(s)10-310-210-1Relative ErrorTW
BackMC
SetPush
RBS
Undir-BiPPR
BPPPush*
MC
10-210-1100101102103104105
query time(s)10-310-210-1Relative ErrorFR
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
Figur
e 3: actual Relative Error v.s. query time (seconds), the target node ğ’•sampled from the degree distribution, ğ›¼=0.2
10-510-410-310-210-1100101102103104105
query time(s)10-310-210-1100Relative ErrorYT
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-210-1100101102103104105
query time(s)10-410-310-210-1100Relative ErrorLJ
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
100101102103104105
query time(s)10-310-210-1100Relative ErrorTW
BackMC
SetPush
Undir-BiPPR
BPPPush*
MC
100101102103104105
query time(s)10-410-310-210-1100Relative ErrorFR
BackMC
SetPush
BackwardPush
Undir-BiPPR
BPPPush*
Figur
e 4: actual Relative Error v.s. query time (seconds), the target node ğ’•sampled uniformly, ğ›¼=0.01
Table 3: Datasets
Dataset
Graph Type ğ’ ğ’ ğ’… min
Y
outube(YT) Real-World 1,138,499 5,980,886 1
LiveJournal (LJ) Real-World 4,847,571 85,702,474 1
Twitter (TW) Real-World 41,652,230 2,405,026,092 1
Friendster (FR) Real-World 68,349,466 3,623,698,684 1
ER10
Synthetic 100,000 1,001,008 1
ER100 Synthetic 100,000 9,993,692 59
ER1000 Synthetic 100,000 100,001,498 875
ER10000 Synthetic 100,000 1,000,052,806 9582
we compute the ground truths by iteratively updating the PageR-
ank vector ğ…using Equation (1). Initially, we set ğ…=1/ğ‘›and
repeat the iteration âŒˆlog1âˆ’ğ›¼0.0001Â·ğ›¼
ğ‘›âŒ‰times. Then for any given
target node ğ‘¡, we utilize the derived ğ…(ğ‘¡)as the ground truth of
the PageRank score of ğ‘¡. Throughout our experiments, we set the
failure probability ğ‘ğ‘“to0.1and vary the relative error ğ‘within the
range(0.01,0.5]to analyze the tradeoff between query time and
actual Relative Error (as defined below) for each method. Moreover,
unless otherwise specified, we set the teleport probability ğ›¼to0.2.Metrics. We consider actual Relative Error, which is defined as
Relative Error =1
ğ…(ğ‘¡)Â·|ğ…(ğ‘¡)
âˆ’Ë†ğ…(ğ‘¡)|.
On each dataset, we sample 10nodes as the target node ğ‘¡, and
execute each method once for each target node. Subsequently, we
compute the average actual Relative Error of each method for esti-
mating ğ…(ğ‘¡)across all query nodes under each setting of ğ‘.
6.1 Experiments on Real-World Graphs
We first evaluate our BackMC against other baseline methods on
large-scale real-world graphs.
Datasets. We utilize four real-world datasets in our experiments:
YouTube (YT), LiveJournal (LJ), Twitter (TW), and Friendster (FR).
These datasets originate from social networks and are publicly
available4 5. In these graphs, nodes represent users on the respec-
tive websites, and edges denote friendships between users. Table 3
presents the statistics of the four datasets.
4http://law
.di.unimi.it/datasets.php
5http://snap.stanford.edu/data
3042KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Hanzhi Wang
10-410-310-210-1100101102103
query time(s)10-310-210-1Relative ErrorER10   
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-510-410-310-210-1100101102103104
query time(s)10-310-210-1Relative ErrorER100  
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-510-410-310-210-1100101102103
query time(s)10-310-210-1Relative ErrorER1000 
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
10-510-410-310-210-1100101102103
query time(s)10-410-310-210-1100Relative ErrorER10000
BackMC
SetPush
BackwardPush
RBS
Undir-BiPPR
BPPPush*
MC
Figur
e 5: actual Relative Error v.s. query time (seconds) on synthetic graphs, the target node ğ’•sampled uniformly, ğ›¼=0.2
Target Nodes. For each dataset, we sample two subsets from the
node setğ‘‰ofğº, each containing 10nodes designated as target
nodes. In the first subset, nodes are randomly selected from ğ‘‰with
a uniform distribution. In contrast, nodes in the second subset are
chosen from ğ‘‰based on the degree distribution. Specifically, for
any nodeğ‘¢âˆˆğ‘‰, the likelihood of ğ‘¢being sampled in the second
subset increases with its degree ğ‘‘ğ‘¢. This sampling strategy allows
us to evaluate the performance of all methods in estimating ğ…(ğ‘¡)
for nodes with high degrees.
Results. Figure 2 shows the tradeoffs between query time and
actual Relative Error for each method, with the target node ğ‘¡uni-
formly selected from ğ‘‰. We note that BackMC consistently achieves
the shortest query time compared to the other baseline methods
at the same actual Relative Error level. Specifically, BackMC out-
performs Undir-BiPPR ,SetPush , and RBSby a factor of 10Ã—, and
surpasses BPPPushâˆ—,MC, and BackwardPush by100Ã—to1000Ã—, in
general. Particularly noteworthy is the significant superiority of
BackMC over SetPush , which previously established the best com-
plexity bound for estimating ğ…(ğ‘¡). This empirical observation aligns
with our theoretical arguments, not only showcasing the Î˜logğ‘›
ğ‘‘min
theoretical improvement of BackMC over SetPush but also high-
lighting the clean algorithm structure and ease of implementation.
Additionally, as mentioned in Section 4.2, the presence of a multi-
plicative factor 1/ğ›¼3in the complexity bound of SetPush hampers
its empirical performance efficiency.
Figure 3 illustrates the tradeoffs between query time and actual
Relative Error for each method, with the target node ğ‘¡sampled from
the degree distribution. Analogously, BackMC consistently outper-
forms all baseline methods on all datasets in terms of both efficiency
and accuracy. Notably, we omit the BackwardPush method from the
Twitter dataset analysis due to its query time exceeding 12 hours.
This observation aligns with our analysis that considerable time is
required by BackwardPush to perform push operations on nodes
with high degrees, given that the Twitter dataset is dense with a
large average degree, as shown in Table 3.
In Figures 2 and 3, we maintain a fixed teleport probability ğ›¼of
0.2. In Figure 4, we present the tradeoffs between query time and
actual Relative Error with ğ›¼=0.01. Target nodes ğ‘¡are uniformly
sampled from ğ‘‰. Comparing the results from Figure 4 and Figure 2,
we observe a more pronounced superiority of BackMC over SetPush .
This aligns well with our analysis that the SetPush method has a
multiplicative factor of 1/ğ›¼3in its complexity bound, which will
become significant when ğ›¼is small. In contrast, the computationalcomplexity of our BackMC has a multiplicative 1/ğ›¼2factor, which is
more favorable than that of SetPush . Additionally, a small ğ›¼also
makes the query time of RBSunaffordable on large-scale Twitter and
Friendster datasets. We omit them from Figure 4. We also exclude
BackwardPush on Twitter and MCon Friendster from Figure 4, as
their query time both exceed 12h.
6.2 Experiments on Synthetic Graphs
In this subsection, we evaluate BackMC and the competitors on
synthetic ErdÅ‘sâ€“RÃ©nyi (ER) graphs.
Datasets. We generate four ER graphs, each comprising a fixed
number of nodes ( ğ‘›=100,000). The first graph, designated as
ER10, features an edge-connection probability of 10/ğ‘›between
any two nodes. In other words, the probability that any given pair
of nodes in the ER10 graph will be connected is consistently set
to10/ğ‘›. This connection probability is sequentially increased to
100/ğ‘›,1000/ğ‘›, and 10000/ğ‘›for the subsequent graphs, referred to
as ER100, ER1000, and ER10000, respectively. As a direct outcome,
the average degree of nodes in the ER10 graph is approximately
10, while the corresponding average degrees in the ER100, ER1000,
and ER10000 graphs are roughly 100, 1000, and 10000, respectively.
Notably, we present the minimum degree (i.e., ğ‘‘min) observed in
these four ER graphs in Table 3, which are around 1,10,102, and 103
for each graph, in ascending order of connection probability. These
variations in ER graphs serve as a basis to demonstrate the superior
performance of BackMC across a spectrum of graphs distinguished
by differing values of ğ‘‘min.
Results. In Figure 5, we present the trade-off between actual rel-
ative error and query time across the four ER graphs. Our first
observation is that BackMC consistently surpasses all baseline meth-
ods by orders of magnitude in query time for the same level of actual
relative error. Notably, the margin of BackMC â€™s superiority over its
competitors increases as ğ‘‘minrises. Specifically, on the ER10 graph,
BackMC is tenfold faster than both SetPush ,Undir-BiPPR andRBS.
This leading factor escalates from tenfold to a thousandfold. On the
ER10000 graph, BackMC exceeds the performance of all competitors
by at least three orders of magnitude in query time for comparable
actual relative errors. Additionally, it is important to highlight that
while the query time for competitor methods escalates with an
increase inğ‘‘min(thus attributable to the growing number of edges),
BackMC uniquely exhibits reduced query times as ğ‘‘minincreases.
This phenomenon underscores BackMC â€™s exceptional efficiency and
corroborates our analysis, demonstrating a negative correlation
between the computational complexity of BackMC andğ‘‘min.
3043Revisiting Local PageRank Estimation on Undirected Graphs: Simple and Optimal KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
7 Conclusion
This paper introduces a simple and optimal algorithm, BackMC , for
estimating a single nodeâ€™s PageRank score in undirected graphs.
We have demonstrated the optimality of BackMC and assessed its
performance on large-scale graphs. As for future directions, we
aim to adapt BackMC to tackle single-pair PPR queries in undirected
graphs. Given that the computation of PPR scores relates closely to
that of PageRank scores, as shown in Equation (5), we are motivated
to investigate further in this area.
Acknowledgments
I would like to thank Professor Zhewei Wei for his unconditional
support. I would also like to thank the anonymous reviewers for
their insightful comments.
References
[1]Reid Andersen, Christian Borgs, Jennifer Chayes, John Hopcraft, Vahab S Mir-
rokni, and Shang-Hua Teng. Local computation of pagerank contributions. In
International Workshop on Algorithms and Models for the Web-Graph, pages 150â€“
165. Springer, 2007.
[2]Konstantin Avrachenkov, Nelly Litvak, Danil Nemirovsky, and Natalia Osipova.
Monte carlo methods in pagerank computation: When one iteration is sufficient.
SIAM Journal on Numerical Analysis, 45(2):890â€“904, 2007.
[3]Ziv Bar-Yossef and Li-Tal Mashiach. Local approximation of pagerank and reverse
pagerank. In Proceedings of the 17th ACM conference on Information and knowledge
management, pages 279â€“288, 2008.
[4]Aleksandar Bojchevski, Johannes Klicpera, Bryan Perozzi, Amol Kapoor, Martin
Blais, Benedek RÃ³zemberczki, Michal Lukasik, and Stephan GÃ¼nnemann. Scaling
graph neural networks with approximate pagerank. In Proceedings of the 26th
ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,
New York, NY, USA, 2020. ACM.
[5]Christian Borgs, Michael Brautbar, Jennifer Chayes, and Shang-Hua Teng. A
sublinear time algorithm for pagerank computations. In International Workshop
on Algorithms and Models for the Web-Graph, pages 41â€“53. Springer, 2012.
[6]Christian Borgs, Michael Brautbar, Jennifer Chayes, and Shang-Hua Teng. Mul-
tiscale matrix sampling and sublinear-time pagerank computation. Internet
Mathematics, 10(1-2):20â€“48, 2014.
[7]Marco Bressan, Enoch Peserico, and Luca Pretto. Sublinear algorithms for local
graph centrality estimation. In 2018 IEEE 59th Annual Symposium on Foundations
of Computer Science (FOCS), pages 709â€“718. IEEE, 2018.
[8]Marco Bressan, Enoch Peserico, and Luca Pretto. Sublinear algorithms for local
graph-centrality estimation. SIAM Journal on Computing, 52(4):968â€“1008, 2023.
[9]Sergey Brin and Lawrence Page. The anatomy of a large-scale hypertextual web
search engine. Computer networks and ISDN systems, 30(1-7):107â€“117, 1998.
[10] Ming Chen, Zhewei Wei, Bolin Ding, Yaliang Li, Ye Yuan, Xiaoyong Du, and
Ji-Rong Wen. Scalable graph neural networks via bidirectional propagation. arXiv
preprint arXiv:2010.15421, 2020.
[11] Yen-Yu Chen, Qingqing Gan, and Torsten Suel. Local methods for estimating
pagerank values. In Proceedings of the thirteenth ACM international conference on
Information and knowledge management, pages 381â€“389, 2004.
[12] Paul Dagum, Richard Karp, Michael Luby, and Sheldon Ross. An optimal algo-
rithm for monte carlo estimation. SIAM Journal on computing, 29(5):1484â€“1496,
2000.[13] DÃ¡niel Fogaras, BalÃ¡zs RÃ¡cz, KÃ¡roly CsalogÃ¡ny, and TamÃ¡s SarlÃ³s. Towards
scaling fully personalized pagerank: Algorithms, lower bounds, and experiments.
Internet Mathematics, 2(3):333â€“358, 2005.
[14] David F Gleich. Pagerank beyond the web. siam REVIEW, 57(3):321â€“363, 2015.
[15] Goldreich and Ron. Property testing in bounded degree graphs. Algorithmica,
32(2):302â€“343, 2002.
[16] Oded Goldreich, Shari Goldwasser, and Dana Ron. Property testing and its
connection to learning and approximation. Journal of the ACM (JACM), 45(4):653â€“
750, 1998.
[17] Marco Gori, Augusto Pucci, Via Roma, and I Siena. Itemrank: A random-walk
based scoring algorithm for recommender engines. In IJCAI, volume 7, pages
2766â€“2771, 2007.
[18] Vince Grolmusz. A note on the pagerank of undirected graphs. Information
Processing Letters, 115(6-8):633â€“634, 2015.
[19] Pankaj Gupta, Ashish Goel, Jimmy Lin, Aneesh Sharma, Dong Wang, and Reza
Zadeh. Wtf: The who to follow service at twitter. In Proceedings of the 22nd
international conference on World Wide Web, pages 505â€“514, 2013.
[20] ZoltÃ¡n GyÃ¶ngyi, Hector Garcia-Molina, and Jan Pedersen. Combating web spam
with trustrank. In Proceedings of the Thirtieth international conference on Very
large data bases-Volume 30, pages 576â€“587, 2004.
[21] Johannes Klicpera, Aleksandar Bojchevski, and Stephan GÃ¼nnemann. Predict
then propagate: Graph neural networks meet personalized pagerank. In ICLR,
2019.
[22] Peter Lofgren, Siddhartha Banerjee, and Ashish Goel. Bidirectional pagerank
estimation: From average-case to worst-case. In Algorithms and Models for the
Web Graph: 12th International Workshop, WAW 2015, Eindhoven, The Netherlands,
December 10-11, 2015, Proceedings 12, pages 164â€“176. Springer, 2015.
[23] Peter Lofgren, Siddhartha Banerjee, and Ashish Goel. Personalized pagerank
estimation and search: A bidirectional approach. In Proceedings of the Ninth ACM
International Conference on Web Search and Data Mining, pages 163â€“172, 2016.
[24] Peter Lofgren and Ashish Goel. Personalized pagerank to a target node. arXiv
preprint arXiv:1304.4658, 2013.
[25] Peter A Lofgren, Siddhartha Banerjee, Ashish Goel, and C Seshadhri. Fast-ppr:
Scaling personalized pagerank estimation for large graphs. In Proceedings of
the 20th ACM SIGKDD international conference on Knowledge discovery and data
mining, pages 1436â€“1445, 2014.
[26] Barbara Logan Mooney, L RenÃ© Corrales, and Aurora E Clark. Molecularnetworks:
An integrated graph theoretic and data mining tool to explore solvent organiza-
tion in molecular simulation. Journal of computational chemistry, 33(8):853â€“860,
2012.
[27] Julie L Morrison, Rainer Breitling, Desmond J Higham, and David R Gilbert. Gen-
erank: using search engine technology for the analysis of microarray experiments.
BMC bioinformatics, 6(1):1â€“14, 2005.
[28] Lawrence Page, Sergey Brin, Rajeev Motwani, and Terry Winograd. The pagerank
citation ranking: bringing order to the web. 1999.
[29] Bryan Perozzi, Rami Al-Rfou, and Steven Skiena. Deepwalk: Online learning
of social representations. In Proceedings of the 20th ACM SIGKDD international
conference on Knowledge discovery and data mining, pages 701â€“710, 2014.
[30] Hanzhi Wang, Mingguo He, Zhewei Wei, Sibo Wang, Ye Yuan, Xiaoyong Du, and
Ji-Rong Wen. Approximate graph propagation. In Proceedings of the 27th ACM
SIGKDD Conference on Knowledge Discovery & Data Mining, pages 1686â€“1696,
2021.
[31] Hanzhi Wang and Zhewei Wei. Estimating single-node pagerank in
eğ‘‚(min
ğ‘‘ğ‘¡,âˆšğ‘š	
time. Proc. VLDB Endow., 16(11):2949â€“2961, 2023.
[32] Hanzhi Wang, Zhewei Wei, Junhao Gan, Sibo Wang, and Zengfeng Huang. Per-
sonalized pagerank to a target node, revisited. In Proceedings of the 26th ACM
SIGKDD International Conference on Knowledge Discovery & Data Mining, pages
657â€“667, 2020.
[33] Hanqing Zeng, Hongkuan Zhou, Ajitesh Srivastava, Rajgopal Kannan, and Viktor
Prasanna. GraphSAINT: Graph sampling based inductive learning method. In
ICLR, 2020.
3044