Graph Anomaly Detection with Few Labels:
A Data-Centric Approach
Xiaoxiao Ma
School of Computing
Macquarie University
Sydney, NSW, Australia
xiaoxiao.ma2@hdr.mq.edu.auRuikun Li
Business School
The University of Sydney
Sydney, NSW, Australia
ruikun.li@sydney.edu.auFanzhen Liu
School of Computing
Macquarie University
Sydney, NSW, Australia
fanzhen.liu@hdr.mq.edu.au
Kaize Ding
Department of Statistics and Data
Science, Northwestern University
Evanston, IL, USA
kaize.ding@northwestern.eduJian Yang
School of Computing
Macquarie University
Sydney, NSW, Australia
jian.yang@mq.edu.auJia Wu
School of Computing
Macquarie University
Sydney, NSW, Australia
jia.wu@mq.edu.au
ABSTRACT
Anomalous node detection in a static graph faces significant chal-
lenges due to the rarity of anomalies and the substantial cost of label-
ing their deviant structure and attribute patterns. These challenges
give rise to data-centric problems, including extremely imbalanced
data distributions and intricate graph learning, which significantly
impede machine learning and deep learning methods from discern-
ing the patterns of graph anomalies with few labels. While these
issues remain crucial, much of the current research focuses on ad-
dressing the induced technical challenges, treating the shortage of
labeled data as a given. Distinct from previous efforts, this work fo-
cuses on tackling the data-centric problems by generating auxiliary
training nodes that conform to the original graph topology and
attribute distribution. We categorize this approach as â€˜data-centric, â€™
aiming to enhance existing anomaly detectors by training them on
our synthetic data. However, the methods for generating nodes and
the effectiveness of utilizing synthetic data for graph anomaly de-
tection remain unexplored in the realm. To answer these questions,
we thoroughly investigate the denoising diffusion model. Drawing
from our observations on the diffusion process, we illuminate the
shifts in graph energy distribution and establish two principles
for designing denoising neural networks tailored to graph anom-
aly generation. From the insights, we propose a diffusion-based
graph generation method to synthesize training nodes, which can
be promptly integrated to work with existing anomaly detectors.
The empirical results on eight widely-used datasets demonstrate
our generated data can effectively enhance the nine state-of-the-art
graph detectorsâ€™ performance.
CCS CONCEPTS
â€¢Computing methodologies â†’Machine learning.
This work is licensed under a Creative Commons Attribution
International 4.0 License.
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Â©2024 Copyright held by the owner/author(s).
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3671929KEYWORDS
Graph Anomaly Detection, Generative Graph Diffusion
ACM Reference Format:
Xiaoxiao Ma, Ruikun Li, Fanzhen Liu, Kaize Ding, Jian Yang, and Jia Wu.
2024. Graph Anomaly Detection with Few Labels: A Data-Centric Approach.
InProceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery
and Data Mining (KDD â€™24), August 25â€“29, 2024, Barcelona, Spain. ACM, New
York, NY, USA, 12 pages. https://doi.org/10.1145/3637528.3671929
1 INTRODUCTION
A primary goal of graph anomaly detection is to identify irregular
nodes in a static graph that deviate significantly from the majori-
ties. These anomalies are far less common than regular nodes (as
indicated by the anomaly ratio in Table 2), but detecting them1
is even crucial for social benefits, such as detecting frauds in on-
line social networks [ 7,9,47], fake news in social media [ 52], rare
molecules for drug discovery [ 33], malware in computing systems,
brain health monitoring [49] and others [28].
Suffering from the rareness of anomalies and the substantial cost
of labeling, numerous studies accepted these data-centric challenges
as the de facto settings in graph anomaly detection and pursued the
implementation of more sophisticated graph learning algorithms
to detect graph anomalies with few labels. These methods typically
engage with tech-specific challenges identified in [32] such as the
class-imbalanced learning and over-/under-fitting issues on a spe-
cific class [ 41] that drastically undermine the proposed models on
learning a generalized decision boundary between anomalies and
the majorities, similar to other learning tasks where label access is
insufficient [ 18,38]. However, to our knowledge, there is still no
promising research to explicitly address the data problems.
Intuitively, having access to more labeled anomalies substantially
aids graph anomaly detectors in distinguishing between anomalous
and normal nodes, and inspired by the remarkable advancements
in utilizing synthetic tabular data for training machine learning
models [ 13,30,39], we pivot our focus towards the generation of
training nodes that closely replicate the original graph distribution.
Distinct from previous Model-Centric strategies that focus on
classifying anomalies, our approach is Data-Centric because we
1We use the terms â€˜graph anomaliesâ€™ and â€˜anomalous nodesâ€™, as well as â€˜node featuresâ€™ and â€˜node
attributesâ€™ interchangeably.
 
2153
KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
Performance gain on Macro-F1GraphSAGEGCNGATBWGNNAMNetGat-sepGHRNPerformance gain on AUCOriginal F1Improved F1GraphSAGEGCNGATBWGNNAMNetGat-sepGHRNOriginal AUCImproved AUC506070607080
Figure 1: Seven semi-/supervised graph anomaly detectorsâ€™
performance has been significantly improved on YelpChi
after training with our synthetic data.
prioritize the generation and utilization of synthetic data to address
the data scarcity challenge. However, this approach naturally in-
curs two fundamental concerns: First, the challenge of ensuring
the synthetic data closely replicates the intricate characteristics
of graph data; and Second, whether the synthetic data can benefit
graph anomaly detection.
To address these concerns, we delve into the denoising diffusion
models [ 16,34], which have shown promising results in synthesiz-
ing high quality images/videos, to engage specific clues in generat-
ing training data. By inspecting the changes of the graphâ€™s spec-
trum (as depicted in Figs. 2 and 3), we observe a progressive shift in
the graphâ€™s spectral energy distribution from lower to higher fre-
quencies as the diffusion forwards, and the average node attribute
similarities with 1-hop neighbors (which we call egonet dissimilar-
ity) change more dramatically among anomalies. Through rigorous
analysis on these observations, we identify two principles that the
denoising neural network should be capable of: P1. Preserving
each nodeâ€™s feature dissimilarities with its neighbors (capturing
the local graph semantics); and P2. Recovering the low frequency
graph energy. We follow the principles and propose a uncondi-
tional denoising-based graph diffusion model, namely GenGA and
a classifier guided generation model, CGenGA, to generate data
tailored to graph anomaly detection. The results in Fig. 1 showcase
the significant performance gains of seven anomaly detectors w.r.t.
Macro-F1 and AUC after training with our synthesized data. The
main contributions of this paper are:
â€¢A Data-Centric Approach for Graph Anomaly Detection :
We pivot the focus from solely improving detection models to
leveraging synthetic data to augment existing anomaly detectors.
This data-centric approach is designed to complement existing
detectors, offering the advantage of generating reusable data that
can seamlessly integrate with current methodologies.
â€¢Two Design Principles : Our empirical analysis, particularly on
the changes in the graph spectrum, has led to the formulation
of two core principles for designing our denoising neural net-
work. These principles guide the generation of synthetic training
samples that accurately mirror the original data distribution.
â€¢Empirical Results : The extensive experiments on eight datasets
demonstrate that our approach significantly enhances the perfor-
mance of nine state-of-the-art anomaly detection models. Further
investigations into seven research questions provide deeper in-
sight to our design and identify promising avenues for future
research in this direction.
0.000.120.240.360.000.120.240.36
0.00.20.40.60.81.01.21.41.61.82.00.000.030.060.080.00.20.40.60.81.01.21.41.61.82.00.000.030.060.08 
  
  
  
 
<latexit sha1_base64="l6v7b8WEz3KlQh/xTtq1s64OQWE=">AAAB7nicbVDLSsNAFL2pr1pfVZduBovgqiQi6rLoxmUF+4A2lJvJpB06mYSZiVBCP8KNC0Xc+j3u/BunbRbaemDgcM65zL0nSAXXxnW/ndLa+sbmVnm7srO7t39QPTxq6yRTlLVoIhLVDVAzwSVrGW4E66aKYRwI1gnGdzO/88SU5ol8NJOU+TEOJY84RWOlTl/YaIiDas2tu3OQVeIVpAYFmoPqVz9MaBYzaahArXuemxo/R2U4FWxa6WeapUjHOGQ9SyXGTPv5fN0pObNKSKJE2ScNmau/J3KMtZ7EgU3GaEZ62ZuJ/3m9zEQ3fs5lmhkm6eKjKBPEJGR2Owm5YtSIiSVIFbe7EjpChdTYhiq2BG/55FXSvqh7V/XLh8ta47aoowwncArn4ME1NOAemtACCmN4hld4c1LnxXl3PhbRklPMHMMfOJ8/P7OPhg==</latexit> EigenvaluesDiffusion steps(%)step 0%step 25%step 50%step 100%LowfrequenciesHighfrequenciesEgonet dissimilarity
LinearschedulerCosineschedulerSpectral energy distributionAnomaliesNormal nodes
(a)(b)0204060801001234
0204060801001234Figure 2: On Cora dataset, by gradually injecting scheduled
noise to node attributes as the forward diffusion process. (a).
Anomaliesâ€™ egonet dissimilarities change more dramatically
than normal nodes. (b). The ratios of lower frequency energy
drop while higher frequencies increase (shifting from lower
to higher frequencies). Details are presented in Sec. 4.
2 RELATED WORK
2.1 Graph Anomaly Detection
In this work, the target of graph anomaly detection is to iden-
tify the rare and divergent nodes that exhibit different structural
and attribute patterns [ 2,10,32] with few labels. Under the semi-
/supervised learning setting, anomalous node detection can be trans-
formed as a binary classification task [ 42] that encounters extremely
class-imbalanced data. As to explore the graph structure, node at-
tributes and fuse abnormal patterns of anomalies from labeled data,
various graph neural network (GNN) based semi-/supervised detec-
tors have been devised [ 26,27,42]. They attempt to directly assign
labels to nodes by learning a decision boundary between anomalies
and normal nodes. For instance, BWGNN [ 42] employs the Beta
graph wavelet and utilizes few labeled anomalies to learn band-pass
filters to capture the signals of anomalies, GHRN [ 8] further applies
the graph wavelet to address the heterophility of graph.
Apart from these semi-/supervised detectors, there are plenty of
unsupervised anomaly detection techniques, such as CONAD [ 28]
and SL-GAD [ 55] that investigate the consistency between anom-
alies and their neighbors in different contrastive views to measure
node irregularity. Others like [ 6], [25] and [ 55] quantify the residual
errors as a measurement of anomaly scores. Although these unsu-
pervised methods explore different perspectives on the deviating
patterns of anomalies without utilizing labels for training, they still
rely on labeled data for hyperparameter tuning and to determine
a reasonable threshold to classify anomalies from the continuous
anomaly scores/ranks [1, 32].
We further compare our work with previous graph anomaly de-
tection methods in Table 1 and we show that all the prior method-
ologies focus on tackling the detection problems introduced by the
data, which we categorize as model-centric, while synthesizing la-
beled training data is still an unexplored territory. It is worth noting
that our data-centric approach can be categorized as a specific data
augmentation method, but different from conventional augmenta-
tion methods that focus on enhancing node features, contrastive
views or egonet structures [ 35,54] for specific methods [ 28,55], we
 
2154Graph Anomaly Detection with Few Labels:
A Data-Centric Approach KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Table 1: Comparison with existing works in anomalous node detection.
Metho
ds Examples Category Types Synthetic Data Label Supervision Working Mechanism Output Decision
V
anilla Semi-/Supervised MP-GNNs [12, 24, 44] MC - CLF & HPT Node Classification Labels
Semi-/Supervised Detectors [4, 8, 9, 29, 29, 42, 45] MC - CLF & HPT Node Classification Labels/Score
Unsupervised Detectors [3, 6, 36] MC - HPT Node Scoring/Ranking Scores
Unsupervised-Contrastive Detectors [28, 50, 55] MC Subgraph View Sampling HPT Node Scoring/Ranking Scores
Graph Augmentation Methods [35, 54] MC Enhanced Egonet HPT Modify Existing Methods -
Generativ
e Method (Ours) DC Graphs mimicking the raw data CLF & HPT Enhancing Existing Detectors Synthesized Data and Labels
Notes: DCis
short for Data-Centric. MCis short for Model-Centric. CLF is short for classification. HPT is short for hyperparamter tunning.
directly solve the label scarcity problem by generating more train-
ing data that can be promptly applied to enhance existing detectors
without modifying their designs.
2.2 Denoising Diffusion Probabilistic Model
Denoising diffusion probabilistic models (DDPMs) have recently
shown their great power in image synthesis [ 16,34], time series
forecasting [ 31], and many other generative tasks [ 51]. Practically, a
DDPM contains two processes, namely the Forward diffusion process
(ordiffusion process for brevity), which gradually adds scheduled
Gaussian noise to the original data ğ’™0through a T-step2Markov
chain such that the eventual distribution at the last step ğ‘(ğ’™ğ‘‡|ğ’™0)âˆ¼
N(0,I), and the Reverse process (ordenoising process), which strives
to recover the data by removing the noise at each time step.
In the forward diffusion process, given the noise variance sched-
uleğ›½ğ‘¡âˆˆ(0,1), the noisy data at a particular step tcan be formulated
in closed form:
ğ‘(ğ’™ğ‘¡|ğ’™0)=ğ‘¡Ã–
ğ‘ =1ğ‘(ğ’™ğ‘ |ğ’™ğ‘ âˆ’1)=N(ğ’™ğ‘¡;âˆšÂ¯ğ›¼ğ‘¡ğ’™0,(1âˆ’Â¯ğ›¼ğ‘¡)I),
ğ’™ğ‘¡=âˆšÂ¯ğ›¼ğ‘¡ğ’™0+âˆšï¸
(1âˆ’Â¯ğ›¼ğ‘¡)I,(1)
where Â¯ğ›¼ğ‘¡=Ãğ‘¡
ğ‘ =1ğ›¼ğ‘ andğ›¼ğ‘¡=1âˆ’ğ›½ğ‘¡. The contrast reverse process
attempts to recover the original data from noise following
ğ‘ğœ½(ğ’™0:ğ‘‡):=ğ‘(ğ’™ğ‘‡)ğ‘‡Ã–
ğ‘¡=1ğ‘ğœ½(ğ’™ğ‘¡âˆ’1|ğ’™ğ‘¡),
ğ‘ğœ½(ğ’™ğ‘¡âˆ’1|ğ’™ğ‘¡):=N ğ’™ğ‘¡âˆ’1;ğğœ½(ğ’™ğ‘¡,ğ‘¡),Î£ğœ½(ğ’™ğ‘¡,ğ‘¡),(2)
where the mean and variance (i.e., ğğœ½and Î£ğœ½) of the data dis-
tributionğ‘ğœ½(ğ’™ğ‘¡âˆ’1|ğ’™ğ‘¡)are predicted using a deep neural network
with parameters ğœ½(also called denoising neural network), which is
typically fine-tuned with regard to the objective
arg min
ğœ½Eğ’™0,ğœ–
||ğœ–âˆ’ğœ–ğœ½(âˆšÂ¯ğ›¼ğ‘¡ğ’™0+âˆš1âˆ’Â¯ğ›¼ğ‘¡ğœ–,ğ‘¡)||2
2
, (3)
whereğœ–is Gaussian noise.
After training, the denoising neural network will capture the
original data distribution ğ‘(ğ‘¥). A new sample, represented as ğ’™ğ‘
0,
can then be firmly generated by sampling ğ’™ğ‘‡âˆ¼N( 0,I)and gradu-
ally reversing the diffusion process according to Eq. (2).
To date, although DDPMs have shown superior capability in
various data generation tasks, the progress on denoising graph
diffusion still mainly focuses on modeling the graph-level patterns
within a set of graphs [ 17,19,20]. Capturing the node attribute and
local structure distribution of a single graph, especially for graph
2The italic ğ‘‡specifically denotes noise scales while the superscript â€˜ âŠ¤â€™ stands for the
transpose of a matrix.anomaly detection has yet to be explored. We refer to literature
such as [16, 31, 34, 51] for more details about DDPMs.
3 PRELIMINARIES
Definition 1. Static Attributed Graph. A static attributed
graphG={A,X}comprisesğ‘›nodes with attributes. Ais the adja-
cency matrix without self-loop, Xis the node attribute matrix.
Definition 2. Egonet Dissimilarity3.The egonet dissimilarity
â„¦=[ğğ‘–]ğ‘›Ã—ğ‘˜=LXquantifies how each node ğ‘£ğ‘–â€™s attributes are
different from its egonet neighbors in N(ğ‘–).L=Iâˆ’D-1
2AD-1
2is the
normalized graph Laplacian corresponding to GandDis the degree
matrix.
Definition 3. Forward Graph Diffusion (Process). In this
paper, we refer the forward graph diffusion as to inject ğ‘‡scales of
scheduled noise to node attributes. For each diffusion step {ğ‘¡}ğ‘‡
0,Gğ‘¡+1=
{A,Xğ‘¡+1}is the corrupted graph from Gğ‘¡={A,Xğ‘¡}, withG0=G.
Definition 4. Graph Anomaly Detection with Few Labels.
In this paper, we define graph anomaly detection as to identify anoma-
lous nodes in a static attributed graph G, which contains both anom-
alies in V1, and normal nodes in V0. It is to learn a classification func-
tion that maps each node ğ‘£ğ‘–âˆˆV,V=V1âˆªV0to its class label, which is
1for anomalies and 0for normal nodes, i.e., ğ‘“:{A,X}â†’ğ’šâˆˆ{0,1}ğ‘›.
In the context of few labels, anomalies are far rarer than normal nodes,
which means the cardinalities |V1|â‰ª|V0|.
4 DESIGN MOTIVATION AND ANALYSIS
In this section, we delve deeper into the forward graph diffusion
process and uncover two principles for designing the denoising
neural network based on our empirical observations and rigorous
analysis. We start by showing the divergent evolving dynamics of
anomalies and normal nodes w.r.t. egonet dissimilarity through-
out the diffusion process, followed by the analysis on the graphâ€™s
spectral energy distribution.
4.1 Study Setup
For analytical purposes, we choose the representative dataset Cora
and gradually inject noise into the node attributes. Specifically,
we apply the mostly-used linear and cosine schedulers [ 34,40] for
sampling noise and following [ 42], the node attributes are randomly
drawn fromN(1,1)for the normal class and N(1,5)for anomalies.
3To eliminate confusion, we use â€˜egonet dissimilarityâ€™ to specifically denote how each
node attributes differ from its egonet neighbors, distinct from the embedding method
used in previous works.
 
2155KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
4.2 Divergent Evolving Patterns in Anomaliesâ€™
Egonet Similarities
When measuring the average egonet dissimilarity of anomalies and
normal nodes at each forward step, according to our Definition 2,
we witness that anomalies (the redline) undergo a different trend
of changes compared to normal nodes (the blue line), as depicted
prior in Fig. 2(a). Such an observation on the differences between
anomalies and normal nodes indicates that the attribute similarities
between neighbors change along with the diffusion process, hence,
the denoising neural network should capture the local graph se-
mantics such that the attribute dis-/similarity information of each
node can be preserved in the generated graphs.
4.3 The Shift of Graph Spectral Energy
Apart from the egonet dissimilarity, we take another view on the
forward diffusion process via the lens of the graph spectrum and we
observe that the accumulated graph energy is shifting from lower
frequencies to higher frequencies, as depicted in Fig 2(b) and Fig 3.
Empirically, we can quantify the energy ratio of a particular
frequency (rank ğ‘™) at diffusion step ğ‘¡as
ğ›¾ğ‘™(ğ’™ğ‘¡,L)=(Ë†ğ‘¥ğ‘¡
ğ‘™)2/ğ‘›âˆ‘ï¸
ğ‘–=1(Ë†ğ‘¥ğ‘¡
ğ‘–)2, (4)
where Ë†ğ’™ğ‘¡=UâŠ¤ğ’™ğ‘¡=(Ë†ğ‘¥ğ‘¡
1,..., Ë†ğ‘¥ğ‘¡
ğ‘™,..., Ë†ğ‘¥ğ‘¡ğ‘›)âŠ¤is the graph Fourier trans-
formed signal at step ğ‘¡.U=(ğ’–1,..., ğ’–ğ‘›)âŠ¤are the eigenvectors of
the graph Laplacian L, in which ğ’–ğ‘™is the eigenvector corresponding
to theğ‘™-th smallest eigenvalue. By setting ğ‘™as a threshold, we clas-
sify signals(Ë†ğ‘¥ğ‘¡
1,..., Ë†ğ‘¥ğ‘¡
ğ‘™)as low frequency signals and the remaining
are considered high frequency ones.
As depicted in Fig. 2(b), the ratios of low frequency signals are
gradually decreasing while higher frequencies are becoming more
significant along the forward diffusion process. To clearly identify
such changes and following [ 42], at each step ğ‘¡, we further quantify
the accumulated energy ratios of low and high frequency signals
with regard to different thresholds. For a specific threshold ğ‘™, the
corresponding accumulated energy ratio is measured as:
Î“ğ‘™(ğ’™ğ‘¡,L)=ğ‘™âˆ‘ï¸
ğ‘–=1ğ›¾ğ‘–(ğ’™ğ‘¡,L). (5)
We find that the accumulated energy is shifting to higher fre-
quencies (the green area moves upward in Fig. 3), and a concrete
example is the accumulated energy ratio with eigenvalues below
0.3(at the top). As the diffusion forwards, Î“ğ‘™=0.3(ğ’™ğ‘¡,L)decreases
continuously. From the results, we have the following expectation
regarding Î“ğ‘™(ğ’™ğ‘¡,L).
Proposition 1. The expectation of low frequency energy ratio
Eğ’™âˆ¼N(| ğœ‡|,ğœ2)[Î“ğ‘™(ğ’™ğ‘¡,L)]is monotonically decreasing during the for-
ward diffusion process.
Proof. For analysis, we follow [ 11] and assume all node at-
tributes are drawn i.i.d. from a Gaussian distribution N(ğ’™;|ğœ‡|,ğœ2),
and the coefficient of variance ğœ/|ğœ‡|measures the degree of anom-
alies in the graph signal ğ’™. As the forward diffusion destroys the
original graph signal ğ’™andğ’™ğ‘¡âˆ¼N(âˆšÂ¯ğ›¼ğ‘¡ğ’™,1âˆ’Â¯ğ›¼ğ‘¡), we can measure
20 40 60 80 1000.00.51.01.52.0
StepsEigenvalue
0.0000.1250.2500.3750.5000.6250.7500.8751.000Accumulated
energy ratio
0.320 40 60 80 1000.10.20.30.40.5
Steps Eigenvalue â‰¤ 0.3Figure 3: Changes of Î“in the diffusion process.
the signal-to-noise ratio at an arbitrary step ğ‘¡by
SNR(ğ‘¡)=ğœ‡2
ğ‘¡
ğœ2
ğ‘¡=Â¯ğ›¼ğ‘¡
1âˆ’Â¯ğ›¼ğ‘¡, (6)
which denotes the ratio between the original signal and noise being
added. Therefore, a higher SNR means more original signal, while
a lower SNR indicates more noise. When injecting noise upon the
linear or cosine scheduler, Â¯ğ›¼ğ‘¡and the signal-to-noise ratio SNR
decrease progressively [ 31] asğ‘¡becomes larger. Consequently, the
measurement of the degree of anomalies, which can be quantified
with regard to SNR as:
ğœ
|ğœ‡|=âˆš1âˆ’Â¯ğ›¼ğ‘¡âˆšÂ¯ğ›¼ğ‘¡=âˆšï¸‚1
SNR(ğ‘¡), (7)
increases as the diffusion proceeds. According to [ 42]â€™s proof, the
expectation of low frequency energy ratio E(Î“ğ‘™(ğ’™ğ‘¡,L))will decrease
monotonically throughout the diffusion process because the value
ofğœ/|ğœ‡|increases. â–¡
Such a shift indicates that the graph spectral energy weights less
on low frequency eigenvalues at step ğ‘¡thanğ‘¡âˆ’1. Therefore, to obtain
ğ’™ğ‘¡âˆ’1by denoising ğ’™ğ‘¡(formulated in Eq. (2)), the denoising network
needs to recover the lower frequency energy. To summarize, from
our analysis, we identify two principles for designing the denoising
networks for DDPM-based graph generation: P1.The denoising
neural network should be capable of capturing the local information
in egonets (the graphâ€™s local semantics); and P2.The denoising neural
network needs to recover the low frequency energy.
5 METHODOLOGY
Following our devised design principles, in this section, we first
introduce our unconditional graph generation model GenGA, a
denoising-based neural network designed to generate auxiliary
training samples, i.e., nodes. Then, we propose CGenGA to further
involve classifier guidance for data generation. Finally, we present
how the generated graphs can be utilized to complement existing
detectors.
5.1 Denoising Neural Network Design
Regarding Definition 3 that we only inject noise to node attributes
during the diffusion process, one can apply any types of neural
 
2156Graph Anomaly Detection with Few Labels:
A Data-Centric Approach KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
networks as to denoise Xğ‘¡, which is actually predicting the mean
valueâˆšÂ¯ğ›¼ğ‘¡âˆ’1Xand variance(1âˆ’Â¯ğ›¼ğ‘¡âˆ’1)Ifrom graphGğ‘¡. However,
as advised by our design Principle P2, the choice of the denoising
network is limited due to the requirement of recovering the low
frequency energy.
As an effective low-pass filter, the graph convolutional neural
network (GCN) [ 24] is a strong candidate of the denoising network
because of its capacity in attenuating high frequency signals and
emphasizing lower frequencies [ 21]. Moreover, from the spatial
perspective, it also explores the local graph semantics through
feature propagation [ 48], which aligns with P1. Therefore, we apply
GCN as the backbone and design two ingredients, namely the step-
dependent GCN (Sdn) for learning node representations Zğ‘¡and the
distribution-estimator network (Den) for estimating the mean and
variance of Xğ‘¡âˆ’1.
5.2 Step-dependent GCN - Sdn
We build Sdn upon [ 23] with the aim of learning node represen-
tations that conform to Gaussian distribution ğ‘(Zğ‘¡|Xğ‘¡,A,ğ‘¡) âˆ¼
N(ğSdn
ğ‘¡,diag(Î£Sdn
ğ‘¡)),where matrices ğSdn
ğ‘¡anddiag(Î£Sdn
ğ‘¡)con-
tain the mean and variance vector of each nodeâ€™s representation
ğ’›ğ‘–
ğ‘¡at stepğ‘¡. Sinceğ‘¡is a scalar and to further involve it for node
representation learning, we propose an encoding function Te(Â·)to
generate a specific embedding matrix for each step ğ‘¡by
Te(ğ‘¡)=SeLUh
Se(ğ‘¡)ğ‘¾Te
1i
ğ‘¾Te
2, (8)
where ğ‘¾Te
1andğ‘¾Te
2are trainable parameters for projection. Se(Â·)
is the sinusoidal function and the values in vector Se(ğ‘¡)are

sin
ğ‘¡Â·exp(5 log 10
ğ‘‘/2âˆ’1Â·ğ‘‘)
,cos
ğ‘¡Â·exp(5 log 10
ğ‘‘/2âˆ’1Â·ğ‘‘)
.(9)
We then learn the node representationsâ€™ mean values ğSdn
ğ‘¡and
variance Î£Sdn
ğ‘¡respectively following:
ğSdn
ğ‘¡=ËœAZğ‘¡ğ‘¾Sdn
ğœ‡,log[diag(Î£Sdn
ğ‘¡)]=ËœAZğ‘¡ğ‘¾Sdn
Î£,(10)
where
Zğ‘¡=ReLU[ËœA(Xğ‘¡+Te(ğ‘¡))ğ‘¾Sdn
ğ‘] (11)
is the output of the first GCN layer in Sdn. ËœA=Dâˆ’1
2ADâˆ’1
2is the
normalized adjacency matrix. Matrices ğ‘¾Sdn
ğ‘,ğ‘¾Sdnğœ‡andğ‘¾Sdn
Î£are
variables in the GCN layers. Consequently, the node representations
Zğ‘¡can be promptly obtained following the reparameterization trick
in [22] and [23].
5.3 Distribution Estimator - Den
Given the node representations Zğ‘¡, we then propose a distribution
estimator for predicting the mean and variance of Xğ‘¡âˆ’1at the prior
diffusion step. Specifically, the predicted mean is
ğâ€²
ğ‘¡âˆ’1=ËœA[ReLU(ËœAZğ‘¡ğ‘¾Den
ğ‘)âŠ•Zğ‘¡]ğ‘¾Den
ğœ‡, (12)
whereâŠ•is for concatenation. Notably, we take this residual infor-
mation from Sdn to relieve oversmoothing and further validate its
effectiveness through the ablation study in Sec. 6.4. Similarly, we
estimate the variance as:
log[diag(Î£â€²
ğ‘¡âˆ’1)]=ËœA[ReLU(ËœAZğ‘¡ğ‘¾Den
ğ‘)âŠ•Zğ‘¡]ğ‘¾Den
Î£, (13)
where ğ‘¾Den
ğ‘,ğ‘¾Denğœ‡ andğ‘¾Den
Î£parameterize Den.Algorithm 1: Algorithms of GenGA and CGenGA.
Input: GraphG={A,X},ğ’š,ğœ†and diffusion parameters ğ›½,ğ›¼,Â¯ğ›¼.
Output: Generated graphGğ‘.
1while Not Converged do
/* Train the denoising neural network. */
2 ğ‘¡âˆ¼Uniform(1,Â·Â·Â·,ğ‘‡)
3 Xğ‘¡,Xğ‘¡âˆ’1â†Eq. (1)
4 Zğ‘¡,Zğ‘¡â†Sdn(Xğ‘¡,A, ğ‘¡)
5 ğâ€²
ğ‘¡âˆ’1,Î£â€²
ğ‘¡âˆ’1â†Den(Zğ‘¡,Zğ‘¡,A)
6 Update parameters in Sdn andDen with Gradients on Eq. (14).
7end
/* Unconditional graph generation - GenGA. */
8Xğ‘‡âˆ¼N( 0,I)
9forğ‘¡â†ğ‘‡to1do
10 ğâˆ¼N( 0,I)
11 Zğ‘¡,Zğ‘¡â†Sdn(Xğ‘¡,A, ğ‘¡)
12 ğâ€²
ğ‘¡âˆ’1,Î£â€²
ğ‘¡âˆ’1â†Den(Zğ‘¡,Zğ‘¡,A)
13 Xğ‘¡âˆ’1=ğâ€²
ğ‘¡âˆ’1+ğˆâ€²
ğ‘¡âˆ’1Iğ
14end
15Xğ‘â†X0
16returnGğ‘={A,Xğ‘}
/* Classifier guided graph generation - CGenGA. */
17while Not Converged do
/* Pretrain the classifier ğ‘ğœ‘(ğ‘¦|ğ’™ğ‘¡). */
18 ğ‘¡âˆ¼Uniform(1,Â·Â·Â·,ğ‘‡)
19 Xğ‘¡â†Eq. (1)
20 Update parameters ğœ‘in the classifier based on the binary
cross-entropy loss.
21end
22Xğ‘‡âˆ¼N( 0,I)
23forğ‘¡â†ğ‘‡to1do
24 ğâˆ¼N( 0,I)
25 Zğ‘¡,Zğ‘¡â†Sdn(Xğ‘¡,A, ğ‘¡)
26 ğâ€²
ğ‘¡âˆ’1,Î£â€²
ğ‘¡âˆ’1â†Den(Zğ‘¡,Zğ‘¡,A)
27 ğ‘”â†âˆ‡ ğ’™ğ‘¡logğ‘ğœ‘(ğ‘¦|ğ’™ğ‘¡); // classifier signal
28 Xğ‘¡âˆ’1=ğâ€²
ğ‘¡âˆ’1+ğœ†Î£â€²
ğ‘¡âˆ’1ğ‘”+ğˆâ€²
ğ‘¡âˆ’1Iğ
29end
30Xğ‘â†X0
31returnGğ‘={A,Xğ‘}
5.4 Training Criteria
Eventually, all parameters in Sdn andDen can be promptly fine-
tuned as to minimize the KL-divergence between the distributions
of the predicted Xâ€²
ğ‘¡âˆ’1and the noised Xğ‘¡âˆ’1at arbitrary steps ğ‘¡,
formulated as:
arg min
ğœ½ğ·KL ğ‘(Xğ‘¡âˆ’1|X,A)âˆ¥ğ‘ğœ½(Xğ‘¡âˆ’1|Xğ‘¡,A). (14)
5.5 Unconditional Graph Generation - GenGA
Once the whole model is sufficiently trained on different steps ğ‘¡,
we can simply sample Xğ‘‡fromN(0,I)and gradually estimate the
mean and variance of Xğ‘¡âˆ’1through Sdn andDen to generate a
new graphGğ‘={A,Xğ‘}that has the same number of nodes and
features as the original graph following:
Xğ‘¡âˆ’1=ğâ€²
ğ‘¡âˆ’1+ğˆâ€²
ğ‘¡âˆ’1Iğ, (15)
 
2157KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
where(ğˆâ€²
ğ‘¡âˆ’1)2I=diag(Î£â€²
ğ‘¡âˆ’1),ğis sampled from the standard
Gaussian distribution.
5.6 Classifier Guided Generation - CGenGA
While GenGA could generate auxiliary graphs from noise, it ig-
nores the class information for guiding graph generation. Here, we
further explore incorporating classifier guidance by conditioning
the generation process on class information with:
ğ‘ğœ½,ğœ‘(X0:ğ‘‡):=ğ‘(Xğ‘‡,A,ğ’š)ğ‘‡Ã–
ğ‘¡=1ğ‘ğœ½,ğœ‘(Xğ‘¡âˆ’1|Xğ‘¡,A,ğ’š), (16)
and following [5], each reverse step suffices to:
log[ğ‘ğœ½,ğœ‘(Xğ‘¡âˆ’1|Xğ‘¡,A)ğ‘ğœ½(ğ’š|Xğ‘¡,A)]â‰ˆ logğ‘(H)+ğ¶, (17)
whereğ¶is a constant and Hâˆ¼N( ğâ€²
ğ‘¡âˆ’1+Î£â€²
ğ‘¡âˆ’1ğ‘”,Î£â€²
ğ‘¡âˆ’1). Here,ğ‘”is the
involved classifier signal, which is the derivative of classifier on data,
ğ‘”=âˆ‡ğ’™ğ‘¡logğ‘ğœ‘(ğ‘¦|ğ’™ğ‘¡)[40], and the classifier ğ‘ğœ‘(ğ‘¦|ğ’™ğ‘¡)is trained on
noised node attribute ğ’™ğ‘¡and the node label ğ‘¦. In fact, involving
the classifier guidance is shifting the mean of the unconditional
generator [ 5] byÎ£â€²
ğ‘¡âˆ’1ğ‘”and the denoised node attribute matrix Xğ‘¡âˆ’1
can be firmly obtained via:
Xğ‘¡âˆ’1=ğâ€²
ğ‘¡âˆ’1+ğœ†Î£â€²
ğ‘¡âˆ’1ğ‘”+ğˆâ€²
ğ‘¡âˆ’1Iğ, (18)
whereğœ†is a hyperparameter for balancing the weight of classifier
signal. We summarize our algorithms in Algorithm 1.
5.7 Complement Graph Anomaly Detection
with Synthetic Data
For enhancing a given anomaly detector ğ‘“, we can simply input the
generated graphs Gğ‘={G1ğ‘,...,G|Gğ‘|
ğ‘}in addition to the original
graphGto fine-tune the parameters by minimizing their original
loss functions, such as the binary cross-entropy loss. The general-
ized form the total training loss can be written as:
Lğ‘¡ğ‘œğ‘¡ğ‘ğ‘™=L(ğ‘“(X,A),ğ’š)+1
|Gğ‘||Gğ‘|âˆ‘ï¸
ğ‘–=1L(ğ‘“(Xğ‘–,A),ğ’š), (19)
where the first term measures the training loss on the original graph,
while the second term calculates that on the synthetic graphs.
5.8 Complexity Analysis
The primary computational cost of our method stems from the train-
ing of the denoising neural network (generative model), graph gen-
eration, and classifier training (for classifier guidance in CGenGA).
For the generative model, the overall complexity of the time encod-
ing function Te(Â·) isO(2ğ‘›ğ‘‘ğ‘˜)and since SdnandDen adopt GCN as
the backbone, the cost of each training iteration is approximately
O(4ğ‘›ğ‘˜ğ‘‘), whereğ‘›is the number of nodes in G,ğ‘˜is the dimension-
ality of node attributes, and ğ‘‘is the dimension of the GCN layer.
The graph generation stage involves Sdn andDen for inference,
and the total cost of generating one graph is about O(4ğ‘›ğ‘˜ğ‘‘ğ‘‡), with
ğ‘‡diffusion steps. Taking GCN as the classifier in CGenGA, its
training cost at each iteration is O(2ğ‘›ğ‘˜ğ‘‘).Table 2: The statistics of the graph anomaly detection datasets
Dataset #No
des #Edges #Features #Degree #Anomalies Anomaly Ratio
Y
elpChi 45,954
3,846,979 32 83.7 6677 16.9%
Reddit 10,984
168,016 64 15.3 366 3.3%
Weibo 8,405
407,963 400 48.5 868 10.3%
Tolokers 11,758
519,000 10 44.1 2563 21.8%
Questions 48,921
153,540 301 3.1 1467 3%
BlogCatalog 5,196
172,759 8,189 33.2 298 5.7%
ACM 16,484
74,073 8,337 4.5 597 3.6%
Cora 2,708
11,060 1,433 4.1 138 5.1%
6 EXPERIMENTS
In this section, we conduct extensive experiments to seek answers
to the following research questions:
RQ1: How effective are the generated graphs in enhancing the
existing anomaly detectorsâ€™ performance?
RQ2: Can classifier signals enrich the generated graphs?
RQ3: How do the residual link in the denoising neural network
andğœ†influence the performance gains?
RQ4: How about the impact of the linear and cosine schedulers on
the performance?
RQ5: Can the detection performance be further improved with
more synthetic data?
RQ6: How fast can GenGA andCGenGA generate graphs?
RQ7: How effective is GenGA compared to other graph data aug-
mentation methods (in Appendix A.3)?
6.1 Experimental Setups
Datasets. We include eight widely-used graph anomaly detection
datasets for evaluation. Specifically, these datasets can be cate-
gorized into two groups: one with organic anomalies, including
YelpChi [ 37], Reddit [ 46], Weibo [ 53], Tolokers and Questions [ 41];
and another group with injected anomalies (BlogCatalog [ 6], ACM [ 6],
and Cora [ 27]). Statistics of the datasets are summarized in Table 2.
Implementation Details. In all experiments, we set the dimen-
sions of the GCN layers in SdnandDen as256and128respectively.
We adopt a total number of 1000 steps in the forward diffusion
process. For CGenGA, we implement a two-layered GCN as the
classifier for guidance, and for CONDAD and CoLA, we decide their
classification thresholds regarding the results on labeled nodes.
Existing Detector. To assess the efficacy of our synthetic data, we
adopt three GNN detectors built upon GCN [ 24], GAT [ 44], and
GraphSAGE [ 12], and four state-of-the-art semi-/supervised anom-
aly detectors: BWGNN [ 42], GAT-sep [ 56], AMNet [ 4], GHRN [ 8],
along with two unsupervised detectors, namely CONAD [ 50] and
CoLA [ 28]. We use one synthetic graph in the experiment unless
specified. More details are provided in Appendix A.2.
Graph Data Augmentation Methods. To validate our motiva-
tion of designing diffusion-based models for graph data genera-
tion, we further compare our methods with VGAE [ 23] and the
non-generative graph augmentation method GraphENS4[35] that
synthesize egonets for handling class imbalanced learning on graph.
Since GraphENS and VGAE do not involve classifier guidance for
training, we only compare GenGA with them.
Experimental Details. We train CGenGA and all existing de-
tectors (excluding CONAD and CoLA) strictly following Sec. 5.7
with a ratio of 20% labeled nodes to mimic the real scenarios with
4https://github.com/JoonHyung-Park/GraphENS
 
2158Graph Anomaly Detection with Few Labels:
A Data-Centric Approach KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
Table 3: Improved performance on three synthetic datasets.
Metho
dCora BlogCatalog A
CM
F1
AUC Pre Rec F1
AUC Pre Rec F1
AUC Pre Rec
GCN 53.12Â±0.3
67.75Â±0.4 56.21Â±0.5 52.71Â±0.2 60.14Â±0.4
68.18Â±0.7 69.36Â±0.8 57.60Â±0.1 56.77Â±0.1
69.21Â±0.2 58.19Â±0.1 55.91Â±0.1
+GenGA 69.28Â±0.2
(â†‘30.4%) 74.05Â±0.2 ( â†‘9.3%) 68.66Â±0.2 ( â†‘22.1%) 71.08Â±0.2 ( â†‘34.9%) 76.24Â±0.2
(â†‘26.8%) 77.55Â±0.5 ( â†‘13.7%) 87.88Â±0.6 ( â†‘26.7%) 74.95Â±0.3 ( â†‘30.1%) 73.91Â±0.2
(â†‘30.2%) 77.40Â±0.2 ( â†‘11.8%) 76.21Â±0.1 ( â†‘31.0%) 69.28Â±0.2 ( â†‘23.9%)
+CGenGA 65.12Â±0.1
(â†‘22.6%) 73.70Â±0.2 ( â†‘8.8%) 68.23Â±0.2 ( â†‘21.4%) 70.31Â±0.1 ( â†‘33.4%) 74.87Â±0.3
(â†‘24.5%) 75.56Â±0.2 ( â†‘10.8%) 86.79Â±0.5 ( â†‘25.1%) 70.57Â±1.4 ( â†‘22.5%) 72.31Â±0.1
(â†‘27.4%) 73.30Â±0.3 ( â†‘5.9%) 72.29Â±1.2 ( â†‘24.2%) 68.21Â±1.1 ( â†‘22.0%)
GAT 63.15Â±0.3
68.90Â±0.3 65.31Â±0.3 67.43Â±0.2 62.39Â±0.3
71.47Â±0.3 69.51Â±0.1 64.96Â±0.4 61.58Â±0.1
68.11Â±0.2 66.59Â±0.2 59.10Â±0.1
+GenGA 63.35Â±1.5
(â†‘0.3%) 70.05Â±0.6 ( â†‘1.7%) 67.76Â±1.5 ( â†‘3.8%) 71.55Â±3.9 ( â†‘6.1%) 65.73Â±1.8
(â†‘5.4%) 72.47Â±0.6 ( â†‘1.4%) 77.65Â±1.6 (â†‘11.7%) 73.80Â±3.2 ( â†‘13.6%) 66.49Â±2.2
(â†‘8.0%) 74.15Â±2.5 ( â†‘8.9%) 86.07Â±2.8 ( â†‘29.3%) 73.60Â±2.7 ( â†‘24.5%)
+CGenGA 66.03Â±0.3
(â†‘4.6%) 70.46Â±0.5 ( â†‘2.3%) 65.62Â±0.6 ( â†‘0.5%) 67.74Â±0.3 ( â†‘0.5%) 66.38Â±0.2
(â†‘6.4%) 71.51Â±0.4 ( â†‘0.1%) 71.26Â±0.2 (â†‘2.5%) 65.65Â±0.2 ( â†‘1.1%) 66.97Â±2.1
(â†‘8.8%) 71.33Â±1.4 ( â†‘4.7%) 67.38Â±0.6 ( â†‘1.2%) 66.66Â±2.0 ( â†‘12.8%)
GraphSAGE 52.24Â±0.3
68.00Â±0.4 57.01Â±0.5 51.89Â±0.2 63.25Â±0.2
61.31Â±0.2 73.95Â±0.4 59.68Â±0.1 65.70Â±0.2
64.94Â±0.2 67.88Â±0.2 61.26Â±0.1
+GenGA 68.60Â±3.1
(â†‘31.3%) 68.74Â±0.5 ( â†‘1.1%) 75.92Â±2.1 ( â†‘33.2%) 65.20Â±3.4 ( â†‘25.7%) 70.43Â±2.2
(â†‘11.4%) 73.09Â±3.2 ( â†‘19.2%) 75.45Â±1.8 (â†‘2.0%) 72.24Â±1.6 ( â†‘21.0%) 75.06Â±1.4
(â†‘14.3%) 72.33Â±3.0 ( â†‘11.3%) 82.97Â±4.8 ( â†‘22.2%) 70.72Â±1.7 ( â†‘15.4%)
+CGenGA 69.58Â±3.0
(â†‘33.2%) 69.80Â±1.9 ( â†‘2.6%) 80.13Â±4.8 ( â†‘40.6%) 65.13Â±2.8 ( â†‘25.5%) 74.72Â±0.2
(â†‘18.1%) 76.59Â±0.3 ( â†‘24.9%) 84.80Â±0.4 ( â†‘14.7%) 68.64Â±0.2 ( â†‘15.0%) 72.70Â±1.4
(â†‘10.7%) 72.22Â±2.2 ( â†‘11.2%) 81.90Â±4.0 ( â†‘20.7%) 68.19Â±2.5 ( â†‘11.3%)
BW
GNN 52.18Â±0.2
44.93Â±0.2 53.99Â±0.2 51.85Â±0.1 52.79Â±0.1
51.35Â±0.3 53.44Â±0.1 59.24Â±0.1 54.93Â±0.3
47.69Â±0.6 55.27Â±0.4 56.70Â±0.2
+GenGA 53.81Â±1.0
(â†‘3.1%) 48.01Â±3.5 ( â†‘6.8%) 56.04Â±1.7 ( â†‘3.8%) 52.98Â±0.6 ( â†‘2.2%) 55.91Â±2.9
(â†‘5.6%) 53.11Â±2.5 ( â†‘3.1%) 55.45Â±2.2 (â†‘3.8%) 60.96Â±2.3 ( â†‘2.9%) 58.34Â±0.9
(â†‘6.2%) 56.11Â±2.2 ( â†‘17.7%) 69.83Â±2.4 ( â†‘26.3%) 57.71Â±0.7 ( â†‘1.8%)
+CGenGA 53.50Â±0.4
(â†‘2.5%) 45.14Â±3.2 ( â†‘0.5%) 55.13Â±0.4 ( â†‘2.1%) 52.79Â±0.2 ( â†‘1.8%) 58.74Â±3.3
(â†‘10.9%) 52.60Â±1.1 (â†‘2.1%) 59.23Â±5.4 (â†‘10.8%) 61.43Â±3.1 ( â†‘3.7%) 57.66Â±0.8
(â†‘5.0%) 56.96Â±4.2 ( â†‘19.4%) 69.83Â±4.3 ( â†‘26.3%) 58.23Â±0.5 ( â†‘2.7%)
GAT-sep 57.08Â±0.5
63.99Â±0.5 58.43Â±0.5 56.45Â±0.4 66.82Â±0.1
75.97Â±0.5 67.44Â±0.1 66.40Â±0.2 65.45Â±0.2
74.58Â±0.2 65.11Â±0.2 66.02Â±0.2
+GenGA 61.37Â±1.7
(â†‘8.1%) 72.76Â±2.6 ( â†‘13.7%) 63.24Â±2.8 ( â†‘8.2%) 60.88Â±1.4 ( â†‘7.8%) 68.75Â±1.4
(â†‘2.6%) 78.90Â±5.1 ( â†‘3.9%) 87.84Â±1.6 (â†‘30.3%) 70.76Â±1.9 ( â†‘6.6%) 71.79Â±1.0
(â†‘9.7%) 86.51Â±1.6 ( â†‘16.0%) 70.16Â±1.8 ( â†‘7.7%) 73.50Â±1.0 ( â†‘11.3%)
+CGenGA 61.86Â±0.7
(â†‘8.4%) 69.96Â±2.2 ( â†‘9.3%) 63.89Â±1.1 ( â†‘9.3%) 60.65Â±0.7 ( â†‘7.4%) 69.44Â±0.1
(â†‘3.9%) 78.82Â±5.3 ( â†‘3.7%) 89.28Â±2.7 (â†‘32.4%) 74.89Â±1.1 ( â†‘12.8%) 71.71Â±0.5
(â†‘9.5%) 87.26Â±3.3 ( â†‘17.0%) 69.76Â±0.8 ( â†‘7.1%) 73.72Â±0.7 ( â†‘11.6%)
AMNet 53.09Â±0.1
65.64Â±0.3 53.18Â±0.1 53.55Â±0.1 66.21Â±0.4
72.23Â±0.3 63.46Â±0.4 73.26Â±0.3 60.11Â±0.1
74.54Â±0.2 58.93Â±0.2 62.41Â±0.1
+GenGA 54.17Â±0.9
(â†‘2.0%) 68.46Â±4.8 ( â†‘4.3%) 57.11Â±1.8 ( â†‘7.4%) 53.82Â±0.7 ( â†‘0.5%) 74.74Â±1.4
(â†‘12.9%) 78.88Â±1.6 (â†‘4.9%) 77.20Â±3.0 (â†‘21.7%) 75.16Â±1.1 ( â†‘2.6%) 60.64Â±1.1
(â†‘0.9%) 75.38Â±1.7 ( â†‘1.1%) 70.58Â±1.5 ( â†‘32.7%) 65.22Â±1.2 ( â†‘4.5%)
+CGenGA 53.71Â±0.8
(â†‘1.2%) 66.26Â±1.5 ( â†‘0.9%) 57.12Â±1.6 ( â†‘7.4%) 54.23Â±0.6 ( â†‘1.3%) 74.02Â±1.9
(â†‘11.8%) 77.45Â±3.1 (â†‘3.0%) 76.85Â±4.7 (â†‘21.1%) 73.72Â±1.6 ( â†‘0.6%) 60.79Â±0.8
(â†‘1.1%) 74.99Â±1.6 ( â†‘0.6%) 70.98Â±1.1 ( â†‘33.5%) 66.47Â±0.7 ( â†‘6.5%)
GHRN 50.08Â±0.5
59.67Â±0.9 52.31Â±0.5 52.11Â±0.4 56.69Â±0.2
51.62Â±0.5 56.13Â±0.2 60.55Â±0.2 57.60Â±0.1
60.18Â±0.5 68.37Â±0.3 55.09Â±0.1
+GenGA 51.05Â±1.7
(â†‘0.5%) 73.40Â±7.1 ( â†‘23.0%) 53.53Â±4.8 ( â†‘2.3%) 53.18Â±1.1 ( â†‘2.0%) 74.88Â±1.7
(â†‘32.1%) 74.44Â±3.2 ( â†‘44.2%) 64.55Â±0.8 ( â†‘15.0%) 70.24Â±0.9 ( â†‘16.0%) 57.75Â±1.1
(â†‘0.3%) 79.43Â±4.5 ( â†‘32.0%) 69.28Â±6.3 ( â†‘1.3%) 55.47Â±0.3 ( â†‘0.7%)
+CGenGA 52.75Â±1.6
(â†‘3.5%) 69.84Â±4.6 ( â†‘17.0%) 55.25Â±2.5 ( â†‘5.6%) 52.12Â±1.2 ( â†‘0.1%) 74.65Â±1.6
(â†‘31.7%) 76.07Â±4.9 ( â†‘47.4%) 65.49Â±0.8 ( â†‘16.7%) 71.37Â±2.1 ( â†‘17.9%) 58.02Â±1.1
(â†‘0.7%) 80.64Â±3.2 ( â†‘34.0%) 69.69Â±6.3 ( â†‘1.9%) 55.22Â±0.7 ( â†‘0.2%)
CONAD 53.53Â±0.1
70.48Â±0.7 54.53Â±0.2 66.17Â±0.1 53.87Â±0.2
63.03Â±0.1 58.97Â±0.1 52.90Â±0.1 53.16Â±0.1
70.86Â±0.1 54.28Â±0.1 60.12Â±0.1
+GenGA 57.38Â±0.2
(â†‘7.2%) 72.93Â±0.1 (â†‘3.5%) 59.40Â±0.2 (â†‘8.9%) 71.28Â±0.2 (â†‘7.7%) 58.17Â±0.2
(â†‘8.0%) 69.32Â±0.1 (â†‘10.0%) 64.36Â±0.2 (â†‘9.1%) 53.87Â±0.1 (â†‘1.8%) 56.18Â±0.2
(â†‘5.7%) 73.89Â±0.2 (â†‘4.3%) 59.52Â±0.2 (â†‘9.7%) 60.72Â±0.1 (â†‘1.0%)
+CGenGA 54.82Â±0.1
(â†‘2.4%) 72.86Â±0.2 (â†‘3.4%) 57.95Â±0.2 (â†‘6.3%) 70.11Â±0.2 (â†‘6.0%) 57.40Â±0.1
(â†‘6.6%) 65.31Â±0.2 (â†‘3.6%) 61.45Â±0.2 (â†‘4.2%) 56.14Â±0.1 (â†‘6.1%) 57.25Â±0.3
(â†‘7.7%) 75.63Â±0.2 (â†‘6.7%) 57.33Â±0.2 (â†‘5.6%) 61.05Â±0.1 (â†‘1.5%)
CoLA 48.18Â±0.5
51.86Â±0.4 51.65Â±0.2 52.48Â±0.3 47.53Â±0.1
58.29Â±0.2 52.14Â±0.1 58.63Â±0.1 43.77Â±0.5
48.68Â±0.2 51.78Â±0.5 50.03Â±0.2
+GenGA 51.71Â±0.1
(â†‘7.3%) 56.23Â±1.5 (â†‘8.5%) 53.08Â±0.2 (â†‘2.8%) 53.68Â±1.3 (â†‘2.3%) 50.09Â±0.1
(â†‘5.8%) 62.99Â±2.0 (â†‘8.1%) 52.83Â±0.2 (â†‘1.3%) 60.84Â±2.2 (â†‘3.8%) 45.97Â±0.2
(â†‘5.0%) 53.04Â±1.7 (â†‘9.0%) 56.38Â±0.1 (â†‘8.9%) 51.12Â±2.1 (â†‘2.2%)
+CGenGA 52.73Â±0.3
(â†‘9.5%) 55.58Â±0.2 (â†‘7.2%) 52.26Â±0.1 (â†‘1.2%) 55.20Â±0.3 (â†‘5.2%) 50.23Â±0.3
(â†‘6.1%) 61.39Â±0.2 (â†‘5.3%) 55.29Â±0.3 (â†‘6.0%) 59.29Â±0.1 (â†‘1.1%) 45.89Â±0.3
(â†‘4.9%) 53.42Â±0.2 (â†‘9.7%) 53.17Â±0.3 (â†‘2.7%) 52.06Â±0.2 (â†‘4.1%)
Table 4: Improved performance on five organic datasets w.r.t. Macro-F1 and AUC.
Metho
dY
elpChi Re
ddit W
eibo T
olokers Questions
F1
AUC F1
AUC F1
AUC F1
AUC F1
AUC
GCN 46.08Â±0.1
57.09Â±0.1 49.15Â±0.1
57.74Â±0.1 82.27Â±0.1
85.64Â±0.1 55.80Â±0.2
71.69Â±0.1 53.00Â±0.1
52.76Â±0.1
+GenGA 51.68Â±2.2
(â†‘12.2%) 60.15Â±1.0 ( â†‘5.4%) 50.99Â±1.2
(â†‘3.8%) 64.95Â±0.5 ( â†‘15.1%) 90.43Â±1.4
(â†‘9.9%) 94.08Â±1.3 ( â†‘9.9%) 63.45Â±0.8
(â†‘13.7%) 74.54Â±1.0 ( â†‘4.0%) 54.06Â±0.5
(â†‘2.0%) 64.08Â±1.2 ( â†‘21.4%)
+CGenGA 50.16Â±0.5
(â†‘8.8%) 60.58Â±0.5 ( â†‘6.1%) 51.77Â±0.5
(â†‘5.4%) 68.10Â±0.2 ( â†‘20.7%) 91.62Â±0.7
(â†‘11.4%) 94.66Â±0.9 ( â†‘10.5%) 64.62Â±0.6
(â†‘15.8%) 74.41Â±0.4 ( â†‘3.8%) 54.56Â±0.4
(â†‘2.9%) 64.67Â±1.4 ( â†‘22.6%)
GAT 46.98Â±0.1
58.24Â±0.1 49.24Â±0.1
64.45Â±0.2 85.62Â±0.1
79.86Â±0.9 55.43Â±0.2
71.97Â±0.1 50.42Â±0.2
54.70Â±0.1
+GenGA 51.53Â±1.3
(â†‘9.7%) 78.59Â±1.2 ( â†‘34.9%) 50.94Â±0.2
(â†‘3.4%) 65.08Â±0.4 ( â†‘1.0%) 90.72Â±1.3
(â†‘6.0%) 91.54Â±3.2 ( â†‘14.6%) 62.52Â±0.7
(â†‘12.8%) 76.19Â±1.0 ( â†‘5.9%) 51.92Â±2.1
(â†‘3.0%) 62.70Â±1.5 ( â†‘14.6%)
+CGenGA 62.00Â±0.4
(â†‘32.0%) 80.24Â±1.8 ( â†‘37.8%) 50.57Â±0.2
(â†‘2.7%) 65.61Â±0.4 ( â†‘1.8%) 90.14Â±0.6
(â†‘5.3%) 92.68Â±1.3 ( â†‘16.1%) 61.92Â±0.8
(â†‘11.7%) 76.24Â±0.9 ( â†‘5.9%) 51.66Â±2.2
(â†‘2.5%) 64.34Â±1.6 ( â†‘17.6%)
GraphSAGE 60.86Â±0.2
69.93Â±0.1 49.15Â±0.1
51.31Â±0.2 89.20Â±0.1
88.35Â±0.2 55.66Â±0.2
72.31Â±0.1 56.37Â±0.1
51.42Â±0.1
+GenGA 67.51Â±0.9
(â†‘10.9%) 83.74Â±0.6 ( â†‘4.2%) 62.00Â±0.1
(â†‘16.5%) 70.79Â±0.2 ( â†‘1.2%) 90.97Â±0.2
(â†‘2.1%) 90.02Â±2.9 ( â†‘1.9%) 62.56Â±0.7
(â†‘12.4%) 75.84Â±0.5 ( â†‘4.9%) 56.58Â±0.6
(â†‘0.4%) 59.84Â±0.6 ( â†‘16.4%)
+CGenGA 66.14Â±2.6
(â†‘8.7%) 83.73Â±0.3 ( â†‘4.2%) 67.64Â±0.1
(â†‘27.1%) 71.07Â±1.0 ( â†‘1.6%) 90.78Â±1.6
(â†‘1.8%) 89.44Â±3.3 ( â†‘1.2%) 61.06Â±1.0
(â†‘9.7%) 75.53Â±0.5 ( â†‘4.5%) 56.99Â±0.1
(â†‘1.1%) 59.84Â±1.2 ( â†‘16.4%)
BW
GNN 63.68Â±0.3
80.96Â±0.1 43.29Â±0.5
56.96Â±0.3 89.27Â±0.3
92.29Â±0.3 57.35Â±0.9
64.14Â±1.6 56.45Â±0.1
56.15Â±0.1
+GenGA 65.33Â±0.9
(â†‘2.6%) 81.31Â±0.7 ( â†‘0.4%) 44.48Â±0.5
(â†‘2.7%) 69.63Â±3.2 ( â†‘22.2%) 90.17Â±0.1
(â†‘1.0%) 93.84Â±0.3 ( â†‘1.7%) 63.12Â±0.7
(â†‘10.1%) 77.50Â±0.5 ( â†‘20.8%) 56.62Â±0.4
(â†‘0.3%) 57.45Â±1.4 ( â†‘2.3%)
+CGenGA 64.63Â±2.0
(â†‘1.5%) 81.56Â±0.4 ( â†‘0.7%) 45.51Â±0.5
(â†‘5.1%) 70.56Â±0.8 ( â†‘23.9%) 90.48Â±0.7
(â†‘1.4%) 93.08Â±0.3 ( â†‘0.9%) 62.90Â±0.6
(â†‘9.7%) 77.08Â±0.4 ( â†‘20.2%) 56.67Â±0.1
(â†‘0.4%) 57.50Â±0.2 ( â†‘2.4%)
GAT-sep 65.93Â±0.3
80.01Â±0.3 49.16Â±0.1
50.22Â±0.5 91.92Â±0.2
95.71Â±0.1 63.12Â±0.7
72.06Â±0.4 56.05Â±0.1
70.18Â±0.1
+GenGA 65.94Â±3.6
(â†‘0.1%) 82.15Â±1.9 ( â†‘2.7%) 53.08Â±0.2
(â†‘8.0%) 56.39Â±0.4 ( â†‘12.3%) 95.56Â±0.7
(â†‘4.0%) 95.75Â±2.1 ( â†‘0.1%) 63.22Â±0.1
(â†‘0.2%) 75.86Â±0.8 ( â†‘5.3%) 57.04Â±1.4
(â†‘1.8%) 71.76Â±0.9 ( â†‘2.2%)
+CGenGA 66.90Â±2.0
(â†‘1.5%) 82.10Â±1.5 ( â†‘2.6%) 51.45Â±0.2
(â†‘4.7%) 55.16Â±0.3 ( â†‘9.8%) 92.72Â±0.3
(â†‘0.9%) 95.77Â±0.3 ( â†‘0.1%) 64.50Â±0.4
(â†‘2.2%) 75.56Â±0.7 ( â†‘4.9%) 57.99Â±0.2
(â†‘3.5%) 72.16Â±0.2 ( â†‘2.8%)
AMNet 54.66Â±0.8
64.01Â±1.2 50.39Â±0.1
62.14Â±0.3 91.63Â±0.1
97.11Â±0.1 56.74Â±0.5
65.33Â±0.1 55.63Â±0.1
61.86Â±0.1
+GenGA 64.14Â±1.5
(â†‘17.3%) 81.20Â±0.5 ( â†‘26.9%) 51.22Â±2.6
(â†‘1.7%) 66.93Â±1.6 ( â†‘7.7%) 91.64Â±0.3
(â†‘0.1%) 97.94Â±1.0 ( â†‘0.9%) 58.30Â±1.2
(â†‘2.7%) 74.03Â±2.4 ( â†‘13.3%) 56.32Â±0.3
(â†‘1.2%) 62.92Â±0.2 ( â†‘1.7%)
+CGenGA 64.62Â±1.8
(â†‘18.2%) 80.83Â±0.4 ( â†‘26.3%) 54.01Â±0.4
(â†‘7.2%) 68.59Â±0.6 ( â†‘10.4%) 91.74Â±2.0
(â†‘0.1%) 97.56Â±0.2 ( â†‘0.5%) 60.02Â±1.5
(â†‘5.8%) 75.11Â±1.4 ( â†‘15.0%) 56.27Â±0.1
(â†‘1.2%) 62.89Â±0.1 ( â†‘1.7%)
GHRN 65.59Â±0.1
81.92Â±0.1 45.60Â±0.3
66.09Â±0.4 89.26Â±0.1
91.78Â±0.2 60.56Â±0.5
71.27Â±1.2 56.81Â±0.1
56.14Â±0.1
+GenGA 65.78Â±1.2
(â†‘0.3%) 82.53Â±1.2 ( â†‘0.7%) 48.88Â±0.9
(â†‘7.2%) 70.14Â±1.2 ( â†‘6.1%) 89.90Â±0.1
(â†‘0.7%) 92.52Â±0.2 ( â†‘0.8%) 62.96Â±1.3
(â†‘4.0%) 77.05Â±0.7 ( â†‘8.1%) 57.28Â±0.3
(â†‘0.8%) 56.70Â±0.2 ( â†‘0.1%)
+CGenGA 66.89Â±3.0
(â†‘2.0%) 82.99Â±1.0 ( â†‘1.3%) 47.18Â±3.7
(â†‘3.5%) 70.29Â±1.5 ( â†‘6.4%) 89.81Â±0.1
(â†‘0.6%) 92.32Â±0.2 ( â†‘0.6%) 63.62Â±0.9
(â†‘5.1%) 77.16Â±0.7 ( â†‘8.3%) 57.12Â±0.6
(â†‘0.5%) 57.10Â±0.4 ( â†‘1.7%)
CONAD 47.42Â±0.1
47.50Â±0.2 46.39Â±0.1
55.78Â±0.2 79.01Â±0.1
90.40Â±0.1 46.54Â±0.1
61.24Â±0.1 48.64Â±0.1
50.36Â±0.1
+GenGA 52.68Â±0.1
(â†‘11%) 50.32Â±0.1 ( â†‘5.9%) 49.15Â±0.1
(â†‘5.9%) 57.23Â±0.1 (â†‘2.6%) 82.27Â±0.2
(â†‘4.1%) 91.98Â±0.3 (â†‘1.7%) 47.67Â±0.2
(â†‘2.4%) 63.91Â±0.2 (â†‘4.3%) 52.33Â±0.1
(â†‘7.6%) 51.61Â±0.2 (â†‘2.0%)
+CGenGA 48.16Â±0.3
(â†‘1.6%) 50.23Â±0.2 (â†‘5.7%) 50.95Â±0.2
(â†‘9.8%) 58.62Â±0.3 (â†‘5.1%) 81.93Â±0.1
(â†‘3.7%) 92.69Â±0.2 (â†‘2.5%) 49.99Â±0.3
(â†‘7.4%) 66.56Â±0.1 (â†‘8.6%) 50.15Â±0.3
(â†‘3.1%) 52.32Â±0.2 (â†‘3.4%)
CoLA 45.82Â±0.1
61.60Â±0.1 46.09Â±0.3
50.26Â±0.3 49.90Â±0.2
71.59Â±0.4 50.78Â±0.1
55.45Â±0.1 47.24Â±0.1
56.97Â±0.1
+GenGA 46.14Â±0.2
(â†‘0.7%) 65.42Â±0.1 (â†‘6.2%) 47.04Â±0.1
(â†‘2.1%) 51.53Â±0.1 (â†‘2.5%) 50.91Â±0.3
(â†‘2.0%) 75.95Â±0.1 (â†‘6.1%) 55.22Â±0.2
(â†‘8.7%) 56.82Â±0.2 (â†‘2.4%) 49.61Â±0.1
(â†‘4.9%) 61.94Â±0.1 (â†‘8.7%)
+CGenGA 47.66Â±0.1
(â†‘4.0%) 66.83Â±0.3 (â†‘8.4%) 49.12Â±0.2
(â†‘6.6%) 51.36Â±0.2 (â†‘2.3%) 53.26Â±0.2
(â†‘6.8%) 75.38Â±0.3 (â†‘5.2%) 53.82Â±0.2
(â†‘6.0%) 59.20Â±0.2 (â†‘6.8%) 50.60Â±0.1
(â†‘7.1%) 62.22Â±0.2 (â†‘9.2%)
few labels. We report the 5-fold average performance (in percent-
age) and improvement along with the standard deviation w.r.t. five
commonly-used metrics: Macro-F1, AUC, Macro-Precision, Macro-
Recall and AUCPR [32]. All the experiments on a Rocky Linux
8.6 (Green Obsidian) server equipped with a 12-core CPU, 1 Nvidia
V100 GPU (with 30GB RAM), and 100GB RAM.
6.2 Improvement on Anomaly Detection
Performance (RQ1)
Tables 3, 4, and 5, 8 (in Appendix A) summarize the enhanced per-
formance of the detectors after training with additional synthetic
graphs. The improvements are marked upon the incorporation
of synthetic data generated by GenGA (highlighted in blue) and
CGenGA (highlighted in red). We witness a notable enhancement
in the performance across all detectors on the five organic datasets
and three synthetic datasets. Remarkably, the three conventionalGNN detectors, i.e., GCN, GAT and GraphSAGE experience substan-
tial performance boosts, with all four evaluated metrics showing
increases on all datasets. This significant enhancement underscores
the ability of these GNN detectors to achieve better generalization
in graph anomaly detection after training on our synthetic data
that replicates the original node attribute distributions within the
given graph topology.
The four semi-/supervised graph anomaly detectors also exhibit
different degrees of enhancement ranging from 0.1%to20%over all
metrics while the unsupervised detectorsâ€™ AUC scores have been
raised by more than 4%on average. The gaps among performance
gains of different detectors further indicate that the synthetic data
has a divergent impact on the detectors. We assume this maybe
caused by the varying capabilities of each method in learning the
data distribution and assimilating synthetic information. Overall,
our empirical results on the eight datasets demonstrate that our
 
2159KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
Table 5: Improved performance on five organic datasets w.r.t. Macro-Precision and Macro-Recall.
Metho
dY
elpChi Re
ddit W
eibo T
olokers Questions
Pr
e Rec Pr
e Rec Pr
e Rec Pr
e Rec Pr
e Rec
GCN 42.73Â±0.1
50.00Â±0.1 48.33Â±0.1
50.00Â±0.1 82.83Â±0.1
82.18Â±0.1 60.68Â±0.1
55.87Â±0.1 53.67Â±0.5
52.04Â±0.1
+GenGA 56.35Â±0.5
(â†‘31.9%) 56.08Â±1.9 ( â†‘0.5%) 51.49Â±0.2
(â†‘6.5%) 59.58Â±3.3 ( â†‘19.4%) 89.01Â±2.7
(â†‘8.0%) 92.26Â±0.9 ( â†‘12.3%) 62.16Â±0.7
(â†‘2.1%) 67.73Â±1.1 ( â†‘21.2%) 53.87Â±0.3
(â†‘0.4%) 59.11Â±1.1 (â†‘13.6%)
+CGenGA 54.05Â±0.7
(â†‘26.5%) 57.06Â±0.5 ( â†‘2.3%) 51.63Â±0.1
(â†‘6.8%) 61.57Â±0.2 ( â†‘23.4%) 90.33Â±0.9
(â†‘9.7%) 93.05Â±0.8 ( â†‘13.2%) 62.14Â±0.5
(â†‘2.1%) 67.76Â±0.7 ( â†‘21.3%) 53.70Â±0.2
(â†‘0.0%) 59.18Â±1.3 (â†‘13.7%)
GAT 58.97Â±1.6
50.24Â±0.1 48.33Â±0.1
50.00Â±0.1 88.57Â±0.2
83.22Â±0.1 60.07Â±0.1
55.69Â±0.2 52.92Â±0.1
50.64Â±0.1
+GenGA 60.43Â±2.8
(â†‘2.5%) 67.05Â±5.0 ( â†‘33.5%) 53.59Â±0.2
(â†‘10.9%) 50.05Â±0.1 ( â†‘0.2%) 90.76Â±1.0
(â†‘2.5%) 90.77Â±2.2 ( â†‘9.1%) 63.43Â±0.8
(â†‘5.6%) 68.87Â±1.8 ( â†‘23.7%) 53.56Â±0.1
(â†‘1.2%) 59.31Â±2.4 (â†‘17.1%)
+CGenGA 62.59Â±1.6
(â†‘6.1%) 72.50Â±1.6 ( â†‘44.3%) 51.12Â±0.2
(â†‘5.8%) 52.36Â±0.7 ( â†‘4.8%) 89.41Â±1.1
(â†‘0.9%) 90.97Â±1.3 ( â†‘9.3%) 63.52Â±0.5
(â†‘5.7%) 69.53Â±0.8 ( â†‘24.8%) 53.29Â±0.2
(â†‘0.7%) 60.02Â±0.9 (â†‘18.5%)
GraphSAGE 75.11Â±0.2
58.62Â±0.2 48.33Â±0.1
50.00Â±0.1 90.16Â±0.1
88.43Â±0.2 60.43Â±0.2
55.73Â±0.1 54.44Â±0.1
54.38Â±0.1
+GenGA 65.76Â±0.6
(â†‘2.6%) 75.19Â±1.1 ( â†‘28.3%) 53.19Â±0.1
(â†‘0.6%) 60.12Â±3.0 ( â†‘6.9%) 95.67Â±3.9
(â†‘6.1%) 89.15Â±2.2 ( â†‘0.8%) 62.99Â±0.3
(â†‘11.7%) 68.03Â±1.1 ( â†‘32.3%) 58.96Â±0.9
(â†‘8.3%) 55.32Â±0.4 ( â†‘1.7%)
+CGenGA 65.10Â±1.2
(â†‘1.6%) 75.54Â±0.2 ( â†‘28.9%) 53.78Â±0.3
(â†‘1.7%)) 57.82Â±3.9 ( â†‘2.8%) 91.69Â±1.6
(â†‘1.7%) 89.72Â±2.6 ( â†‘1.5%) 62.96Â±0.6
(â†‘11.7%) 68.67Â±1.0 ( â†‘33.5%) 58.66Â±0.9
(â†‘7.8%) 54.73Â±0.3 ( â†‘0.7%)
BW
GNN 63.30Â±0.1
72.84Â±0.1 51.55Â±0.1
60.47Â±0.1 88.82Â±0.3
89.77Â±0.1 57.29Â±1.1
58.06Â±0.6 56.17Â±0.1
56.82Â±0.1
+GenGA 64.06Â±0.4
(â†‘1.2%) 73.26Â±0.8 ( â†‘0.6%) 52.02Â±0.5
(â†‘0.5%) 63.08Â±2.8 ( â†‘23.7%) 90.62Â±0.2
(â†‘2.0%) 90.61Â±0.2 ( â†‘0.9%) 64.18Â±0.2
(â†‘12.0%) 70.37Â±0.5 ( â†‘21.2%) 56.18Â±0.1
(â†‘0.1%) 57.29Â±0.1 ( â†‘0.8%)
+CGenGA 63.83Â±1.0
(â†‘0.8%) 73.86Â±0.5 ( â†‘1.4%) 52.05Â±0.2
(â†‘0.6%) 64.50Â±0.9 ( â†‘26.5%) 89.96Â±0.1
(â†‘1.3%) 90.31Â±0.2 ( â†‘0.6%) 63.84Â±0.3
(â†‘11.4%) 69.85Â±0.5 ( â†‘20.3%) 57.58Â±0.2
(â†‘2.5%) 58.97Â±0.1 ( â†‘3.8%)
GAT-sep 72.10Â±0.1
63.74Â±0.4 48.33Â±0.1
50.01Â±0.1 85.95Â±0.2
93.98Â±0.1 60.56Â±0.4
63.14Â±0.7 55.19Â±0.3
57.37Â±0.1
+GenGA 74.79Â±2.3
(â†‘3.7%) 73.51Â±1.6 ( â†‘15.3%) 57.59Â±0.2
(â†‘19.2%) 51.86Â±0.2 ( â†‘3.7%) 89.18Â±1.8
(â†‘3.8%) 94.09Â±0.1 ( â†‘0.1%) 63.10Â±0.5
(â†‘4.2%) 68.37Â±1.6 ( â†‘8.3%) 57.33Â±0.4
(â†‘3.9%) 60.46Â±0.7 ( â†‘5.4%)
+CGenGA 73.53Â±1.0
(â†‘2.0%) 73.96Â±1.2 ( â†‘16.0%) 58.64Â±0.2
(â†‘21.3%) 52.20Â±0.2 ( â†‘4.4%) 89.66Â±0.9
(â†‘4.3%) 94.83Â±0.1 ( â†‘0.9%) 62.96Â±0.4
(â†‘4.0%) 68.19Â±1.1 ( â†‘8.0%) 57.09Â±0.2
(â†‘3.5%) 61.01Â±0.7 ( â†‘6.3%)
AMNet 55.68Â±1.3
55.51Â±0.6 50.94Â±0.2
50.82Â±0.1 86.86Â±0.7
89.56Â±0.2 57.03Â±0.1
57.89Â±0.2 55.67Â±0.1
56.86Â±0.1
+GenGA 63.52Â±0.9
(â†‘14.1%) 73.48Â±0.6 ( â†‘32.4%) 51.91Â±0.3
(â†‘1.9%) 61.21Â±0.7 ( â†‘20.4%) 88.23Â±0.4
(â†‘1.6%) 90.23Â±0.1 ( â†‘0.7%) 62.39Â±1.7
(â†‘9.4%) 68.06Â±2.5 ( â†‘17.6%) 56.28Â±0.3
(â†‘1.1%) 57.59Â±0.9 ( â†‘1.3%)
+CGenGA 63.73Â±1.0
(â†‘14.5%) 72.96Â±0.6 ( â†‘31.4%) 52.03Â±0.3
(â†‘2.1%) 63.77Â±1.1 ( â†‘25.5%) 87.89Â±0.3
(â†‘1.2%) 90.85Â±0.7 ( â†‘1.4%) 63.03Â±0.7
(â†‘10.5%) 69.01Â±1.0 ( â†‘19.2%) 58.67Â±0.1
(â†‘5.4%) 57.55Â±0.7 ( â†‘1.2%)
GHRN 64.28Â±0.1
74.14Â±0.3 51.57Â±0.1
59.79Â±0.3 89.11Â±0.1
89.43Â±0.1 61.78Â±0.1
59.86Â±0.5 56.44Â±0.1
57.32Â±0.1
+GenGA 64.73Â±0.8
(â†‘0.7%) 74.98Â±1.1 ( â†‘1.1%) 52.22Â±0.7
(â†‘1.3%) 63.06Â±1.9 ( â†‘5.5%) 89.53Â±0.1
(â†‘0.5%) 0.43Â±0.1 ( â†‘1.1%) 63.69Â±0.2
(â†‘3.1%) 69.19Â±0.9 ( â†‘15.6%) 57.41Â±0.1
(â†‘1.7%) 58.72Â±0.1 ( â†‘2.4%)
+CGenGA 65.44Â±1.6
(â†‘1.8%) 75.19Â±0.9 ( â†‘1.4%) 51.99Â±0.3
(â†‘0.8%) 63.45Â±1.8 ( â†‘6.1%) 89.82Â±0.1
(â†‘0.8%) 90.95Â±0.1 ( â†‘1.7%) 63.83Â±0.4
(â†‘3.3%) 69.24Â±0.6 ( â†‘15.7%) 56.73Â±0.6
(â†‘0.5%) 57.60Â±0.7 ( â†‘0.5%)
CONAD 47.35Â±0.1
45.51Â±0.1 49.58Â±0.1
48.02Â±0.1 74.91Â±0.1
88.25Â±0.1 46.37Â±0.1
47.13Â±0.5 50.54Â±0.1
52.37Â±0.1
+GenGA 51.49Â±0.3
(â†‘8.7%) 49.356Â±2.8 (â†‘8.5%) 53.37Â±0.1
(â†‘7.6%) 50.19Â±1.7 (â†‘4.5%) 78.39Â±0.2
(â†‘4.6%) 97.05Â±1.4 (â†‘10.0%) 50.31Â±0.3
(â†‘8.5%) 51.60Â±1.8 (â†‘9.5%) 53.18Â±0.2
(â†‘5.2%) 53.64Â±2.1 (â†‘2.4%)
+CGenGA 51.68Â±0.2
(â†‘9.1%) 48.76Â±2.7 (â†‘7.1%) 51.01Â±0.1
(â†‘2.9%) 48.90Â±1.9 (â†‘1.8%) 76.84Â±0.2
(â†‘2.6%) 89.83Â±2.3 (â†‘1.8%) 49.22Â±0.1
(â†‘6.1%) 49.91Â±1.4 (â†‘5.9%) 52.36Â±0.2
(â†‘3.6%) 57.63Â±1.1 (â†‘9.3%)
CoLA 46.26Â±0.1
45.54Â±0.1 49.48Â±0.1
50.43Â±0.2 50.53Â±0.1
50.80Â±0.2 51.10Â±0.1
50.91Â±0.1 50.42Â±0.1
52.28Â±0.1
+GenGA 49.52Â±0.2
(â†‘7.0%) 48.22Â±1.3 (â†‘6.0%) 51.11Â±0.1
(â†‘3.3%) 53.52Â±2.5 (â†‘6.1%) 53.33Â±0.2
(â†‘5.5%) 51.87Â±0.2 (â†‘2.1%) 53.67Â±0.2
(â†‘5.0%) 55.77Â±0.1 (â†‘9.5%) 55.21Â±0.3
(â†‘9.5%) 56.07Â±0.2 (â†‘7.2%)
+CGenGA 48.10Â±0.2
(â†‘4.0%) 48.62Â±0.2 (â†‘6.8%) 50.50Â±0.3
(â†‘2.1%) 53.48Â±0.2 (â†‘6.0%) 55.36Â±0.2
(â†‘9.5%) 53.75Â±0.1 (â†‘5.8%) 52.28Â±0.2
(â†‘2.3%) 55.23Â±0.3 (â†‘8.5%) 51.60Â±0.3
(â†‘2.3%) 57.36Â±0.2 (â†‘9.7%)
Metho
d Y
elpChi Reddit Weibo Tolokers
V
GAE 9.1129
2.7658 8.3161 9.6088
GenGA 1.2079
1.0430 0.9955 4.6133
CGenGA 1.1982
1.0401 0.9941 4.5289
Questions
BlogCatalog ACM Cora
V
GAE 3.5756
2.5432 0.3545 0.8824
GenGA 0.7821
1.7785 0.3103 0.7026
CGenGA 0.7805
1.7759 0.3009 0.7002
Table 6: FID on eight datasets.
F1AUCPreRec50607080GCNGenGA w/o RGenGAFigure 4: Ablation results
on Cora.
generated graphs effectively boost the existing detectors, affirm-
ing the efficacy of our data-centric approach for graph anomaly
detection with few labels.
6.3 The Impact of Classifier Guidance on Graph
Generation (RQ2)
ForRQ2, we analyze the impact of classifier guidance from two
perspectives that follow.
6.3.1 The impact of classifier guidance on detection performance.
We first compare the performance gains between GenGA and
CGenGA to investigate the implicit impact of classifier guidance
on graph generation. From the results in the four tables, we can see
that the class information derived from our pre-trained GCN clas-
sifier could further boost the detection performance on particular
datasets. However, the overall performance gains using CGenGA
are nearly identical to GenGA. We think this might be caused for
two main reasons: 1) Although the classifier guidance could incor-
porate label information for graph generation, this implicitly limits
the diversity of the generated node features under the constraint of
known labels; 2) The pre-trained classifierâ€™s capacity also impacts
the derived information ğ‘”(in Eq. (18)) for shifting the mean value
of the generated features. In contrast to the classifier guided image
generation [ 5], where the ResNet [ 14] could predict the different
class labels accurately, we expect better graph anomaly detectors
to further enhance the classifier guided generation process, which
is an important direction worth exploration.6.3.2 The impact of classifier guidance on the generated graph qual-
ity.In addition to the comparisons on the detection performance,
we further quantify the quality of our generated graphs with regard
to the FrÃ©chet Inception Distance (FID) score [ 15], which is a widely-
used measurement on the similarity between the distributions of
real and synthetic data following:
FID=||ğâˆ’ğâ€²||2
2+Tr(Î£+Î£â€²âˆ’2(Î£Î£â€²)1/2), (20)
where ğandğâ€²are the mean values of the original and generated
features, respectively. Î£andÎ£â€²are the corresponding covariances.
Intuitively, a lower FID score indicates a higher similarity and
signifies better quality of the generated data. From the results in
Table 6, we see that the classifier guidance can improve the FID on
all datasets, albeit marginally. Similar to our prior analysis on the
detection performance, we attribute this to the weak information
provided by the classifier, which deserves further investigations.
6.4 Ablation Study on the Residual Link (RQ3)
As presented in Sec. 5.3, we propose the residual link between Sdn
andDen to alleviate the oversmoothing of node representations
during message-passing. To validate its effectiveness, we conduct
an ablation study on the residual link by comparing GCNâ€™s perfor-
mance improvement using synthetic graphs generated by GenGA
and the variant without such residual link, namely GenGA w/o
Ron Cora dataset. As illustrated in Fig. 4, the graph generated by
GenGA (with the residual link) outperforms GenGA w/o R w.r.t. all
metrics affirming the efficacy of the residual link.
6.5 The Impact of ğœ†(RQ3)
The hyperparameter ğœ†in Eq. (18) scales the classifier gradients.
The mean value of the generated data shifts more with a larger
ğœ†and vice versa. Due to its explicit impact on the generated data
distribution, we measure the FID scores by varying ğœ†from 0.2to2.0
and the results on Cora and Weibo datasets are depicted in Fig. 5.
The increasing FID on Cora indicates that the more classifier signal
 
2160Graph Anomaly Detection with Few Labels:
A Data-Centric Approach KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
0.20.40.60.81.01.21.41.61.82.00.7000.7050.7100.7150.7200.725FID
(a)ğœ†v.s. FID on Cora
0.20.40.60.81.01.21.41.61.82.00.9930.9940.9950.9960.997FID (b)ğœ†v.s. FID on Weibo
Figure 5: The impact of ğœ†on FID.
246810607080
#Generated GraphsF1AUC
(a) Cora
246810455055606570
#Generated GraphsF1AUC (b) Reddit
24681080859095100
#Generated GraphsF1AUC
(c) Weibo
246810455565
#Generated GraphsF1AUC (d) YelpChi
Figure 6: Results with different number of generated graphs.
shifts the generated data far from the original distribution, while
the results on Weibo underscore that increasing ğœ†could reduce FID.
By comparing the detection performance of the original GCN on the
two datasets, we observe that GCN performs better on Weibo than
Cora. This implicitly showcases that the GCN classifier captures
the distribution of Weibo better than Cora, which causes the FID
differences on these two datasets.
6.6 The Impact of Noise Scheduler (RQ4)
The noise scheduler determines the amount of noise been added to
Xduring the forward diffusion process. In this study, we investigate
the impact of two mostly-used noise schedulers in DDPMs [ 16,34],
i.e., linear and cosine schedulers, on the graph anomaly detection
performance and depict the results on four datasets in Fig. 7. Specif-
ically, we train GenGA with both schedulers and further use the
generated graphs to train a GCN classifier. We can see that the
cosine scheduler performs slightly better than the linear scheduler
in most cases, except Reddit w.r.t. F1.
6.7 Performance with More Synthetic Graphs
(RQ5)
ForRQ5, we explore whether the detectorâ€™s performance can be
further improved by utilizing more generated graphs for training.
The results on four datasets (in Fig. 6) illustrate that increasing
the number of generated graphs brings limited benefit to or may
even deteriorate (on Cora and Weibo) the detection performance.
CoraRedditWeiboYelpChi406080100F1 (%)Cosine SchedulerLinear Scheduler(a) F1 with different schedulers
CoraRedditWeiboYelpChi406080100AUC (%)Cosine SchedulerLinear Scheduler (b) AUC with different schedulers
Figure 7: The impact of noise schedulers on FID.
Table 7: Sampling time on all datasets (in seconds)
Dataset Y
elpChi Reddit Weibo Tolokers Questions BlogCatalog ACM Cora
GenGA 7.98
7.30 23.27 14.44 14.78 143.55 85.06 4.59
CGenGA 22.93
15.02 33.03 25.75 32.20 154.15 110.59 8.09
To our knowledge, we attribute this to the limited diversity of the
generated graphs, and generating more diversified samples will be
a pivotal focus of our future research.
6.8 Time cost (RQ6)
We also report the average clock time (in seconds) of generating
one graph in Table 7. From the results, we can see that GenGAâ€™s
sampling speed is faster than CGenGA since it involves no classifier
signal for generation, while both methods can generate a reusable
graph to enhance various existing detectors fast and in the worst
case, a graph can be generated within 160seconds.
7 CONCLUSION
Graph anomaly detection has witnessed great achievement for the
development of graph machine learning, but the existing works
mainly focus on more powerful detection models, leaving the lack
of data and the induced data-specific challenges as a prerequisite.
In contrast to the existing works, we propose a novel data-centric
approach to mitigate the rareness of training data in the realm of
graph anomaly detection. Through empirical and rigorous analysis
on the forward graph diffusion process, we identify two principles
for designing the denoising neural network for graph generation,
and propose GenGA andCGenGA to synthesize additional graphs.
Our extensive experiments on eight widely-used datasets showcase
that the state-of-the-art detectorsâ€™ performance can be further im-
proved with our generated graphs, which demonstrate the potential
of our data-centric approach.
Limitations and Future Works: From the case studies on the
seven research questions, we unveil potential improvement of our
model design and pinpoint future works in this direction: 1) in-
volving more effective classifier guidance for graph generation;
2) improve the sampling speed/reduce steps for sampling; and 3)
improving the diversity of the generated graphs.
ACKNOWLEDGEMENTS
This work was supported by the Australian Research Council Projects
LP210301259 and DP230100899, and Macquarie University Data
Horizons Research Centre.
 
2161KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
REFERENCES
[1]Leman Akoglu. 2021. Anomaly mining: Past, present and future. In CIKM. 1â€“2.
[2]Leman. Akoglu, Hanghang. Tong, and Danai Koutra. 2015. Graph based anomaly
detection and description: A survey. Data Min. Knowl. Disc. 29 (2015), 626â€“688.
[3]Sambaran Bandyopadhyay, Lokesh N, Saley Vishal Vivek, and M. N. Murty.
2020. Outlier resistant unsupervised deep architectures for attributed network
embedding. In WSDM. 25â€“33.
[4]Ziwei Chai, Siqi You, Yang Yang, Shiliang Pu, Jiarong Xu, Haoyang Cai, and
Weihao Jiang. 2022. Can abnormality be detected by graph neural networks?. In
IJCAI. 1945â€“1951.
[5]Prafulla Dhariwal and Alexander Nichol. 2021. Diffusion models beat GANs on
image synthesis. In NeurIPS. 8780â€“8794.
[6]Kaize Ding, Jundong Li, Rohit Bhanushali, and Huan Liu. 2019. Deep anomaly
detection on attributed networks. In SDM. 594â€“602.
[7]Yingtong Dou, Zhiwei Liu, Li Sun, Yutong Deng, Hao Peng, and Philip S Yu. 2020.
Enhancing graph neural network-based fraud detectors against camouflaged
fraudsters. In CIKM. 315â€“324.
[8]Yuan Gao, Xiang Wang, Xiangnan He, Zhenguang Liu, Huamin Feng, and Yong-
dong Zhang. 2023. Addressing heterophily in graph anomaly detection: A per-
spective of graph spectrum. In WWW. 1528â€“1538.
[9]Yuan Gao, Xiang Wang, Xiangnan He, Zhenguang Liu, Huamin Feng, and Yong-
dong Zhang. 2023. Alleviating structural distribution shift in graph anomaly
detection. In WSDM. 357â€“365.
[10] Dmitrii Gavrilev and Evgeny Burnaev. 2023. Anomaly detection in networks via
score-based generative models. In ICML 2023 Workshop on Structured Probabilistic
Inference &Generative Modeling.
[11] Frank E Grubbs. 1969. Procedures for detecting outlying observations in samples.
Technometrics 11, 1 (1969), 1â€“21.
[12] William L. Hamilton, Rex Ying, and Jure Leskovec. 2017. Inductive representation
learning on large graphs. In NeurIPS. 1025â€“1035.
[13] Lasse Hansen, Nabeel Seedat, Mihaela van der Schaar, and Andrija Petrovic.
2023. Reimagining synthetic tabular data generation through data-centric AI: A
comprehensive benchmark. In NeurIPS.
[14] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016. Deep residual
learning for image recognition. In CVPR. 770â€“778.
[15] Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and
Sepp Hochreiter. 2017. GANs trained by a two time-scale update rule converge
to a local Nash Equilibrium. In NeurIPS, Vol. 30.
[16] Jonathan Ho, Ajay Jain, and Pieter Abbeel. 2020. Denoising diffusion probabilistic
models. In NeurIPS. 6840â€“6851.
[17] Han Huang, Leilei Sun, Bowen Du, Yanjie Fu, and Weifeng Lv. 2022. GraphGDP:
Generative diffusion processes for permutation invariant graph generation. In
ICDM. 201â€“210.
[18] Abhinav Jain, Hima Patel, Lokesh Nagalapatti, Nitin Gupta, Sameep Mehta,
Shanmukha Guttula, Shashank Mujumdar, Shazia Afzal, Ruhi Sharma Mittal, and
Vitobha Munigala. 2020. Overview and importance of data quality for machine
learning tasks. In KDD. 3561â€“3562.
[19] Bowen Jing, Gabriele Corso, Regina Barzilay, and Tommi S Jaakkola. 2022. Tor-
sional diffusion for molecular conformer generation. In NeurIPS. 24240â€“24253.
[20] Jaehyeong Jo, Dongki Kim, and Sung Ju Hwang. 2023. Graph generation with
destination-driven diffusion mixture. In Machine Learning for Drug Discovery
workshop, ICLR.
[21] Nicolas Keriven. 2022. Not too little, not too much: A theoretical analysis of
graph (over)smoothing. In NeurIPS. 2268â€“2281.
[22] Diederik P Kingma and Max Welling. 2014. Auto-encoding variational bayes. In
ICLR.
[23] Thomas N Kipf and Max Welling. 2016. Variational graph auto-encoders. In
NeurIPS Workshop on Bayesian Deep Learning.
[24] Thomas N. Kipf and Max Welling. 2017. Semi-supervised classification with
graph convolutional networks. In ICLR.
[25] Jundong Li, Harsh Dani, Xia Hu, and Huan Liu. 2017. Radar: Residual analysis
for anomaly detection in attributed networks.. In IJCAI. 2152â€“2158.
[26] Fanzhen Liu, Xiaoxiao Ma, Jia Wu, Jian Yang, Shan Xue, Amin Behesht, Chuan
Zhou, Hao Peng, Quan Z. Sheng, and Charu C. Aggarwal. 2022. DAGAD: Data
augmentation for graph anomaly detection. In ICDM. 259â€“268.
[27] Kay Liu, Yingtong Dou, Yue Zhao, Xueying Ding, Xiyang Hu, Ruitong Zhang,
Kaize Ding, Canyu Chen, Hao Peng, Kai Shu, et al .2022. BOND: Benchmarking
unsupervised outlier node detection on static attributed graphs. In NeurIPS.
27021â€“27035.
[28] Yixin Liu, Zhao Li, Shirui Pan, Chen Gong, Chuan Zhou, and George Karypis.
2021. Anomaly detection on attributed networks via contrastive self-supervised
learning. IEEE Trans. Neural Netw. Learn. Syst. 33, 6 (2021), 2378â€“2392.[29] Ziqi Liu, Chaochao Chen, Longfei Li, Jun Zhou, Xiaolong Li, Le Song, and Yuan
Qi. 2019. GeniePath: Graph neural networks with adaptive receptive paths. In
AAAI. 4424â€“4431.
[30] Yingzhou Lu, Huazheng Wang, and Wenqi Wei. 2023. Machine learning for
synthetic data generation: A review. arXiv preprint arXiv:2302.04062 (2023).
[31] Calvin Luo. 2022. Understanding diffusion models: A unified perspective. arXiv
preprint arXiv:2208.11970 (2022).
[32] Xiaoxiao Ma, Jia Wu, Shan Xue, Jian Yang, Chuan Zhou, Quan Z. Sheng, Hui
Xiong, and Leman Akoglu. 2021. A comprehensive survey on graph anomaly
detection with deep learning. IEEE Trans. Knowl. Data Eng. (2021).
[33] Xiaoxiao Ma, Jia Wu, Jian Yang, and Quan Z. Sheng. 2023. Towards graph-level
anomaly detection via deep evolutionary mapping. In KDD. 1631â€“1642.
[34] Alexander Quinn Nichol and Prafulla Dhariwal. 2021. Improved denoising diffu-
sion probabilistic models. In ICML. 8162â€“8171.
[35] Joonhyung Park, Jaeyun Song, and Eunho Yang. 2021. GraphENS: Neighbor-
aware ego network synthesis for class-imbalanced node classification. In ICLR.
[36] Zhen Peng, Minnan Luo, Jundong Li, Huan Liu, and Qinghua Zheng. 2018.
ANOMALOUS: A joint modeling approach for anomaly detection on attributed
networks. In IJCAI. 3513â€“3519.
[37] Shebuti Rayana and Leman Akoglu. 2015. Collective opinion spam detection:
Bridging review networks and metadata. In KDD. 985â€“994.
[38] Cedric Renggli, Luka Rimanic, Nezihe Merve GÃ¼rel, Bojan KarlaÅ¡, Wentao Wu,
and Ce Zhang. 2021. A data quality-driven view of MLOps. IEEE Data Eng. Bull.
44, 1 (2021), 11â€“23.
[39] Nabeel Seedat, Jonathan CrabbÃ©, Zhaozhi Qian, and Mihaela van der Schaar. 2023.
TRIAGE: Characterizing and auditing training data for improved regression. In
NeurIPS.
[40] Yang Song and Stefano Ermon. 2019. Generative modeling by estimating gradients
of the data distribution. In NeurIPS.
[41] Jianheng Tang, Fengrui Hua, Ziqi Gao, Peilin Zhao, and Jia Li. 2023. GADBench:
Revisiting and Benchmarking Supervised Graph Anomaly Detection. In NeurIPS.
[42] Jianheng Tang, Jiajin Li, Ziqi Gao, and Jia Li. 2022. Rethinking graph neural
networks for anomaly detection. In ICML. 21076â€“21089.
[43] Jie Tang, Jing Zhang, Limin Yao, Juanzi Li, Li Zhang, and Zhong Su. 2008. Arnet-
Miner: Extraction and mining of academic social networks. In KDD. 990â€“998.
[44] Petar VeliÄkoviÄ‡, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro
LiÃ², and Yoshua Bengio. 2018. Graph attention networks. In ICLR.
[45] Jianyu Wang, Rui Wen, Chunming Wu, Yu Huang, and Jian Xiong. 2019. FdGars:
Fraudster detection via graph convolutional networks in online app review
system. In WWW. 310â€“316.
[46] Yanling Wang, Jing Zhang, Shasha Guo, Hongzhi Yin, Cuiping Li, and Hong
Chen. 2021. Decoupling representation learning and classification for GNN-
based anomaly detection. In SIGIR. 1239â€“1248.
[47] Yuchen Wang, Jinghui Zhang, Zhengjie Huang, Weibin Li, Shikun Feng, Ziheng
Ma, Yu Sun, Dianhai Yu, Fang Dong, Jiahui Jin, et al .2023. Label information
enhanced fraud detection against low homophily in graphs. In WWW. 406â€“416.
[48] Felix Wu, Amauri Souza, Tianyi Zhang, Christopher Fifty, Tao Yu, and Kilian
Weinberger. 2019. Simplifying graph convolutional networks. In ICML. 6861â€“
6871.
[49] Jiehui Xu, Haixu Wu, Jianmin Wang, and Mingsheng Long. 2022. Anomaly
transformer: Time series anomaly detection with association discrepancy. In
ICLR.
[50] Zhiming Xu, Xiao Huang, Yue Zhao, Yushun Dong, and Jundong Li. 2022. Con-
trastive attributed network anomaly detection with data augmentation. In PAKDD.
444â€“457.
[51] Ling Yang, Zhilong Zhang, Yang Song, Shenda Hong, Runsheng Xu, Yue Zhao,
Wentao Zhang, Bin Cui, and Ming-Hsuan Yang. 2023. Diffusion models: A
comprehensive survey of methods and applications. ACM Comput. Surv. 56, 4
(2023), 1â€“39.
[52] Yuchen Zhang, Xiaoxiao Ma, Jia Wu, Jian Yang, and Hao Fan. 2024. Heterogeneous
subgraph transformer for fake news detection. In WWW. 1272â€“1282.
[53] Tong Zhao, Chuchen Deng, Kaifeng Yu, Tianwen Jiang, Daheng Wang, and Meng
Jiang. 2020. Error-bounded graph anomaly loss for GNNs. In CIKM. 1873â€“1882.
[54] Tianxiang Zhao, Xiang Zhang, and Suhang Wang. 2021. GraphSMOTE: Im-
balanced node classification on graphs with graph neural networks. In WSDM.
833â€“841.
[55] Yu Zheng, Ming Jin, Yixin Liu, Lianhua Chi, Khoa T Phan, and Yi-Ping Phoebe
Chen. 2021. Generative and contrastive self-supervised learning for graph anom-
aly detection. IEEE Trans. Knowl. Data Eng. (2021).
[56] Jiong Zhu, Yujun Yan, Lingxiao Zhao, Mark Heimann, Leman Akoglu, and Danai
Koutra. 2020. Beyond homophily in graph neural networks: Current limitations
and effective designs. In NeurIPS. 7793â€“7804.
 
2162Graph Anomaly Detection with Few Labels:
A Data-Centric Approach KDD â€™24, August 25â€“29, 2024, Barcelona, Spain
A EXPERIMENT DETAILS AND ADDITIONAL
RESULTS
A.1 Datasets
The eight graph anomaly detection datasets can be categorized
into two groups: one with organic anomalies and the others with
injected anomalies.
Organic datasets. All the organic datasets contain real anom-
alies that appear in different applications including online reviews,
crowdsourcing and question-answering platforms.
YelpChi [37] is an online review dataset with spam and legitimate
reviews of hotels and restaurants. All reviews are labeled by Yelp.
There are three types of relations in this dataset and for a fair
comparison, we test each baseline on all these relations and report
the best performance. Table 2 reports the total number of edges.
Reddit [46] compromises collected posts from subreddit. The ground-
truth anomalies are banned users from Reddit.
Weibo [53] is collected from the Tencent-Weibo platform. The
ground-truth anomalies are users who have engaged in more than
five suspicious events.
Tolokers [41] is collected from the Toloka crowdsourcing platform.
In this dataset, anomalies denote workers who have been banned
in at least one project.
Questions [41] is from the Yandex Q website. Users of this question-
answering website are denoted as nodes and an edge is built be-
tween two users if one userâ€™s question has been answered by an-
other. Anomalies are users that are no longer active after August
2022.
Synthetic datasets. These three synthetic datasets are down-
loaded from site5.
BlogCatalog [6] is collected from an online blog sharing network.
The edges denote the follower-followee relations among users and
tags associated with users are node attributes.
ACM [43] is built based on the ACM scientific citation network,
in which publications are represented as nodes and their citation
relations are represented as edges.
Cora [27] is another scientific citation network containing publica-
tions and their citation links.
5https://github.com/pygod-team/dataA.2 Baseline Implementations
A.2.1 Conventional GNN-based detectors. We have implemented
theGCN6[24],GAT7[44], and GraphSAGE8[12] detectors based
on their original settings. Specifically, each of them stacks a fully
connected layer above two GNN layers. The difference is that the
GCN detector investigates the graph convolutional neural network
layers, the GAT detector adopts the graph attention neural network
layers, and the GraphSAGE detector applies the GraphSAGE layers.
In our experiment, we follow CGenGAâ€™s configurations and set
their GNN layersâ€™ dimensions as 256and128, respectively. We apply
ReLU as the activation function for these three detectors and set
the number of training iterations to 200.
A.2.2 State-of-the-art methods. We use the published implemen-
tations and configurations of BWGNN9[42],GAT-sep [56],AM-
Net[4],GHRN10[8],CONAD11[50] and CoLA11[28].
A.3 Additional Results
A.3.1 Overall detection performance. Due to space limitations, in
addition to the results presented in Tables 3, 4, and 5, we report the
detection performance w.r.t. AUCPR in Table 8. All the tables can
be found on the following page, and results affirm the superiority
of our methods.
A.3.2 Comparison with other augmentation methods (RQ7). As to
validate the effectiveness of our generative approach and choice
of using the DDPM framework for graph generation, we compare
GenGA with VGAE and GraphENS and report the results in Table 9.
We can see that the generative methods, i.e., GenGA and VGAE
better boost the GCN, GAT and GraphSAGE detectors on four
representative datasets, while GenGA generates more effective
data samples than VGAE.
6https://github.com/tkipf/gcn
7https://github.com/PetarV-/GAT
8https://github.com/williamleif/GraphSAGE
9https://github.com/squareRoot3/Rethinking-Anomaly-Detection
10https://github.com/squareRoot3/GADBench
11https://github.com/pygod-team/pygod
 
2163KDD â€™24, August 25â€“29, 2024, Barcelona, Spain Xiaoxiao Ma et al.
Table 8: Improved performance on five organic datasets w.r.t. AUCPR.
Metho
d Y
elpChi Re
ddit W
eibo T
olokers Questions Cora BlogCatalog A
CM
GCN 21.21Â±0.8 4.48Â±1.1 92.09Â±1.6 42.04Â±2.9 10.14Â±2.5 38.94Â±6.2 66.91Â±5.7 39.35Â±4.0
+GenGA 25.18Â±1.4 23.24Â±3.6 93.04Â±0.8 44.31Â±0.8 25.65Â±0.6 42.21Â±8.1 68.89Â±1.6 40.89Â±3.2
+CGenGA 26.31Â±1.4 24.65Â±2.3 94.31Â±1.3 43.15Â±2.3 26.03Â±1.2 40.87Â±8.7 68.41Â±0.9 40.73Â±1.1
GA
T 41.32Â±4.1 5.83Â±0.5 92.65Â±1.9 46.19Â±4.8 9.63Â±1.5 29.25Â±4.2 42.04Â±3.7 42.24Â±7.1
+GenGA 41.96Â±0.6 42.18Â±1.2 93.28Â±0.5 79.35Â±1.7 41.82Â±1.2 29.52Â±1.2 44.77Â±1.9 52.06Â±1.2
+CGenGA 44.52Â±0.2 42.33Â±0.2 93.19Â±0.1 83.22Â±1.9 42.25Â±1.7 30.54Â±0.8 46.69Â±1.8 55.89Â±1.4
GraphSA
GE 53.61Â±3.2 6.07Â±0.7 89.27Â±2.3 49.02Â±1.7 12.19Â±3.2 52.04Â±7.9 67.60Â±8.8 57.81Â±3.0
+GenGA 56.00Â±0.9 55.05Â±1.7 92.29Â±1.9 54.70Â±1.7 53.56Â±0.9 55.47Â±1.7 71.45Â±0.3 60.04Â±1.1
+CGenGA 61.25Â±0.1 55.28Â±0.5 90.18Â±1.5 56.87Â±0.5 54.56Â±1.5 57.54Â±1.6 76.83Â±1.7 61.02Â±0.9
BW
GNN 54.60Â±3.7 5.79Â±1.6 89.94Â±1.5 48.57Â±3.6 12.95Â±1.2 7.33Â±1.9 13.97Â±2.9 17.13Â±3.7
+GenGA 58.85Â±0.5 57.69Â±1.1 90.13Â±1.3 57.68Â±0.5 58.71Â±0.7 12.50Â±0.6 26.55Â±1.2 19.39Â±0.6
+CGenGA 59.59Â±1.6 58.25Â±0.1 89.58Â±1.9 57.93Â±0.3 58.81Â±0.4 12.61Â±1.3 27.76Â±0.7 20.46Â±1.4
GA
T-sep 49.21Â±8.0 6.55Â±0.5 92.01Â±1.1 49.57Â±2.7 9.65Â±0.7 14.65Â±3.0 31.19Â±6.9 22.80Â±4.1
+GenGA 53.24Â±1.1 49.61Â±1.7 92.89Â±0.4 50.12Â±1.6 52.84Â±1.6 21.63Â±1.2 31.48Â±1.6 32.78Â±0.9
+CGenGA 53.93Â±0.6 49.81Â±0.5 93.97Â±0.5 54.48Â±1.7 52.93Â±1.1 23.05Â±0.7 31.78Â±0.7 34.98Â±0.9
AMNet 45.77Â±5.4 5.98Â±0.9 92.98Â±2.2 43.73Â±1.3 10.64Â±1.8 10.96Â±1.6 22.09Â±3.6 15.34Â±1.8
+GenGA 47.51Â±1.0 47.77Â±1.6 93.02Â±0.8 47.54Â±1.7 48.54Â±0.8 17.48Â±0.4 27.65Â±1.3 20.57Â±0.5
+CGenGA 51.14Â±0.2 48.14Â±0.9 93.31Â±1.4 51.32Â±0.4 49.54Â±1.4 17.64Â±0.6 29.47Â±1.7 20.98Â±1.8
GHRN 50.96Â±2.2 5.98Â±1.5 92.59Â±1.0 49.83Â±1.9 13.47Â±2.0 10.65Â±3.5 17.22Â±4.5 9.82Â±1.3
+GenGA 57.12Â±1.5 58.07Â±0.6 92.65Â±1.3 57.77Â±0.7 57.48Â±1.1 12.63Â±1.3 34.01Â±0.8 10.17Â±0.3
+CGenGA 58.73Â±1.6 58.22Â±1.5 90.35Â±0.3 61.75Â±0.6 57.74Â±1.1 13.05Â±1.6 35.31Â±0.4 10.97Â±0.5
CoLA 11.18Â±0.9 3.38Â±0.5 12.35Â±0.1 21.26Â±0.8 2.98Â±0.9 6.54Â±0.5 11.02Â±0.1 4.53Â±0.6
+GenGA 12.02Â±1.0 3.46Â±0.7 19.17Â±0.3 23.80Â±0.9 3.54Â±0.5 7.13Â±0.8 14.66Â±0.4 4.74Â±0.7
+CGenGA 11.72Â±0.9 3.44Â±0.5 12.82Â±0.3 23.25Â±0.9 3.04Â±0.9 7.55Â±0.5 12.80Â±0.9 4.78Â±0.3
Table 9: Comparison with VGAE and GraphENS on four datasets for enhancing GCN, GAT and GraphSAGE.
Metho
dBlogCatalog Cora
F1
AUC Pre Rec AUCPR F1
AUC Pre Rec AUCPR
GCN
+GenGA 76.24Â±0.2
77.55Â±0.5 87.88Â±0.6 74.95Â±0.3 68.89Â±1.6 69.28Â±0.2
74.05Â±0.2 68.66Â±0.2 71.08Â±0.2 42.21Â±8.1
+ VGAE 75.96Â±3.6
69.03Â±2.2 75.58Â±4.8 64.67Â±2.9 67.84Â±6.8 68.23Â±3.1
70.17Â±4.1 64.81Â±2.5 70.69Â±4.8 36.38Â±8.6
+ GraphENS 51.87Â±2.0
54.11Â±8.8 52.56Â±2.4 52.22Â±1.4 7.77Â±4.1 48.98Â±8.1
52.33Â±5.2 51.90Â±7.1 50.28Â±3.8 6.57Â±7.2
GAT
+GenGA 65.73Â±1.8
72.47Â±0.6 77.65Â±1.6 73.80Â±3.2 44.77Â±1.9 63.35Â±1.5
70.05Â±0.6 67.76Â±1.5 71.55Â±3.9 29.52Â±1.3
+ VGAE 62.08Â±3.1
68.35Â±1.1 75.22Â±3.2 68.98Â±4.1 34.33Â±4.7 60.24Â±0.8
67.01Â±5.5 65.31Â±1.9 69.21Â±3.6 20.69Â±2.9
+ GraphENS 51.24Â±1.6
46.44Â±1.1 53.27Â±6.1 51.57Â±7.1 7.93Â±7.8 47.67Â±2.0
55.25Â±6.3 52.37Â±2.7 51.86Â±2.3 7.37Â±3.9
GraphSAGE
+GenGA 70.43Â±2.2
73.04Â±3.2 75.45Â±1.8 72.24Â±1.6 71.45Â±0.3 68.60Â±3.1
68.74Â±0.5 75.92Â±2.1 65.20Â±3.4 55.47Â±1.7
+ VGAE 62.83Â±8.3
71.78Â±4.5 74.39Â±2.8 70.92Â±9.2 56.78Â±4.4 66.05Â±1/4
63.55Â±2.2 72.84Â±2.8 63.18Â±2.7 51.05Â±2.6
+ GraphENS 66.34Â±7.1
70.16Â±3.1 69.54Â±2.7 65.06Â±5.2 28.25Â±5.8 52.09Â±2.9
55.28Â±1.7 53.82Â±3.6 52.57Â±3.8 7.94Â±9.1
Metho
dY
elpChi Re
ddit
F1
AUC Pre Rec AUCPR F1
AUC Pre Rec AUCPR
GCN
+GenGA 51.68Â±2.2
60.15Â±1.0 56.35Â±0.5 56.08Â±1.9 25.18Â±1.4 50.99Â±1.2
64.95Â±0.5 51.49Â±0.2 59.58Â±3.3 23.24Â±3.6
+ VGAE 50.98Â±3.2
57.98Â±1.7 55.67Â±1.5 54.06Â±0.8 24.36Â±1.1 50.81Â±2.1
60.34Â±1.1 50.39Â±2.4 56.44Â±2.2 20.44Â±0.9
+ GraphENS 55.01Â±6.9
56.10Â±8.6 54.99Â±2.2 55.47Â±6.6 20.57Â±6.2 50.29Â±3.5
53.71Â±8.7 50.24Â±5.4 50.65Â±2.1 4.09Â±5.6
GAT
+GenGA 51.53Â±1.3
78.95Â±1.2 60.43Â±2.8 67.05Â±5.0 41.96Â±0.6 50.94Â±0.2
65.08Â±0.4 53.59Â±0.2 50.05Â±0.1 42.18Â±1.2
+ VGAE 50.40Â±2.2
76.26Â±1.1 58.02Â±0.8 65.93Â±0.7 41.54Â±2.6 50.29Â±1.6
62.80Â±1.4 52.15Â±0.6 49.95Â±0.9 40.65Â±3.3
+ GraphENS 58.28Â±9.8
60.92Â±1.3 58.97Â±6.5 57.93Â±5.3 24.79Â±7.9 50.09Â±3.5
50.48Â±9.2 49.95Â±3.2 50.52Â±9.7 3.77Â±2.1
GraphSAGE
+GenGA 67.51Â±0.9
83.74Â±0.6 65.76Â±0.6 75.19Â±1.1 56.00Â±1.0 62.00Â±0.1
70.79Â±0.2 53.19Â±0.1 60.12Â±3.0 55.05Â±1.8
+ VGAE 65.47Â±2.3
81.33Â±1.1 63.76Â±1.1 72.92Â±0.9 53.27Â±2.9 59.07Â±1.2
70.16Â±1.8 56.09Â±1.1 55.51Â±1.5 53.37Â±4.2
+ GraphENS 57.03Â±3.0
58.98Â±1.2 57.10Â±1.4 57.02Â±8.4 22.86Â±7.3 51.61Â±6.5
54.91Â±1.1 51.78Â±7.6 51.81Â±1.6 4.37Â±4.2
 
2164