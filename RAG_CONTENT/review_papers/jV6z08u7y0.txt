The Implicit Bias of Gradient Descent toward
Collaboration between Layers: A Dynamic Analysis of
Multilayer Perceptions
Zheng Wang Geyong Min
Department of Computer Science
University of Exeter
{zw360;G.Min}@exeter.ac.ukWenjie Ruanâˆ—
School of Computer Science
USTC
rwjie@ustc.edu.cn
Abstract
Theimplicit bias ofgradient descent has long been considered the primary mecha-
nism explaining the superior generalization of over-parameterized neural networks
without overfitting, even when the training error is zero. However, the implicit bias
toward adversarial robustness has rarely been considered in the research commu-
nity, although it is crucial for the trustworthiness of machine learning models. To
fill this gap, in this paper, we explore whether layers in neural networks collabo-
rate to strengthen adversarial robustness during gradient descent. By quantifying
this collaboration between layers using our proposed concept, co-correlation , we
demonstrate a monotonically increasing trend in co-correlation, which implies a
decreasing trend in adversarial robustness during gradient descent. Additionally,
we observe different behaviours between narrow and wide neural networks during
gradient descent. We conducted extensive experiments that verified our proposed
theorems.
1 Introduction
As Artificial Intelligence (AI) has been widely applied in many industrial sectors, understanding the
theoretical properties behind modern machine learning models is important, especially for neural
networks due to their black-box nature. One such property is implicit bias , stemming from the
phenomenon where over-parameterized neural networks, trained in a gradient descent manner, often
exhibit great generalization without over-fitting. This implicit bias of gradient descent is often
explained as steering neural networks towards solutions characterized by max-margin [3, 23, 12].
Another intriguing phenomenon is the existence of adversarial examples â€” imperceptible perturba-
tions of inputs that alter classification results. Apart from existing work on attacks â€” algorithms for
generating adversarial examples [ 5,39,37],defences against attacks, e.g., adversarial training [ 25,36]
and distillation [ 28], and verification [40,34] to identify safe regions guaranteeing the absence of ad-
versarial examples, recently some works are aiming at a theoretical understanding behind adversarial
robustness. However, a principled way to comprehend the core contributors to the vulnerability of
neural networks, especially a theoretical understanding of their relation to generalization capabilities,
remains fragmented. This fragmentation is largely due to the intricate nature of neural networks,
where robustness is interconnected with many factors spanning across input data distribution [ 33,14],
sampling complexity [ 1,27], optimization techniques [ 25], weight initialization strategies [ 41], and
model capacity and architectures [ 32,2,18,35]. Not to mention that only very few works can address
both generalization and adversarial robustness in a uniform framework. One such research by Frei
et al. [13] investigates the implicit bias concerning both generalization andadversarial robustness ,
âˆ—Corresponding Author
38th Conference on Neural Information Processing Systems (NeurIPS 2024).asserting that while implicit bias leads to solutions with improved generalization, it results in weaker
adversarial robustness. However, this work ignores the architectural factor of neural networks and is
hard to generalize to neural networks with more than two layers.
Inspired by this work and to investigate whether neural network layers collaborate against adversarial
examples during training, this paper first adopts the novel concept of Dirichlet energyâ€”originating
from Partial Differential Equations (PDEs) to assess the variability of a function [ 11]â€”to evaluate
the adversarial robustness of neural networks. We then theoretically demonstrate that Dirichlet
energy serves as an effective measure of adversarial risk. By decomposing the Dirichlet energy
across the entire neural network into its constituent layers, we can quantify the interactions between
adjacent layers concerning adversarial robustness. We term this interaction collaboration correlation
(co-correlation) and find that this metric reflects â€™alignmentsâ€™ in feature selection between neigh-
bouring layers. Furthermore, we conduct a dynamic analysis of co-correlation in two-layer MLPs,
demonstrating with high probability a monotonic increase under gradient descent, which indicates
diminishing adversarial robustness. Additionally, our experiments show that two-layer MLPs with
small widths tend to enhance their performance through strengthened co-correlation, a pattern not
observed in wide two-layer MLPs. Our key contributions in this paper can be summarized as follows:
1.To the best of our knowledge, this work is the first to study the implicit bias of interaction
between layers. We have quantified the interactions between adjacent layers and theoretically
demonstrated that co-correlation between layers strengthens during gradient descent in neural
networks under mild assumptions, suggesting that it not only fails to collaborate against
adversarial perturbations but may even hinder resistance to them during gradient descent.
2.We demonstrate how neural networks with a large width differ in behaviour from the neural
network of a small width, showing that MLPs with larger widths exhibit more resistance to
increased co-correlation and, therefore, are more adversarial robust, which is complementary
for the work by Dohmatob and Bietti [8].
3.Extensive experiments have been conducted to validate our proposed framework. By
controlling the weight initialization, a perspective also suggested by Zhu et al. [41], we
challenge the argument, as proposed by Huang et al. [18], that a wide neural network
does not necessarily lead to better adversarial robustness, through the lens of cross-layer
collaboration.
2 Related Works
2.1 Implicit Bias of Gradient Descent
The mystery of over-parameterized neural network trained with gradient descent manner hardly
over-fitting has long been studied. Chizat and Bach [3]study the two-layer neural network with
infinite width and homogeneous activations, showing that gradient flow can be characterized as a
max-margin classifier on exponentially tailed losses. Lyu et al. [24], Sarussi et al. [29] study the
two-layer Leaky ReLU neural network on linearly separable data and claim that networks converge
to a max-margin linear predictor by gradient descent manner. Frei et al. [12] confirms those claims
on high-dimensional nearly orthogonal data.
Lyu and Li [23], Ji and Telgarsky [19] claims that the homogeneous neural networks with
exponentially-tailed classification losses converge to a KKT point of a maximum-margin problem.
Kunin et al. [21] extend these results to a more boarder family of quasi-homogeneous neural networks.
A more recent research [ 13] considers both generalization and robustness for two-layer ReLU neural
networks, arguing that gradient descent is biased towards solutions that generalise well but are more
vulnerable against adversarial examples, even the neural network is highly over-parameterized.
2.2 Theoretical Investigation of Adversarial Robustness
Since the phenomenon of adversarial examples has been discovered [ 15], various works have been
proposed to understand the theoretical fundamentals behind it, especially for neural networks. Some
researchers argue that the source of adversarial vulnerability comes from the input data [ 33,8,31,
26,14,7,30,1,27]. The more recent researches investigate the fragility of neural networks from an
architectural perspective. Simon-Gabriel et al. [32] study the vulnerability of feed-forward neural
2networks measured by Lpnorm of the loss function w.r.t. input data, suggesting that the vulnerability
increases with input dimension independent of model structures. Daniely and Shacham [6]examined
the ReLU neural network characterized by decreasing dimensions at each layer. They asserted that
the manifestation of adversarial robustness is intrinsically tied to the networkâ€™s architecture, which
contrasts with the propositions put forth by Simon-Gabriel et al. [32]. Bubeck et al. [2]expanded
the findings of Daniely and Shachamâ€™s work on two-layer neural networks from an "under-complete
case" scenario to an "over-complete" one where the number of neurons surpasses the input dimension.
They further broadened the conclusions drawn by Daniely and Shacham [6]and Bubeck et al. [2]
to encompass Deep ReLU networks, hinting at a crucial role played by bottleneck layers in these
networks. Zhu et al. [41], instead of merely considering random weights as the standard configuration,
conducted a comprehensive analysis of the effects of weight initialization on adversarial robustness.
Unlike previous studies that focus solely on the overall assessment of neural networks while over-
looking layer interactions, our research examines the synergistic involvement between layers within
neural networks, taking into account both weight initialization and optimization.
3 Preliminary
3.1 General Setting
We follow the binary classification setting where the input data is X âŠ†Rd, with the label Y âŠ† { 0,1}.
Given data set D={(xi, yi)}n
i=1drawn from an unknown probability measure PonX Ã— Y and the
neural network f:X Ã—Î˜â†’R, where Î˜denotes the set of parameters, our objective is to optimize
fby updating the weights with gradient descent method such that it can predict the label accurately.
The prediction result is shown in Equation (1).
ypred=1, sig(fW(x))>0.5
0, sig(fW(x))â‰¤0.5,(1)
where sigis the sigmoid function, i.e., sig(x) = 1 /(1 +eâˆ’x). We use Binary Cross-Entropy (BCE)
lossin Equation (2)as our loss function. For simplicity, we denote ui=f(xi, W), iâˆˆ[n]as the
output of the neural network for input xi, where [n] ={kâˆˆN+|kâ‰¤n}.
L(f, y) =1
nnX
i=1L(sig(ui), yi) =âˆ’1
nnX
i=1
yilog(sig(ui)) + (1 âˆ’yi) log(1 âˆ’sig(ui))
.(2)
3.2 Neural Networks and Adversarial Risk
Our exploration starts from a basic linear model, then to Multilayer Perceptrons (MLP) . We provide
the proof for both linear and 2-layer MLPs, which can be extended to MLPs with more layers. They
are defined as
flinear (x, W) =aT(Wx) (3a)
fmlp(x, W) =aT(Ïƒ(Wx)), (3b)
where xâˆˆ X is the input data, WâˆˆRmÃ—ddenotes the linear transformation, mis the width of the
networks. Ïƒdenotes the element-wise activation functions .
We follow the initialization setting in [ 9], where ais randomly initialized and fixed from a binary
selection of {âˆ’1âˆšm,1âˆšm}m. Additionally, we introduce a slightly different setting for the weights W,
which are randomly initialized following the normal distribution N(0,1
m1+2q)withq >0, instead of
N(0,1
m). However, in our experiment, different settings of qare considered, including the scenario
thatqâ‰¤0.
Generalization ability is one of the most important concepts for machine learning models. Classifiers
with better generalization power indicate lower natural risk for unseen data. Given data points
(x, y)âˆ¼Pand classifier f, the natural risk is defined as
R(f) = E
(x,y)âˆ¼P[L(f(x), y))]. (4)
When it comes to 0-1loss, the natural risk becomes the probability of misclassification for unseen
data points.
3Similar to natural risk, the adversarial risk is defined as the probability of misclassification under
adversarial perturbations as is shown in Definition 3.1.
Definition 3.1 (Adversarial Risk) .Given data points (x, y)âˆ¼P, and a perturbation Îµwithin a
norm-ball, i.e.,
Br={âˆ¥Îµâˆ¥2â‰¤r}, (5)
where r >0indicates the L2-norm budget for perturbations. The adversarial risk for neural network
fon loss function Lis defined as
Rrob(f, r) = E
(x,y)âˆ¼P
sup
ÎµâˆˆBrL(f(x+Îµ), y))
(6)
Since adversarial perturbations are almost invisible to human eyes, we expect rto be quite small.
3.3 Dirichlet Energy
The concept of Dirichlet energy , originating from Partial Differential Equations (PDEs) , serves as a
tool to assess the variability of a function [ 11]. However, as argued by Dohmatob and Bietti [8], it
serves as a more effective measure of adversarial robustness than the Lipschitz constant . We extend
this concept to mappings to make it more suitable for multi-dimensional problems, which is formally
defined in Definition 3.2.
Definition 3.2 (Dirichlet Energy for Mappings) .Let convex set Z1âŠ†Rm1andZ2âŠ†Rm2. Given a
differentiable mapping Ï•:Z1â†’ Z 2, the Dirichlet Energy w.r.t. xâˆ¼Pxis defined as
S(Ï•)â‰œq
âˆ¥JÏ•(x)âˆ¥2
L2(Px)=q
Exâˆ¼Px[âˆ¥JÏ•(x)âˆ¥2
2], (7)
whereâˆ¥ Â· âˆ¥ 2refers to the operator norm and JÏ•(x)denotes the Jacobian matrix of Ï•w.r.t. its input x.
To be clear, we use âˆ¥Â·âˆ¥ 2to denote the L2-norm for vectors and operator norm for matrices throughout
our analysis. This concept can be extended to layers with ReLU activation by extending the derivative
toReLUâ€²(x) =1{xâ‰¥0}, where 1{xâ‰¥0}is the indicator function. With the concepts defined, we now
establish the relationship between adversarial risk and Dirichlet energy.
4 Measure Adversarial Risk by Dirichlet Energy
In this section, we establish the relationship between the adversarial risks andDirichlet energy ,
showing that Dirichlet Energy is a proper measurement for adversarial risk. Dohmatob and Bietti [8]
only compares the Dirichlet energy with the Lipschitz constant. We, instead, illustrate that Dirichlet
energy is a proper representation of the gap between natural risk and adversarial risk.
Theorem 4.1. Given data points (x, y)âˆ¼Pandxâˆ¼Px, the relationship between adversarial risk
and Dirichlet energy for classifier fwith differentiable loss function Lis shown as
Rrob(f, r)â‰²R(f) +rS(L(f)), (8)
where r > 0is the largest perturbation budget and S(L(f)) =r
Exâˆ¼Pxh
âˆ¥âˆ‡fLTÂ·Jf(x)âˆ¥2
2i
indicating the Dirichlet energy of the classifier on loss L.
As is shown, the Dirichlet energy is a proper representation of the gap between generalization
and adversarial risk which indicates the adversarial robustness. The proof relies on the linear
approximation of L(f). The detailed proof is shown in Appendix A.
We also empirically show that the Dirichlet energy for classifier f, i.e.,S(f)instead of S(L(f)),
is the part that influences the adversarial robustness, as is shown in Figure 1 where we compare the
level of Dirichlet energy for fwith the robust accuracy of the classifier attacked by Auto-attack [5].
Since the Dirichlet energy defined in Equation (7)can be used to measure the variability of mappings,
it follows that this metric could be employed to evaluate the adversarial robustness of individual
layers or modules within neural networks. Consequently, this allows for an assessment of whether
there is collaboration between these components in terms of adversarial robustness.
44.1 Measure Correlation between Layers
To evaluate the collective impact of neighbouring layers on the adversarial robustness, we regard the
neural network as compounded separate mappings, i.e., Ï•â—¦Ï†. By calculating the Dirichlet energy
for each mapping ( S(Ï•)andS(Ï†)) and comparing it with the overall Dirichlet energy for the whole
classifier ( S(Ï•â—¦Ï†)), we can quantify the collaboration between these two mappings, and we term
this quantification co-correlation which is defined in 4.2.
Definition 4.2 (Co-correlation) .LetÏ†:Z1â†’ Z 2andÏ•:Z2â†’ Z 3be two successive mappings,
where both Z1andZ2are convex. Given input xâˆ¼Px, the collaboration correlation (co-correlation)
is defined as
Ï±Ï•,Ï†â‰œ 
Exâˆ¼Pxâˆ¥JÏ•â—¦Ï†(x)âˆ¥2
21
2
 
Exâˆ¼Px
âˆ¥JÏ•(Ï†)âˆ¥2
2Â· âˆ¥JÏ†(x)âˆ¥2
21
2. (9)
To avoid any confusion, we use Ï†interchangeably to denote both the function Ï†:Z1â†’ Z 2and
the output of the function Ï†=Ï†(x)for a given input x. Consequently, Ï†inJÏ•(Ï†)represents the
outputs, while in JÏ†(x), it represents the mapping. Since for each xâˆˆPx, we have
âˆ¥JÏ•â—¦Ï†(x)âˆ¥2=âˆ¥JÏ•(Ï†)Â·JÏ†(x)âˆ¥2â‰¤ âˆ¥JÏ•(Ï†)âˆ¥2Â· âˆ¥JÏ†(x)âˆ¥2.
We expect 0â‰¤Ï±Ï•,Ï†â‰¤1. The concept of co-correlation can be explained by the feature alignment of
layers in neural networks.
Interpretation of co-correlation. Intuitively, co-correlation can be viewed as feature â€™alignmentâ€™
between layers. We illustrate this intuition with a 2-layer neural network with linear activation
functions, i.e.,
f(x) =Ï•(Ï†(x)) =W2W1x, (10)
where W1andW2are weight matrices, and Ï†(x) =W1xrepresents the feature selection in layer-1,
whileÏ•(Ï†) =W2Ï†represents it in layer-2. By Definition 4.2, the co-correlation between Ï•andÏ†is
Ï±Ï•,Ï†=âˆ¥W2W1âˆ¥2
âˆ¥W2âˆ¥2âˆ¥W1âˆ¥2. (11)
where âˆ¥ Â· âˆ¥ 2denotes the operator norm. Let SÏ†= arg max âˆ¥xâˆ¥2=1âˆ¥W1xâˆ¥2, representing the
set of input features that maximize the L2-norm of their corresponding outputs. Similarly, let
SÏ•= arg max âˆ¥zâˆ¥2=1âˆ¥W2zâˆ¥2. Assume Ï±Ï•,Ï†= 1, there exists xâˆˆ SÏ†such thatÏ†(x)
âˆ¥Ï†(x)âˆ¥2âˆˆ SÏ•.
This implies that the maximal output in terms of the L2-norm at the first layer can lead the output
at the second layer to reach its maximum. In other words, in terms of maximizing outputs, layer 1
aligns with layer 2. We can thus regard co-correlation as the degree of alignment in feature selection
between adjacent layers within the context of output maximization. In the non-linear case, the weight
matrices are replaced by the Jacobians of the respective layers, which can be equivalently viewed as
weight matrices that vary based on their inputs.
Definition 4.3 (Other Related Statistics) .Given the same assumptions in Definition 4.2, we define
the linear correlation between âˆ¥JÏ•(Ï†)âˆ¥2andâˆ¥JÏ†(x)âˆ¥2as
ÏÏ•,Ï†â‰œExâˆ¼Px
âˆ¥JÏ•(Ï†)âˆ¥2Â· âˆ¥JÏ†(x)âˆ¥2

EÏ†âˆ¼Ï†(x)âˆ¥JÏ•(Ï†)âˆ¥2
21
2
Exâˆ¼Pxâˆ¥JÏ†(x)âˆ¥2
21
2, (12)
where Ï†âˆ¼Ï†(x)shows that Ï†follows the distribution of Ï†(x),xâˆ¼Px. It is obvious that
0â‰¤ÏÏ•,Ï†â‰¤1and when ÏÏ•,Ï†= 1,âˆ¥JÏ•(Ï†)âˆ¥2andâˆ¥JÏ†(x)âˆ¥2are linear correlated.
The mean and variance for âˆ¥JÏ•(Ï†)âˆ¥2Â· âˆ¥JÏ†(x)âˆ¥2are defined as
ÂµÏ•,Ï†â‰œExâˆ¼Px
âˆ¥JÏ•(Ï†)âˆ¥2Â· âˆ¥JÏ†(x)âˆ¥2
, (13)
and
varÏ•,Ï†â‰œV arxâˆ¼Px
âˆ¥JÏ•(Ï†)âˆ¥2Â· âˆ¥JÏ†(x)âˆ¥2
. (14)
5(a) Robust Acc.
 (b)S(f)
0 10 20 30 40 50 
Epoch0.40.60.81.0
Ï±
a
,W
width-16 
width-32 
width-64 
width-128 
width-256 
width-512 
width-1024 
width-2048 
width-4096 
width-8192 (c) Linear Model
0 10 20 30 40 50 
Epoch0.40.60.81.0
Ï±
a
,
Ïƒ
â—‹
W
width-16 
width-32 
width-64 
width-128 
width-256 
width-512 
width-1024 
width-2048 
width-4096 
width-8192 (d) MLP
Figure 1: For all MLPs considered, lower value of Dirichlet Energy (Figure 1b) corresponds to
larger robust accuracy on test-set attacked by L2-norm Auto-attack with Ïµ= 0.5. The dynamics
of the co-correlation Ï±for linear and MLPs is shown in Figure 1c and 1d. The architectures of
neural networks are defined in Equation (3b). The parameters to control the weight initialization in
Assumption 5.1 is set to q= 0.25
Remark 4.4 (Linear Correlation for L2-norm of the Jacobian) .We have ÏÏ•,Ï†= 1 iff there exist
tâˆˆRsuch that
P(tâˆ¥JÏ•(Ï†)âˆ¥2=âˆ¥JÏ†(x)âˆ¥2) = 1 ,
implying that ÏÏ•,Ï†certainly can be used to assess the linear correlations. It reduces to Pearson
correlation coefficient [4] when the mean of both random variables equals zero.
Now we give the theorem that binds them together.
Theorem 4.5 (Robustness Decomposition) .Given the same assumption in Definition 4.2, the mea-
surement for overall adversarial robustness can be decomposed as
S(Ï•â—¦Ï†) =
Exâˆ¼P
âˆ¥JÏ•â—¦Ï†(x)âˆ¥2
21
2
=Ï±Ï•,Ï†
1 +varÏ•,Ï†
Âµ2
Ï•,Ï†1
2ÏÏ•,Ï†S(Ï•)S(Ï†) (15)
The proof is straightforward from the definition. Based on this theorem, we have conducted exper-
iments with various linear models and 2-layer MLPs. These experiments demonstrate that, apart
from the co-correlation, all other statistics are negligible, as shown in Figure 5 in the Appendix D.
Consequently, our analysis primarily focuses on the co-correlation Ï±.
5 On Dynamics of Co-Correlation
5.1 Dynamics for Linear Model
Before delving into our analysis, we state our assumptions explicitly.
Assumption 5.1. We assume that each element wi,jin the weight matrix W(0)âˆˆRmÃ—dat ini-
tialization follows the Gaussian distribution N(0,1
m1+2q), with q >0. Additionally, each element
ar, râˆˆ[m]inais randomly selected from the set {âˆ’1âˆšm,1âˆšm}, and fixed during training.
Assumption 5.2. We assume that for each (xi, yi)âˆˆD, iâˆˆ[n],xiisL2norm bounded such that
âˆ¥xiâˆ¥2= 1for all iâˆˆ[n].
Since we only assume bounded inputs and a specific weight initialization method, compared to
existing works [ 23,19,21,12], our approach can be easily extended to MLPs with more than two
layers.
Now let us focus on the co-correlation defined in Equation (9)and show the dynamics of Ï±Ï•,Ï†for
each step of gradient descent. We start from the linear model described in Equation (3a). Given the
binary classification problem and the linear model described. Our first theorem demonstrates that
co-correlation Ï±Ï•,Ï†gradually accumulates throughout gradient descent optimization. Despite the
simplicity of the linear model, it effectively exhibits most of the core properties under consideration.
6Since the weights are updated by the gradient descent, the update of the weights at step tâˆˆNis
âˆ†wr(t) =Î·ar1
nnX
i=1 
yiâˆ’sig(ui(t))
xi,
where Î·denotes the learning rate. Therefore, the dynamics of the weights can be expressed as
Ë™W(t) =aâŠ—exT(t), (16)
where âŠ—denotes the Kronecker product and ex(t)is the error weighted input such that
ex(t) =1
nnX
i=1h
yiâˆ’sig 
ui(t)i
xi. (17)
Given the weight updates, we demonstrate that the dynamics of the co-correlation for the linear
model, denoted as Ë™Ï±a,W(t), exhibit an increasing trend, particularly during the initial steps of training
when most predictions are still essentially random.
Theorem 5.3 (Dynamics of the Co-correlation for Linear Model) .Given the linear model defined in
Equation (3a)and training dataset D={(xi, yi)}n
i=1. Assume that assumptions 5.1 and 5.2 hold for
Wanda. The gradient descent applied to the weights results in the dynamics of the co-correlation
being expressed as:
Ë™Ï±a,W(t) =Î·C(t)Ï±a,W, (18)
and with high probability,
C(t)â‰¥Pt
Ï„=1ex(Ï„)Tex(t)
âˆ¥W(t)âˆ¥2
2Â·
1âˆ’ 
v(t)Ta2
+O1
mq
(19)
where the v(t)is the dominate eigenvector for W(t)W(t)T.
When mis sufficiently large, and during the initial steps of the optimization process, ex(Ï„), Ï„âˆˆ[t]
are quite similar to each other in terms of cosine similarity, implying an acute angle to each other,
which leads toPt
Ï„=1ex(Ï„)Tex(t)â‰¥0. As a result, we can conclude that C(t)â‰¥0.
The detailed proof can be found in the Appendix B. This assertion is also corroborated by the results
of our experiments as shown in Figure 1c. Even though Theorem 5.3 is based on a linear model, the
essential properties are universally applicable and can be summarized as follows:
Property 1. The co-correlation Ï±a,Wdevelops during the initial stages of training and becomes
saturated as training progresses to its later stages.
Property 2. The speed of the accumulation of co-correlation Ï±a,Wis inversely related to the operator
norm of weights âˆ¥W(t)âˆ¥2.
Under the same weight initialization conditions specified in Assumption 5.1, an increase in network
width leads to a decrease in the L2-norm of the weight, consequently causing a substantial rise in
co-correlation.
5.2 Dynamics for MLP Model
For the non-linear case, we make certain assumptions regarding activation functions.
Assumption 5.4. The derivative of the activation function Ïƒâ€²(x)in non-linear neural networks is
bounded by M. In other words, we have |Ïƒâ€²(x)| â‰¤M.
With Assumption 5.4, Theorem 5.3 can be extended to MLPs, and the two properties still hold.
Different from the linear model, the update of weights for non-linear MLP defined in (3b) is
âˆ†wr=Î·ar1
nnX
i=1 
yiâˆ’sig(ui)
Ïƒâ€²(wT
rxi)xi, (20)
where Ïƒâ€²(wT
rxi)is the derivative of activation function w.r.t. its input. Hence,
âˆ†W=Î·ï£«
ï£¬ï£­a1exT
1...
amexT
mï£¶
ï£·ï£¸,
7(a) ResNets
0 10 20 30 40 50 
Epoch0.230.240.25
Ï±
ResNet50 
WRN50 (b) A1-A1
0 10 20 30 40 50 
Epoch0.400.450.500.550.600.650.70
Ï±
ResNet50 
WRN50 (c) B1-B2
Figure 2: The dynamics of co-correlation for ResNet50 and WRN50 under different way of partition.
The way of partition is illustrated in Figure 2a. A1-A2 and B1-B2 represent the separations that
distinguish the head and tail separately.
where for each râˆˆ[m],
exr=1
nnX
i=1Ïƒâ€²(wT
rxi) 
yiâˆ’sig(ui)
xi.
As is shown in Equation (20),ais not the dominant eigenvector for âˆ†Wâˆ†WTdue to the difference
ofexr, râˆˆ[m]fromex. Thus to average out the difference, we define the weighted sum of inputs for
the non-linear model as
exâˆ—(t)â‰œ1
nnX
i=1Î±i(t,x) 
yiâˆ’sig(ui(t))
xi, (21)
where (xi, yi)âˆˆ D are realized r.v., and xâˆ¼Px. Given wi,ji.i.d.âˆ¼N(0,1
m1+2q)for each element in
W(0), we have w(0)âˆ¼N(0,1
m1+2qId). Furthermore, given that W(t)is calculated from W(0), it
is evident that each row in W(t), denoted as w(t), constitutes a random variable. As a result, both
Ïƒâ€²(w(t)Tx)andÏƒâ€²(w(t)Txi)are bounded random variables that are contingent upon W(0). Hence,
we define Î±i(t,x)as
Î±i(t,x)â‰œEW(0)h
Ïƒâ€²(w(t)Tx)Ïƒâ€²(w(t)Txi)i
.
Since, xâˆ¼Px,Î±i(t,x)is still r.v. contingent to xand so does the exâˆ—(t). Now we show the dynamics
of co-correlation for two-layer MLP defined in Equation (3b).
Theorem 5.5. (Dynamics of the Co-correlation for MLP) Given the MLP defined in Equation (3)
with training dataset D={(xi, yi)}n
i=1,xâˆˆ X such that xâˆ¼Px. Assume that Assumption 5.1 and
5.2 hold for Wanda, and Assumption 5.4 holds for the activation function. we have
Ë™Ï±a,Ïƒâ—¦W(t) =Î·C(t)Ï±a,Ïƒâ—¦W(t).
With high probability,
C(t)â‰¥Pt
Ï„=1 
1âˆ’aTv(Ï„)aTv(t)
Exâˆ¼PxexT
âˆ—(Ï„)exâˆ—(t)
Exâˆ¼Pxâˆ¥D(t)W(t)âˆ¥2
2+ max
O1âˆšm
,O1
mq
,
where
D(t) =diag(Ïƒâ€²(w1(t)Tx),Â·Â·Â·, Ïƒâ€²(wm(t)Tx)),
andv(t)denotes the dominant eigenvector for W(t)W(t)T, withexT
âˆ—is defined in Equation (21).
Similar to the Theorem 5.3, when mis sufficiently large, and during the initial steps of the optimization
where the error-weighted inputs exT
âˆ—(Ï„), Ï„âˆˆ[t]do not significantly fluctuate, we have that C(t)â‰¥0.
The detailed proof is in Appendix C. In Theorem 5.5, exâˆ—serves a similar purpose as exfor the linear
model. In addition, it considers the influence of the activation function. Property 1 still holds for the
MLPs, and Property 2 extends to Exâˆ¼Pxâˆ¥D(t)W(t)âˆ¥2
2=âˆ¥JÏƒâ—¦W(x)âˆ¥2
L(Pz).
80 10 20 30 40 50 
Epoch0.30.40.50.60.70.80.9
Ï±
a
,
Ïƒ
â—‹
W
q=-0.15 
q=-0.2 
q=-0.05 
q=0
q=0.05 
q=0.15 
q=0.25(a) width-32
0 10 20 30 40 50 
Epoch0.30.40.50.60.70.80.9
Ï±
a
,
Ïƒ
â—‹
W
q=-0.15 
q=-0.1 
q=-0.05 
q=0
q=0.05 
q=0.15 
q=0.25 (b) width-512
0 10 20 30 40 50 
Epoch0.30.40.50.60.70.80.9
Ï±
a
,
Ïƒ
â—‹
W
q=-0.15 
q=-0.1 
q=-0.05 
q=0
q=0.05 
q=0.15 
q=0.25 (c) width-2048
0 10 20 30 40 50 
Epoch0.30.40.50.60.70.80.9
Ï±
a
,
Ïƒ
â—‹
W
q=-0.15 
q=-0.1 
q=-0.05 
q=0
q=0.05 
q=0.15 
q=0.25 (d) width-8192
Figure 3: The dynamic of co-correlation under different set-up of weight initialization. MLP network
defined in Equation (3)with ReLU activation function for width 32,512,2048 and8192 are included.
6 Experiments
To estimate the co-correlation more efficiently and in parallel, we employ the Power Iteration
algorithm [ 10] in conjunction with Functorch [17]. The corresponding pseudo-code is presented in
the Appendix E.
We verify our proposed theorem on linear and MLP models on the MNIST dataset [ 22]. The width of
hidden layers varied from 24to213, with weights initialized via a Gaussian distribution N(0,1
m1+2q)
where qwas set to values ranging from 0.25toâˆ’0.15. We train both the linear and MLP for 50
epochs with a batch size of 512 using the SGD optimizer with a learning rate of 0.003. In addition,
we also conduct the experiment on more complex ResNet50 [ 16] and WRN50 [ 38]. For both models,
we opted for default random weight initialization and used the Adam optimizer with a learning rate
of0.0005 on CIFAR10 [ 20]. To calculate the co-correlation and other statistics, we cover the entire
testset. We consider using L2Auto-attack [ 5] with Ïµ= 0.5for all MLPs we trained. The experiments
were executed on a Nvidia RTX3090 GPU, using Python 3.9.7 and PyTorch 1.9.1. The code for the
experiment is available at https://github.com/squarewang2077/co-correlation .
6.1 Empirical Evidence for Proposed Theorem
Figure 1 presents a comparison between the robust accuracy and the Dirichlet energy S(f)across all
trained MLPs. As observed in Figure 1a and 1b, models with lower levels of Dirichlet energy S(f)
tend to exhibit higher robust accuracy, suggesting that Dirichlet energy is an effective representation
of adversarial robustness. Another noteworthy finding is that wider neural networks, with the same
level of weight initialization, demonstrate improved adversarial robustness.
Figure 1 also depicts the dynamic behaviour of shallow neural networks with a weight initialization
parameter of q= 0.25. As is shown in Figure 1c and 1d, the co-correlation Ï±increases throughout
training. Except for narrow widths like 24and25, the majority of networks demonstrate an upward
trend. This trend, however, flattens for non-linear models, suggesting potentially stronger adversarial
robustness due to the non-linearity of the activation function introduced in MLPs.
Figure 2 shows the dynamics of the co-correlation on ResNet50 and Wide-ResNet50. Both networks
are trained on CIFAR10 using the Adam optimizer. We divide them by the pattern of A1-A2 and B1-
B2, as shown in Figure 2a. The co-correlation outcomes for these divisions are displayed in Figure 2b
and Figure 2c, it shows that even with the Adam optimizer, without specific weight initialization
considerations, there is a noticeable rise in co-correlation.
6.2 The Impact of Width and Weight Initialization
Figure 3 illustrates the co-correlation dynamics under varying qfor both linear and MLPs with widths
of 32, 512, 2,048, and 8,192. The figure highlights that our proposed theoremsâ€™ assumption of q >0
is quite tight, as all trajectories with q <0remain flat throughout training. We can also observe that
the speed of accumulation significantly increases with larger network widths.
Figure 4 displays the accuracy on testset and co-correlation for both linear and MLPs as heat-maps.
Each cell in the heat-map represents a trained network. From Figure 4c and Figure 4d, we observe that
the best performance and robustness are shown by the MLPs with the largest widths (width = 8192 )
and the smallest weight initializations ( q=âˆ’0.15). And when we alter the weight initialization to
9(a) Linear Model/Acc.
 (b) Linear Model/ Ï±
 (c) MLP ReLU/Acc.
 (d) MLP ReLU/ Ï±
Figure 4: Accuracy and Co-correlation under different initialization and width. Figure 4a and 4b
show the heat map for linear model, and Figure 4c and 4d is for MLP ReLU.
control the co-correlation, making it increase from 0.25to0.83, the accuracy declines accordingly
from 0.93to0.68. On the contrary, for another extreme case of models with a width of 16, enhanced
performance is accompanied by increased co-correlation. Consequently, an interesting conclusion
can be drawn about the diverse behaviour of neural networks with small and larger width. Gradient
descent tends to enhance the training of neural networks with smaller width by fostering co-correlation
among layers, which is intrinsically brittle. However, wide networks are trained with less reliance on
interlayer correlation, resulting in inherently more robust models.
7 Conclusion and Limitation
Our work investigates the implicit bias of gradient descent toward adversarial robustness from
the perspective of collaboration between layers. By adapting Dirichlet energy to estimate the
adversarial robustness of neural networksâ€™ individual components, we characterized the collaboration
behaviour between consecutive layers and identified two fundamental properties for dynamics of
the co-correlation. The first property shows that the co-correlation for MLPs will build up during
gradient descent under mild assumptions for weight initialization. The second property shows that
the speed of accumulation for co-correlation is inversely related to the operator norm of Jacobian for
the corresponding sub-modules. In addition, we observed that networks with small widths tend to
foster co-correlation among layers to improve performance, whereas wide networksâ€™ performance
improvement does not heavily rely on establishing such co-correlation. Future research can expand
upon this by examining the effects of increased network depth and more sophisticated structures on
the observed phenomena.
Limitation Our work can be easily extended to multi-layer neural networks since we only assume
that the inputs are bounded by the L2-norm. However, like many theoretical studies, extending our
approach to more complex models is challenging. It remains unknown whether complex models
exhibit the same behaviors.
References
[1]R. Bhattacharjee, S. Jha, and K. Chaudhuri. Sample complexity of robust linear classification
on separated data. In International Conference on Machine Learning , pages 884â€“893. PMLR,
2021.
[2]S. Bubeck, Y . Cherapanamjeri, G. Gidel, and R. Tachet des Combes. A single gradient step finds
adversarial examples on random two-layers neural networks. Advances in Neural Information
Processing Systems , 34:10081â€“10091, 2021.
[3]L. Chizat and F. Bach. Implicit bias of gradient descent for wide two-layer neural networks
trained with the logistic loss. In Conference on Learning Theory , pages 1305â€“1338. PMLR,
2020.
[4]I. Cohen, Y . Huang, J. Chen, J. Benesty, J. Benesty, J. Chen, Y . Huang, and I. Cohen. Pearson
correlation coefficient. Noise reduction in speech processing , pages 1â€“4, 2009.
10[5]F. Croce and M. Hein. Reliable evaluation of adversarial robustness with an ensemble of diverse
parameter-free attacks. In International conference on machine learning , pages 2206â€“2216.
PMLR, 2020.
[6]A. Daniely and H. Shacham. Most relu networks suffer from l2adversarial perturbations.
Advances in Neural Information Processing Systems , 33:6629â€“6636, 2020.
[7]E. Dobriban, H. Hassani, D. Hong, and A. Robey. Provable tradeoffs in adversarially robust
classification. arXiv preprint arXiv:2006.05161 , 2020.
[8]E. Dohmatob and A. Bietti. On the (non-) robustness of two-layer neural networks in different
learning regimes. arXiv preprint arXiv:2203.11864 , 2022.
[9]S. S. Du, X. Zhai, B. Poczos, and A. Singh. Gradient descent provably optimizes over-
parameterized neural networks. arXiv preprint arXiv:1810.02054 , 2018.
[10] J. F. Epperson. An introduction to numerical methods and analysis . John Wiley & Sons, 2021.
[11] L. C. Evans. Partial differential equations , volume 19. American Mathematical Society, 2022.
[12] S. Frei, G. Vardi, P. L. Bartlett, N. Srebro, and W. Hu. Implicit bias in leaky relu networks
trained on high-dimensional data. arXiv preprint arXiv:2210.07082 , 2022.
[13] S. Frei, G. Vardi, P. L. Bartlett, and N. Srebro. The double-edged sword of implicit bias:
Generalization vs. robustness in relu networks. arXiv preprint arXiv:2303.01456 , 2023.
[14] J. Gilmer, L. Metz, F. Faghri, S. S. Schoenholz, M. Raghu, M. Wattenberg, and I. Goodfellow.
Adversarial spheres. arXiv preprint arXiv:1801.02774 , 2018.
[15] I. J. Goodfellow, J. Shlens, and C. Szegedy. Explaining and harnessing adversarial examples.
arXiv preprint arXiv:1412.6572 , 2014.
[16] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning for image recognition. In
Proceedings of the IEEE conference on computer vision and pattern recognition , pages 770â€“
778, 2016.
[17] R. Z. Horace He. functorch: Jax-like composable function transforms for pytorch. https:
//github.com/pytorch/functorch , 2021.
[18] H. Huang, Y . Wang, S. Erfani, Q. Gu, J. Bailey, and X. Ma. Exploring architectural ingredients
of adversarially robust deep neural networks. Advances in Neural Information Processing
Systems , 34:5545â€“5559, 2021.
[19] Z. Ji and M. Telgarsky. Directional convergence and alignment in deep learning. Advances in
Neural Information Processing Systems , 33:17176â€“17186, 2020.
[20] A. Krizhevsky. Learning multiple layers of features from tiny images. Masterâ€™s thesis, University
of Tront , 2009.
[21] D. Kunin, A. Yamamura, C. Ma, and S. Ganguli. The asymmetric maximum margin bias of
quasi-homogeneous neural networks. arXiv preprint arXiv:2210.03820 , 2022.
[22] Y . LeCun, C. Cortes, and C. Burges. Mnist handwritten digit database. ATT Labs [Online].
Available: http://yann.lecun.com/exdb/mnist , 2, 2010.
[23] K. Lyu and J. Li. Gradient descent maximizes the margin of homogeneous neural networks.
arXiv preprint arXiv:1906.05890 , 2019.
[24] K. Lyu, Z. Li, R. Wang, and S. Arora. Gradient descent on two-layer nets: Margin maximization
and simplicity bias. Advances in Neural Information Processing Systems , 34:12978â€“12991,
2021.
[25] A. Madry, A. Makelov, L. Schmidt, D. Tsipras, and A. Vladu. Towards deep learning models
resistant to adversarial attacks. arXiv preprint arXiv:1706.06083 , 2017.
11[26] S. Mahloujifar, D. I. Diochnos, and M. Mahmoody. The curse of concentration in robust
learning: Evasion and poisoning attacks from concentration of measure. In Proceedings of the
AAAI Conference on Artificial Intelligence , volume 33, pages 4536â€“4543. Association for the
Advancement of Artificial Intelligence (AAAI), 2019.
[27] Y . Min, L. Chen, and A. Karbasi. The curious case of adversarially robust models: More data
can help, double descend, or hurt generalization. In Uncertainty in Artificial Intelligence , pages
129â€“139. PMLR, 2021.
[28] N. Papernot, P. McDaniel, X. Wu, S. Jha, and A. Swami. Distillation as a defense to adversarial
perturbations against deep neural networks. In 2016 IEEE symposium on security and privacy
(SP), pages 582â€“597. IEEE, 2016.
[29] R. Sarussi, A. Brutzkus, and A. Globerson. Towards understanding learning in neural networks
with linear teachers. In International Conference on Machine Learning , pages 9313â€“9322.
PMLR, 2021.
[30] L. Schmidt, S. Santurkar, D. Tsipras, K. Talwar, and A. Madry. Adversarially robust generaliza-
tion requires more data. Advances in neural information processing systems , 31, 2018.
[31] A. Shafahi, W. R. Huang, C. Studer, S. Feizi, and T. Goldstein. Are adversarial examples
inevitable? arXiv preprint arXiv:1809.02104 , 2018.
[32] C.-J. Simon-Gabriel, Y . Ollivier, L. Bottou, B. SchÃ¶lkopf, and D. Lopez-Paz. First-order
adversarial vulnerability of neural networks and input dimension. In International conference
on machine learning , pages 5809â€“5817. PMLR, 2019.
[33] D. Tsipras, S. Santurkar, L. Engstrom, A. Turner, and A. Madry. Robustness may be at odds
with accuracy. arXiv preprint arXiv:1805.12152 , 2018.
[34] F. Wang, P. Xu, W. Ruan, and X. Huang. Towards verifying the geometric robustness of
large-scale neural networks. arXiv preprint arXiv:2301.12456 , 2023.
[35] Z. Wang and W. Ruan. Understanding adversarial robustness of vision transformers via cauchy
problem. In Machine Learning and Knowledge Discovery in Databases: European Conference,
ECML PKDD 2022, Grenoble, France, September 19â€“23, 2022, Proceedings, Part III , pages
562â€“577. Springer, 2023.
[36] X. Yin and W. Ruan. Boosting adversarial training via fisher-rao norm-based regularization. In
Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition , pages
24544â€“24553, 2024.
[37] X. Yin, W. Ruan, and J. Fieldsend. Dimba: discretely masked black-box attack in single object
tracking. Machine Learning , 113(4):1705â€“1723, 2024.
[38] S. Zagoruyko and N. Komodakis. Wide residual networks. arXiv preprint arXiv:1605.07146 ,
2016.
[39] H. Zhang, Y . Yu, J. Jiao, E. Xing, L. El Ghaoui, and M. Jordan. Theoretically principled
trade-off between robustness and accuracy. In International conference on machine learning ,
pages 7472â€“7482. PMLR, 2019.
[40] T. Zhang, W. Ruan, and J. E. Fieldsend. Proa: A probabilistic robustness assessment against
functional perturbations. In Joint European Conference on Machine Learning and Knowledge
Discovery in Databases , pages 154â€“170. Springer, 2022.
[41] Z. Zhu, F. Liu, G. Chrysos, and V . Cevher. Robustness in deep learning: The good (width), the
bad (depth), and the ugly (initialization). Advances in Neural Information Processing Systems ,
35:36094â€“36107, 2022.
12A The Proof for Theorem 4.1
Suppose that the loss function Lis differentiable w.r.t. f. Given data points (x, y)âˆ¼Pandxâˆ¼Px,
we have
Rrob(f, r) = E
(x,y)âˆ¼Psup
ÎµâˆˆBrL(f(x+Îµ), y)) (22)
=E
(x,y)âˆ¼P
sup
ÎµâˆˆBrL(f(x), y)) + sup
ÎµâˆˆBrL(f(x+Îµ), y))âˆ’sup
ÎµâˆˆBrL(f(x, y))
(23)
â‰¤E
(x,y)âˆ¼P[L(f(x), y))] +s
E
(x,y)âˆ¼P
sup
ÎµâˆˆBr(L(f(x+Îµ), y))âˆ’L(f(x, y)))2
(24)
â‰ˆE
(x,y)âˆ¼P[L(f(x), y))] +s
E
(x,y)âˆ¼P
sup
ÎµâˆˆBr(âˆ‡fLTÂ·Jf(x)Îµ)2
(25)
=E
(x,y)âˆ¼P[L(f(x), y))] + rr
E
(x,y)âˆ¼Pâˆ¥âˆ‡fLTÂ·Jf(x)âˆ¥2
2, (26)
whereâˆ‡fLis the gradients of Lw.r.t. f,âˆ‡fLTindicates that it is a row vector. Jf(x)is the Jacobian
matrix for classifier f.
B The Proof of Theorem 5.3
Before formally proving the theorem, we provide some lemmas which are useful for our proof.
Lemma B.1 (Dynamic of Weights for Linear Model) .Given gradient descent to optimize the weights,
the dynamic of the weights at step tis
Ë™W(t) =aâŠ—exT(t), (27)
Proof. Given the step size Î·, the update for rthrow of the weight matrix Wis
âˆ†wr=âˆ’Î·
nnX
i=1âˆ‚l
âˆ‚uiâˆ‚f(W,xi)
âˆ‚wr(28)
=Î·ar1
nnX
i=1 
yiâˆ’sig(ui)
xi, (29)
where sig(Â·)denotes the sigmoid function. Hence, for weight matrix W, we have
âˆ†W=ï£«
ï£¬ï£­âˆ†wT
1...
âˆ†wT
mï£¶
ï£·ï£¸ (30)
=Î·ï£«
ï£¬ï£­a11
nPn
i=1 
yiâˆ’sig(ui)
xT
i...
am1
nPn
i=1 
yiâˆ’sig(ui)
xT
iï£¶
ï£·ï£¸. (31)
After replacing with
ex=1
nnX
i=1 
yiâˆ’sig(ui)
xi, (32)
13we have
âˆ†W=Î·ï£«
ï£¬ï£­a1exT
...
amexTï£¶
ï£·ï£¸ (33)
=Î·aâŠ—exT. (34)
Sinceâˆ¥xiâˆ¥2= 1, we also have âˆ¥exâˆ¥2â‰¤1. Therefore, we can say that the dynamics of weights, i.e.
Ë™W(t), is
Ë™W(t) =aâŠ—exT(t). (35)
Lemma B.2 (The Concentration for L2Norm of Gaussian r.v.) .LetImbe identical matrix of size
mÃ—m. Given nGaussian random vectors z1,Â·Â·Â·,znsuch that zii.i.d.âˆ¼N(0,1
m1+2qIm), q >
0,âˆ€iâˆˆ[n]. With probability at least 1âˆ’Î´, we have several conclusions:
1. Average of the norm
1
nnX
i=1âˆ¥ziâˆ¥2=1
mq+Or
8 log(2 n/Î´)
m1+2q
. (36)
2. Average of the square norm
1
nnX
i=1âˆ¥ziâˆ¥2
2=1
m2q+O
max8 log(2 /Î´)
m1+2qn,r
8 log(2 /Î´)
m1+4qn
. (37)
3. Square root of the average of the square norm
vuut1
nnX
i=1âˆ¥ziâˆ¥2
2=1
mq+Or
8 log(2 /Î´)
m1+2qn
. (38)
Proof. We first prove the concentration property for the average of the norm. Sinceâˆš
m1+2qzi,ri.i.d.âˆ¼
N(0,1), iâˆˆ[n], râˆˆ[m], we have that m1+2qz2
i,râˆ¼Ï‡2(1). Denote the sub-Exponential distribution
asSE(Î½2, Î±), we have m1+2qz2
i,râˆ’1âˆˆSE(4,4). Hence âˆ€iâˆˆ[n],
P1
mmX
r=1 âˆš
m1+2qzi,r2âˆ’1â‰¥Ïµ
â‰¤ï£±
ï£²
ï£³2 exp
âˆ’mÏµ2
8
Ïµâˆˆ(0,1)
2 exp
âˆ’mÏµ
8
Ïµâ‰¥1. (39)
Therefore, we have âˆ€Ïµ >0
P1âˆšmâˆ¥âˆš
m1+2qziâˆ¥2âˆ’1â‰¥Ïµ
â‰¤P1
mâˆ¥âˆš
m1+2qziâˆ¥2
2âˆ’1â‰¥max{Ïµ, Ïµ2}
(40)
â‰¤2 exp
âˆ’mÏµ2
8
. (41)
Equation (40) is because of the fact that given c >0fixed,âˆ€x >0we have
|xâˆ’1| â‰¥câ‡’ |x2âˆ’1| â‰¥max{c, c2} (42)
14Hence,
P1
nnX
i=1âˆ¥mqziâˆ¥2âˆ’1â‰¥Ïµ
=P1
nnX
i=11âˆšmâˆ¥âˆš
m1+2qziâˆ¥2âˆ’1â‰¥Ïµ
(43)
â‰¤PnX
i=11âˆšmâˆ¥âˆš
m1+2qziâˆ¥2âˆ’1â‰¥nÏµ
(44)
â‰¤nX
i=1P1âˆšmâˆ¥âˆš
m1+2qziâˆ¥2âˆ’1â‰¥Ïµ
(45)
â‰¤2nexp
âˆ’mÏµ2
8
(46)
Equivalently, with probability at least 1âˆ’Î´,
1
nnX
i=1mqâˆ¥ziâˆ¥2âˆ’1â‰¤r
8
mlog2n
Î´(47)
â‡’1
nnX
i=1âˆ¥ziâˆ¥2âˆ’1
mqâ‰¤1
mqr
8
mlog2n
Î´(48)
To prove the second convergence, we starts from the fact that
1
nnX
i=1âˆ¥ziâˆ¥2
2=1
nnX
i=1mX
r=1z2
i,r=1
m2q1
nmnX
i=1mX
r=1 âˆš
m1+2qzi,r2. (49)
Since âˆš
m1+2qzi,r2i.i.d.âˆ¼Ï‡2(1),âˆ€iâˆˆ[n], râˆˆ[m], similar to Equation (39), we have
P1
nmnX
i=1mX
r=1 âˆš
m1+2qzi,r2âˆ’1â‰¥Ïµ
â‰¤ï£±
ï£´ï£´ï£²
ï£´ï£´ï£³2 exp
âˆ’nm
8Ïµ2
Ïµâˆˆ(0,1)
2 exp
âˆ’nm
8Ïµ
Ïµâ‰¥1(50)
Equivalently, with probability at least 1âˆ’Î´,
1
nnX
i=1m2qâˆ¥ziâˆ¥2
2âˆ’1â‰¤(q
8
mnlog2
Î´Ïµâˆˆ(0,1)
8
mnlog2
Î´Ïµâ‰¥1(51)
â‡’1
nnX
i=1âˆ¥ziâˆ¥2
2âˆ’1
m2qâ‰¤1
m2qmax8
mnlog2
Î´,r
8
mnlog2
Î´
(52)
Now we prove the third concentration, with similar trick of the first concentration, we have
Pvuut1
nmnX
i=1mX
r=1 âˆš
m1+2qzi,r2âˆ’1â‰¥Ïµ
â‰¤P1
nmnX
i=1mX
r=1 âˆš
m1+2qzi,r2âˆ’1â‰¥max{Ïµ, Ïµ2}
(53)
â‰¤2 exp
âˆ’nm
8Ïµ2
(54)
Therefore,
Pvuut1
nnX
i=1m2qâˆ¥ziâˆ¥2
2âˆ’1â‰¥Ïµ
â‰¤2 exp
âˆ’nm
8Ïµ2
, (55)
15with probability at least 1âˆ’Î´, we have
mqvuut1
nnX
i=1âˆ¥ziâˆ¥2
2âˆ’1â‰¤r
8
mnlog2
Î´(56)
â‡’vuut1
nnX
i=1âˆ¥ziâˆ¥2
2âˆ’1
mqâ‰¤1
mqr
8
mnlog2
Î´(57)
Now, we prove the theorem 5.3. Given the linear model and training dataset D={(xi, yi)}n
i=1.
Assume that each wi,ji.i.d.âˆ¼N(0,1
m1+2q), q > 0andais randomly initialized subject to the constraint
âˆ¥aâˆ¥2= 1and fixed during training. Hence, with high probability, we have
Ë™Ï±a,Wâ‰¥Î·Ï±a,WÂ·Pt
Ï„=1ex(Ï„)Tex(t)
âˆ¥W(t)âˆ¥2
2Â·
1âˆ’ 
v(t)Ta2
+O1
mq
(58)
Proof. We first show that the derivative of co-correlation is
Ë™Ï±a,W(t) =d
dtÏ±a,W(t) (59)
=d
dtEx[âˆ¥aTW(t)âˆ¥2
2]1
2
Ex[âˆ¥W(t)âˆ¥2
2]1
2(60)
=d
dtâˆ¥aTW(t)âˆ¥2
âˆ¥W(t)âˆ¥2(61)
=Ï±a,W(t)
2dâˆ¥aTW(t)âˆ¥2
2/dt
âˆ¥aTW(t)âˆ¥2
2âˆ’dâˆ¥W(t)âˆ¥2
2/dt
âˆ¥W(t)âˆ¥2
2
(62)
â‰¥Ï±a,W(t)
2âˆ¥W(t)âˆ¥2
2dâˆ¥aTW(t)âˆ¥2
2
dtâˆ’dâˆ¥W(t)âˆ¥2
2
dt
, (63)
by the law of derivatives for inner product of matrices and the eigenvalue of matrix W(t)W(t)T, we
have
dâˆ¥aTW(t)âˆ¥2
2
dt=aT(Ë™W(t)W(t)T+W(t)Ë™W(t)T)a (64)
dâˆ¥W(t)âˆ¥2
2
dt=v(t)T(Ë™W(t)W(t)T+W(t)Ë™W(t)T)v(t), (65)
where v(t)is the dominant eigenvector for W(t)W(t)T. Equation (60) is because JW(x) =Wand
âˆ¥aâˆ¥2= 1by assumption. Since Equation (60) do not depend on x, we can safely drop the Expectation
Exas is shown in Equation (61). Equation (63) is because âˆ¥aTWâˆ¥2
2â‰¤ âˆ¥aâˆ¥2
2âˆ¥Wâˆ¥2
2=âˆ¥Wâˆ¥2
2. By
Lemma B.1, the weight matrix W(t)at training step tcan be approximated as
W(t) =W(0) +tX
Ï„=1âˆ†W(Ï„). (66)
16then
Ë™W(t)W(t)T=aâŠ—exT(t)
W(0)T+tX
Ï„=1âˆ†W(Ï„)T
(67)
=aâŠ—exT(t)
W(0)T+Î·tX
Ï„=1aTâŠ—ex(Ï„)
(68)
=aâŠ—exT(t)
W(0)T+Î·aTâŠ—tX
Ï„=1ex(Ï„)
(69)
=aâŠ—exT(t)W(0)T+Î·
aâŠ—exT(t)
aTâŠ—tX
Ï„=1ex(Ï„)
(70)
=aexT(t)W(0)T+Î·tX
Ï„=1ex(Ï„)Tex(t)
aaT, (71)
similarity,
W(t)Ë™W(t)T=
W(0) +tX
Ï„=1âˆ†W(Ï„)
aTâŠ—ex(t) (72)
=
W(0) + Î·aâŠ—tX
Ï„=1exT(Ï„)
aTâŠ—ex(t) (73)
=W(0)ex(t)aT+Î·tX
Ï„=1ex(Ï„)Tex(t)
aaT. (74)
Hence
1
2dâˆ¥aTW(t)âˆ¥2
2
dtâˆ’dâˆ¥W(t)âˆ¥2
2
dt
(75)
=Î·
1âˆ’ 
aTv(t)2 tX
Ï„=1ex(Ï„)Tex(t)
| {z }
1+aTW(0)ex(t)aTaâˆ’v(t)TW(0)ex(t)aTv(t)| {z }
2(76)
1is the main part of our theorem. And for 2, it can be bounded as
|2|= 
aâˆ’aTv(t)v(t)TW(0)ex(t) (77)
â‰¤1
nnX
i=1 
yiâˆ’sig(ui) 
aâˆ’aTv(t)v(t)TW(0)xi (78)
â‰¤1
nnX
i=1|yiâˆ’sig(ui)|q
1âˆ’(aTv(t))2
| {z }
0â‰¤...â‰¤1âˆ¥W(0)xiâˆ¥2 (79)
â‰¤1
nnX
i=1âˆ¥W(0)xiâˆ¥2 (80)
Now since wi,jâˆ¼N(0,1
m1+2q), q > 0and each wi,jis independent with each other, for given
xi, i= 1, ..., n , we have
W(0)xi=ï£«
ï£¬ï£­w1(0)Txi
...
wm(0)Txiï£¶
ï£·ï£¸âˆ¼N
0,âˆ¥xiâˆ¥2
2
m1+2qIm
, (81)
17where âˆ¥xiâˆ¥2
2= 1by assumption. By the lemma B.2, with high probability,
1
nnX
i=1âˆ¥W(0)xiâˆ¥2=1
mq+Or
8 log(2 n/Î´)
m1+2q
. (82)
Therefore,
|2|=O1
mq
(83)
with high probability, and it comes to our conclusion.
C The Proof of Theorem 5.5
To prove the Theorem 5.5, the following lemma is crucial.
Lemma C.1 (Dynamic of Weights for A Nonlinear Model for Initial Steps) .Given gradient descent
to optimize the weights, the dynamic of the weights at the initial step tfor the non-linear model is
Ë™W(t) =ï£«
ï£¬ï£­a1exT
1(t)
...
amexT
m(t)ï£¶
ï£·ï£¸, (84)
where
exr(t) =ar1
nnX
i=1 
yiâˆ’sig(ui(t))
Ïƒâ€²(wT
r(t)xi)xi, râˆˆ[m]. (85)
Proof. Similar to the linear case, the update for the rthrow for the weight matrix is
âˆ†wr=âˆ’Î·
nnX
i=1âˆ‚l
âˆ‚uiâˆ‚f(W,xi)
âˆ‚wr(86)
=Î·ar1
nnX
i=1 
yiâˆ’sig(ui)
Ïƒâ€²(wT
rxi)xi. (87)
Hence that the update of the weight matrix W(t)is
âˆ†W=ï£«
ï£¬ï£­âˆ†wT
1...
âˆ†wT
mï£¶
ï£·ï£¸ (88)
=Î·ï£«
ï£¬ï£­a11
nPn
i=1 
yiâˆ’sig(ui)
Ïƒâ€²(wT
1xi)xT
i...
am1
nPn
i=1 
yiâˆ’sig(ui)
Ïƒâ€²(wT
mxi)xT
iï£¶
ï£·ï£¸ (89)
=Î·ï£«
ï£¬ï£­a1exT
1...
amexT
mï£¶
ï£·ï£¸. (90)
Hence our conclusion.
Lemma C.2 (Concentration for Weighted Sum and Square Root Scalar for Bounded Variables) .
Suppose Xrâˆ’Âµâˆˆ[l, u],âˆ€iâˆˆ[m]is independent identically distributed r.v. with mean 0. Given a
vector vâˆˆRm,âˆ¥vâˆ¥2= 1, andasuch that arâˆˆ {âˆ’ 1,1}, râˆˆ[m]we have concentration inequality
P1âˆšmmX
r=1arvrXrâˆ’1âˆšmaTvÂµâ‰¥Ïµ
â‰¤2 exp
âˆ’mÏµ2
2(uâˆ’l)2
. (91)
18Proof. We first show the moment generation function of the r.v. we would like to estimate.
E
exp
t1âˆšmmX
r=1arvrXrâˆ’1âˆšmaTvÂµ
â‰¤expt2
2m(uâˆ’l)2
. (92)
Now, we prove this inequality.
E
exp
t1âˆšmmX
r=1arvrXrâˆ’1âˆšmaTvÂµ
=E
exptâˆšmmX
r=1arvrXrâˆ’mX
r=1arvrÂµ
(93)
=mY
r=1E
exptarvrâˆšm
Xrâˆ’Âµ
(94)
â‰¤mY
r=1expv2
rt2
2m(uâˆ’l)2
(95)
= expt2
2m(uâˆ’l)2mX
r=1v2
r
(96)
= expt2
2m(uâˆ’l)2
, (97)
where tâ‰¥0. Hence by Chernoffâ€™s bound, we have that
P1âˆšmmX
r=1arvrXrâˆ’1âˆšmaTvÂµâ‰¥Ïµ
â‰¤2 inf
tâ‰¥0expt2
2m(uâˆ’l)2	
exp{tÏµ}(98)
= 2 exp
âˆ’mÏµ2
2(uâˆ’l)2
(99)
Here, we prove the theorem 5.5. Given a shallow neural network, with high probability we have
Ë™Ï±a,Ïƒâ—¦W(t) =Î·Ï±a,Ïƒâ—¦W(t)
Exâˆ¥D(t)W(t)âˆ¥2
2tX
Ï„=1(1âˆ’aTv(Ï„)aTv(t))Exexâˆ—(Ï„)Texâˆ—(t)
(100)
+ max
O1âˆšm
,O1
mq
(101)
Proof. Because of activation function depends on the input x, we cannot drop the expectation Ex.
Hence, we have
Ë™Ï±a,W(t) =d
dtÏ±a,W(t) (102)
=d
dtEx[âˆ¥aTD(t)W(t)âˆ¥2
2]1
2
Ex[âˆ¥D(t)W(t)âˆ¥2
2]1
2(103)
=Ï±a,W(t)
2Exdâˆ¥aTD(t)W(t)âˆ¥2
2/dt
Exâˆ¥aTD(t)W(t)âˆ¥2
2âˆ’Exdâˆ¥D(t)W(t)âˆ¥2
2/dt
Exâˆ¥D(t)W(t)âˆ¥2
2
(104)
â‰¥Ï±a,W(t)
2Exâˆ¥D(t)W(t)âˆ¥2
2Exdâˆ¥aTD(t)W(t)âˆ¥2
2
dtâˆ’dâˆ¥D(t)W(t)âˆ¥2
2
dt
, (105)
where D(t) = diag(Ïƒâ€²(wT
1x), ..., Ïƒâ€²(wT
mx)). And for ReLu activation function, Ïƒâ€²(wT
mx) =
1{wTmxâ‰¥0}. We assume that the activation does not change at an infinitely small change of t, implying
Ë™D(t) =0. Hence, we have
19dâˆ¥aTD(t)W(t)âˆ¥2
2
dt=aT
Ë™D(t)W(t)W(t)TD(t) +D(t)W(t)W(t)TË™D(t)
+D(t)Ë™W(t)W(t)TD(t) +D(t)W(t)Ë™W(t)TD(t)
a
=aT
D(t)Ë™W(t)W(t)TD(t) +D(t)W(t)Ë™W(t)TD(t)
a
= 2aTD(t)Î·tX
Ï„=1ï£«
ï£¬ï£­a1exT
1(Ï„)
...
amexT
m(Ï„)ï£¶
ï£·ï£¸(a1ex1(t)Â·Â·Â· amexm(t))D(t)a
| {z }
1
+ 2aTD(t)ï£«
ï£¬ï£­a1exT
1(t)
...
amexT
m(t)ï£¶
ï£·ï£¸W(0)TD(t)a
| {z }
2.
And similarly,
dâˆ¥D(t)W(t)âˆ¥2
2
dt=vT(t)
D(t)Ë™W(t)W(t)TD(t) +D(t)W(t)Ë™W(t)TD(t)
v(t)
= 2vT(t)D(t)Î·tX
Ï„=1ï£«
ï£¬ï£­a1exT
1(Ï„)
...
amexT
m(Ï„)ï£¶
ï£·ï£¸(a1ex1(t)Â·Â·Â· amexm(t))D(t)v(t)
| {z }
1â€²
+ 2vT(t)D(t)ï£«
ï£¬ï£­a1exT
1(t)
...
amexT
m(t)ï£¶
ï£·ï£¸W(0)TD(t)v(t)
| {z }
2â€².
1can be
1=Î·tX
Ï„=1mX
r=1a2
rÏƒâ€²(wr(Ï„)Tx)exT
r(Ï„) mX
r=1a2
rÏƒâ€²(wr(t)Tx)exr(t)
(106)
=Î·tX
Ï„=11
nnX
i=1mX
r=1h
a2
rÏƒâ€²(wr(Ï„)Tx)Ïƒâ€²(wr(Ï„)Txi)i
(yâˆ’sig(ui))xT
i
(107)
Â·1
nnX
i=1mX
r=1h
a2
rÏƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)i
(yâˆ’sig(ui))xi
. (108)
Since arâˆˆ {âˆ’1âˆšm,1âˆšm}and the derivative activation function Ïƒâ€²is bounded by Mby assumption,
we have that
PW(0)mX
r=1a2
rÏƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’Î±i(t;x)â‰¥Ïµ
(109)
=PW(0)1
mmX
r=1Ïƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’Î±i(t;x)â‰¥Ïµ
â‰¤2eâˆ’mÏµ2
2M4, (110)
20where
Î±i(t,x) =EW(0)h
Ïƒâ€²(w(t)Tx)Ïƒâ€²(w(t)Txi)i
. (111)
Equivalently, with probability at least 1âˆ’Î´, we have
mX
r=1a2
rÏƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’Î±i(t;x)â‰¤r
2M4
mlog2
Î´(112)
Let
exâˆ—(t)â–³=1
nnX
i=1Î±i(t,x) 
yiâˆ’sig(ui(t))
xi (113)
ex(t)â–³=1
nnX
i=1 
yiâˆ’sig(ui(t))
xi (114)
Hence, with probability at least 1âˆ’Î´,
1=Î·tX
Ï„=11
nnX
i=1Î±i(Ï„,x) 
yiâˆ’sig(ui(Ï„))
xT
i+Or
1
mlog2
Î´
ex(Ï„)T
(115)
Â·1
nnX
i=1Î±i(t,x) 
yiâˆ’sig(ui(t))
xi+Or
1
mlog2
Î´
ex(t)
(116)
=Î·tX
Ï„=1
exâˆ—(Ï„)T+Or
1
mlog2
Î´
ex(Ï„)T
Â·
exâˆ—(t) +Or
1
mlog2
Î´
ex(t)
(117)
=Î·tX
Ï„=1exâˆ—(Ï„)Texâˆ—(t) +Or
1
mlog2
Î´
ex(Ï„)Texâˆ—(t) (118)
+Or
1
mlog2
Î´
exâˆ—(Ï„)Tex(t) +O1
mlog2
Î´
ex(t)Tex(t). (119)
Since
âˆ¥exâˆ—(t)âˆ¥2â‰¤1
nï£«
ï£¬ï£­Î±1(Ï„,x) 
y1âˆ’sig(u1(t))
...
Î±n(Ï„,x) 
ynâˆ’sig(un(t))ï£¶
ï£·ï£¸
2ï£«
ï£¬ï£­xT
1...
xT
nï£¶
ï£·ï£¸
2â‰¤M2(120)
âˆ¥ex(t)âˆ¥2â‰¤1
nï£«
ï£¬ï£­y1âˆ’sig(u1(t))
...
ynâˆ’sig(un(t))ï£¶
ï£·ï£¸
2ï£«
ï£¬ï£­xT
1...
xT
nï£¶
ï£·ï£¸
2â‰¤1, (121)
we have that for at least 1âˆ’Î´,
1=Î·tX
Ï„=1exâˆ—(Ï„)Texâˆ—(t) +Or
1
mlog2
Î´
(122)
Similarly,
1â€²=Î·tX
Ï„=11
nnX
i=1mX
r=1h
vr(t)arÏƒâ€²(wr(Ï„)Tx)Ïƒâ€²(wr(Ï„)Txi)i
(yiâˆ’sig(ui))xT
i
(123)
Â·1
nnX
i=1mX
r=1h
vr(t)arÏƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)i
(yiâˆ’sig(ui))xi
, (124)
21Letaâˆ—=âˆšmaâˆˆ {âˆ’ 1,1}mand by the conclusion of lemma C.2,
PW(0)mX
r=1vr(t)arÏƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’mX
r=1vr(t)arÎ±i(t,x)â‰¥Ïµ
(125)
=PW(0)1âˆšmmX
r=1aâˆ—
rvr(t)Ïƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’aTv(t)Î±i(t;x)â‰¥Ïµ
(126)
â‰¤2 exp
âˆ’mÏµ2
2M4
. (127)
Equivalently, with probability at least 1âˆ’Î´,
1âˆšmmX
r=1aâˆ—
rvr(t)Ïƒâ€²(wr(t)Tx)Ïƒâ€²(wr(t)Txi)âˆ’aTv(t)Î±i(t;x)â‰¤r
2M4
mlog2
Î´. (128)
Hence,
1â€²=Î·tX
Ï„=11
nnX
i=1aTv(Ï„)Î±i(Ï„,x) 
yiâˆ’sig(ui(Ï„))
xT
i+Or
1
mlog2
Î´
ex(Ï„)T
(129)
Â·1
nnX
i=1aTv(t)Î±i(t,x) 
yiâˆ’sig(ui(t))
xi+Or
1
mlog2
Î´
ex(t)
(130)
=Î·tX
Ï„=1
aTv(Ï„)exâˆ—(Ï„)T+Or
1
mlog2
Î´
ex(Ï„)T
Â·
aTv(t)exâˆ—(t) +Or
1
mlog2
Î´
ex(t)
(131)
=Î·tX
Ï„=1aTv(Ï„)aTv(t)exâˆ—(Ï„)Texâˆ—(t) (132)
+Or
1
mlog2
Î´
ex(Ï„)Texâˆ—(t) +Or
1
mlog2
Î´
exâˆ—(Ï„)Tex(t) +O1
mlog2
Î´
ex(t)Tex(t).
(133)
We have that for at least 1âˆ’Î´,
1â€²=Î·tX
Ï„=1aTv(Ï„)aTv(t)exâˆ—(Ï„)Texâˆ—(t) +Or
1
mlog2
Î´
(134)
For 2, we have
|2|=aTD(t)ï£«
ï£¬ï£­a1exT
1(t)
...
amexT
m(t)ï£¶
ï£·ï£¸W(0)TD(t)a (135)
â‰¤ âˆ¥aTD(t)âˆ¥2
2(a1W(0)ex1(t)Â·Â·Â· amW(0)exm(t))
2(136)
â‰¤M2(a1W(0)ex1(t)Â·Â·Â· amW(0)exm(t))
F(137)
â‰¤M2vuutmX
r=1a2râˆ¥W(0)exrâˆ¥2
2, (138)
22where
âˆ¥W(0)exrâˆ¥2
2=1
nnX
i=1Ïƒâ€²(wr(0)Txi)(yiâˆ’sig(ui))W(0)xi2
2(139)
â‰¤1
n2ï£«
ï£¬ï£­Ïƒâ€²(wr(0)Tx1)(y1âˆ’sig(u1))
...
Ïƒâ€²(wr(0)Txn)(ynâˆ’sig(un))ï£¶
ï£·ï£¸2
2(W(0)x1Â·Â·Â· W(0)xn)2
2(140)
â‰¤1
n2nX
i=1Ïƒâ€²(wr(0)Txi)2(yiâˆ’sig(ui))2
| {z }
0â‰¤...â‰¤M2(W(0)x1Â·Â·Â· W(0)xn)2
F(141)
â‰¤M2
nnX
i=1âˆ¥W(0)xiâˆ¥2
2 (142)
Similar to the proof of the linear case, and accords to Lemma B.2, we have that with probability at
least1âˆ’Î´,
vuut1
nnX
i=1âˆ¥W(0)xiâˆ¥2
2=1
mq+Or
8 log(2 /Î´)
m1+2qn
. (143)
Therefore, with high probability,
|2| â‰¤M4vuutmX
r=1a2r1
nnX
i=1âˆ¥W(0)xiâˆ¥2
2 (144)
=M4vuut1
nnX
i=1âˆ¥W(0)xiâˆ¥2
2 (145)
=O1
mq
(146)
Follow the exact same procedure. With high probability, we have
|2â€²|=vT(t)D(t)ï£«
ï£¬ï£­a1exT
1(t)
...
amexT
m(t)ï£¶
ï£·ï£¸W(0)TD(t)v(t) (147)
â‰¤ âˆ¥v(t)TD(t)âˆ¥2
2(a1W(0)ex1(t)Â·Â·Â· amW(0)exm(t))
2(148)
â‰¤M2vuutmX
r=1a2râˆ¥W(0)exrâˆ¥2
2 (149)
=O1
mq
(150)
We put all the information together, with high probability, we have
Ë™Ï±a,Ïƒâ—¦W(t)â‰¥Ï±a,Ïƒâ—¦W(t)
Exâˆ¥D(t)W(t)âˆ¥2
2Ex
1âˆ’1â€²+2âˆ’2â€²
(151)
â‰¥Ï±a,Ïƒâ—¦W(t)
Exâˆ¥D(t)W(t)âˆ¥2
2
Î·tX
Ï„=1(1âˆ’aTv(Ï„)aTv(t))Exexâˆ—(Ï„)Texâˆ—(t)
(152)
+ max
O1
m1
2
,O1
mq
(153)
230 10 20 30 40 50 
Epoch0.0050.0100.0150.0200.0250.030
std/Âµ
width-16 
width-32 
width-64 
width-128 
width-256 
width-512 
width-1024 
width-2048 
width-4096 
width-8192(a) Relative Std
0 10 20 30 40 50 
Epoch0.999650.999720.999790.999860.999931.00000
â´ (b) Linear Correlation
Figure 5: Linear Correlation &Relative Std. The linear correlation and the standard deviation over
the mean are given for all MLPs with the initialization parameter q= 0.25.
4 5 6 7 8 9 10 11 12 13 
width(2
n
)0.00.30.6
tot 
Î”Ï±
a
,W
q=-0.15 
q=-0.1 
q=-0.05 
q=0 
q=0.05 
q=0.15 
q=0.254 5 6 7 8 9 10 11 12 13 
width0.00.30.6
tot 
Î”Ï±
a
,
Ïƒ
â—‹
W
Figure 6: The accumulation of co-correlation under different width. X-axis denotes the width of
the neural network, and the line in different color shows the result under different setting of weight
initialization. The lower plot is the result for linear model and the result for shallow ReLU is at the
top.
D Extra Experiment Results
Figure 5 summarizes the statistics of linear correlation and relative variability, illustrating that
co-correlation is the dominant factor in the decomposition outlined in Theorem 4.5.
Figure 6 shows the accumulated change in co-correlation during training across varying network
widths. Each line, represented by different colours, corresponds to a unique weight initialization
setting of q. A clear inference from the figure is the positive relationship between the accumulated
co-correlation change and network width under the same qâ€”the wider the network, the greater the
accumulated co-correlation change. Moreover, as we shift the weight initialization setting from
q=âˆ’0.15toq= 0.25, the accumulation of co-correlation also increases. These observations align
with our Theorem 5.3 and 5.5, indicating that the increase in co-correlation is inversely proportional
toâˆ¥W(t)âˆ¥2.
24E Algorithm
We use the Power Iteration algorithm [10] along with Functorch [17] to compute co-correlation and
other relevant statistics. This combination assists in approximating the L2-norm of the Jacobian
for the layers under consideration. The algorithm to estimate the related statistics including co-
correlation are outlined in Algorithm 1. The power iteration used to obtain the L2-norm of the
Jacobian is summarized in Algorithm 2.
Algorithm 1 Estimation of Related Statistics
Input : Input dataset and modules Ï•, Ï† for the given blocks in sequential {xi, i= 1, .., N}
Output : Approximation of co-correlations bÏ±Ï•,Ï†, linear correlation bÏÏ•,Ï†, mean bÂµÏ•,bÂµÏ†and variance
ÏƒÏ•, ÏƒÏ†of the Jacobian of the module w.r.t. their inputs
1:Computation of Jacobin of âˆ¥JÏ†(xi)âˆ¥2,âˆ¥JÏ•(Ï†(xi))âˆ¥2for{xi, iâˆˆ[n]}w.r.t. their inputs
2:bÏ±Ï•,Ï†â†1
NPN
i=1âˆ¥JÏ•(Ï†(xi))Â·JÏ†(xi)âˆ¥2
1
NPN
i=1âˆ¥JÏ•(Ï†(xi))âˆ¥2âˆ¥JÏ†(xi)âˆ¥2
3:bÏÏ•,Ï†â†1
NPN
i=1âˆ¥JÏ•(Ï†(xi))âˆ¥2âˆ¥JÏ†(xi)âˆ¥2 
1
NPN
i=1âˆ¥JÏ•(Ï†(xi))âˆ¥2
21
2 
1
NPN
i=1âˆ¥JÏ†(xi)âˆ¥2
21
2
4:bÂµÏ•â†1
NPN
i=1âˆ¥JÏ•(Ï†(xi))âˆ¥2âˆ¥JÏ†(xi)âˆ¥2
5:bÏƒÏ•â†1
Nâˆ’1PN
i=1(âˆ¥JÏ•(Ï†(xi))âˆ¥2âˆ¥JÏ†(xi)âˆ¥2âˆ’Ë†ÂµÏ•)21
2
Algorithm 2 Power Iteration Based Computation
Input : Input dataset and module for the given sequential blocks {xi, i= 1, .., N}, Ï•, Ï†
Output : Approximation of co-correlations Ï±Ï•,Ï†, linear correlation ÏÏ•,Ï†, mean ÂµÏ•, ÂµÏ†and variance
ÏƒÏ•, ÏƒÏ†of the Jacobian of the module w.r.t. their inputs
1:COMPUTATION OF âˆ¥JÏ†(xi)âˆ¥2FOR{xi, iâˆˆ[n]}
2:while iâ‰¤Nbdo
3: sample randomly uâˆ¼U([0,1])
4:uâ†u/âˆ¥uâˆ¥2
5: generate jacobian-vector product function jvp(Â·;xi)
6: generating vector-jacobian product function vjp(Â·;xi)
7:âˆ¥JÏ†(xi)âˆ¥old
2â†None
8: while errâ‰¥10âˆ’6do
9: vâ†jvp(u;xi)
10: uâ†vjp(v;xi)
11: uâ†u/âˆ¥uâˆ¥2
12: vâ†v/âˆ¥vâˆ¥2
13: âˆ¥JÏ†(xi)âˆ¥new
2â†u/âˆ¥uâˆ¥2
v/âˆ¥vâˆ¥2
14: ifâˆ¥JÏ†(xi)âˆ¥old
2Ì¸=None then
15: err=âˆ¥JÏ†(xi)âˆ¥new
2âˆ’âˆ¥JÏ†(xi)âˆ¥old
2
âˆ¥JÏ†(xi)âˆ¥old
2
16: end if
17: âˆ¥JÏ†(xi)âˆ¥old
2=âˆ¥JÏ†(xi)âˆ¥new
2
18: end while
19:end while
25NeurIPS Paper Checklist
1.Claims
Question: Do the main claims made in the abstract and introduction accurately reflect the
paperâ€™s contributions and scope?
Answer: [Yes]
Justification: The abstract and introduction have clearly stated the claims made, including
the contributions made in the paper.
Guidelines:
â€¢The answer NA means that the abstract and introduction do not include the claims
made in the paper.
â€¢The abstract and/or introduction should clearly state the claims made, including the
contributions made in the paper and important assumptions and limitations. A No or
NA answer to this question will not be perceived well by the reviewers.
â€¢The claims made should match theoretical and experimental results, and reflect how
much the results can be expected to generalize to other settings.
â€¢It is fine to include aspirational goals as motivation as long as it is clear that these goals
are not attained by the paper.
2.Limitations
Question: Does the paper discuss the limitations of the work performed by the authors?
Answer: [Yes]
Justification: A separate section "Discussion and Limitations" has been designed and can be
seen in the end of this paper.
Guidelines:
â€¢The answer NA means that the paper has no limitation while the answer No means that
the paper has limitations, but those are not discussed in the paper.
â€¢ The authors are encouraged to create a separate "Limitations" section in their paper.
â€¢The paper should point out any strong assumptions and how robust the results are to
violations of these assumptions (e.g., independence assumptions, noiseless settings,
model well-specification, asymptotic approximations only holding locally). The authors
should reflect on how these assumptions might be violated in practice and what the
implications would be.
â€¢The authors should reflect on the scope of the claims made, e.g., if the approach was
only tested on a few datasets or with a few runs. In general, empirical results often
depend on implicit assumptions, which should be articulated.
â€¢The authors should reflect on the factors that influence the performance of the approach.
For example, a facial recognition algorithm may perform poorly when image resolution
is low or images are taken in low lighting. Or a speech-to-text system might not be
used reliably to provide closed captions for online lectures because it fails to handle
technical jargon.
â€¢The authors should discuss the computational efficiency of the proposed algorithms
and how they scale with dataset size.
â€¢If applicable, the authors should discuss possible limitations of their approach to
address problems of privacy and fairness.
â€¢While the authors might fear that complete honesty about limitations might be used by
reviewers as grounds for rejection, a worse outcome might be that reviewers discover
limitations that arenâ€™t acknowledged in the paper. The authors should use their best
judgment and recognize that individual actions in favor of transparency play an impor-
tant role in developing norms that preserve the integrity of the community. Reviewers
will be specifically instructed to not penalize honesty concerning limitations.
3.Theory Assumptions and Proofs
Question: For each theoretical result, does the paper provide the full set of assumptions and
a complete (and correct) proof?
26Answer: [Yes]
Justification: The complete proofs are provided in the appendix. Theorems and Lemmas are
properly referenced in this paper.
Guidelines:
â€¢ The answer NA means that the paper does not include theoretical results.
â€¢All the theorems, formulas, and proofs in the paper should be numbered and cross-
referenced.
â€¢All assumptions should be clearly stated or referenced in the statement of any theorems.
â€¢The proofs can either appear in the main paper or the supplemental material, but if
they appear in the supplemental material, the authors are encouraged to provide a short
proof sketch to provide intuition.
â€¢Inversely, any informal proof provided in the core of the paper should be complemented
by formal proofs provided in appendix or supplemental material.
â€¢ Theorems and Lemmas that the proof relies upon should be properly referenced.
4.Experimental Result Reproducibility
Question: Does the paper fully disclose all the information needed to reproduce the main ex-
perimental results of the paper to the extent that it affects the main claims and/or conclusions
of the paper (regardless of whether the code and data are provided or not)?
Answer: [Yes]
Justification: The algorithm and detailed experiment settings are provided.
Guidelines: The code is provided in the supplemental material.
â€¢ The answer NA means that the paper does not include experiments.
â€¢If the paper includes experiments, a No answer to this question will not be perceived
well by the reviewers: Making the paper reproducible is important, regardless of
whether the code and data are provided or not.
â€¢If the contribution is a dataset and/or model, the authors should describe the steps taken
to make their results reproducible or verifiable.
â€¢Depending on the contribution, reproducibility can be accomplished in various ways.
For example, if the contribution is a novel architecture, describing the architecture fully
might suffice, or if the contribution is a specific model and empirical evaluation, it may
be necessary to either make it possible for others to replicate the model with the same
dataset, or provide access to the model. In general. releasing code and data is often
one good way to accomplish this, but reproducibility can also be provided via detailed
instructions for how to replicate the results, access to a hosted model (e.g., in the case
of a large language model), releasing of a model checkpoint, or other means that are
appropriate to the research performed.
â€¢While NeurIPS does not require releasing code, the conference does require all submis-
sions to provide some reasonable avenue for reproducibility, which may depend on the
nature of the contribution. For example
(a)If the contribution is primarily a new algorithm, the paper should make it clear how
to reproduce that algorithm.
(b)If the contribution is primarily a new model architecture, the paper should describe
the architecture clearly and fully.
(c)If the contribution is a new model (e.g., a large language model), then there should
either be a way to access this model for reproducing the results or a way to reproduce
the model (e.g., with an open-source dataset or instructions for how to construct
the dataset).
(d)We recognize that reproducibility may be tricky in some cases, in which case
authors are welcome to describe the particular way they provide for reproducibility.
In the case of closed-source models, it may be that access to the model is limited in
some way (e.g., to registered users), but it should be possible for other researchers
to have some path to reproducing or verifying the results.
5.Open access to data and code
27Question: Does the paper provide open access to the data and code, with sufficient instruc-
tions to faithfully reproduce the main experimental results, as described in supplemental
material?
Answer: [Yes]
Justification: The code is uploaded in github, including detailed README file.
Guidelines:
â€¢ The answer NA means that paper does not include experiments requiring code.
â€¢Please see the NeurIPS code and data submission guidelines ( https://nips.cc/
public/guides/CodeSubmissionPolicy ) for more details.
â€¢While we encourage the release of code and data, we understand that this might not be
possible, so â€œNoâ€ is an acceptable answer. Papers cannot be rejected simply for not
including code, unless this is central to the contribution (e.g., for a new open-source
benchmark).
â€¢The instructions should contain the exact command and environment needed to run to
reproduce the results. See the NeurIPS code and data submission guidelines ( https:
//nips.cc/public/guides/CodeSubmissionPolicy ) for more details.
â€¢The authors should provide instructions on data access and preparation, including how
to access the raw data, preprocessed data, intermediate data, and generated data, etc.
â€¢The authors should provide scripts to reproduce all experimental results for the new
proposed method and baselines. If only a subset of experiments are reproducible, they
should state which ones are omitted from the script and why.
â€¢At submission time, to preserve anonymity, the authors should release anonymized
versions (if applicable).
â€¢Providing as much information as possible in supplemental material (appended to the
paper) is recommended, but including URLs to data and code is permitted.
6.Experimental Setting/Details
Question: Does the paper specify all the training and test details (e.g., data splits, hyper-
parameters, how they were chosen, type of optimizer, etc.) necessary to understand the
results?
Answer: [Yes]
Justification: All details can be checked in Experiment section.
Guidelines:
â€¢ The answer NA means that the paper does not include experiments.
â€¢The experimental setting should be presented in the core of the paper to a level of detail
that is necessary to appreciate the results and make sense of them.
â€¢The full details can be provided either with the code, in appendix, or as supplemental
material.
7.Experiment Statistical Significance
Question: Does the paper report error bars suitably and correctly defined or other appropriate
information about the statistical significance of the experiments?
Answer: [Yes]
Justification: The detailed methods can be found in Experiment section.
Guidelines:
â€¢ The answer NA means that the paper does not include experiments.
â€¢The authors should answer "Yes" if the results are accompanied by error bars, confi-
dence intervals, or statistical significance tests, at least for the experiments that support
the main claims of the paper.
â€¢The factors of variability that the error bars are capturing should be clearly stated (for
example, train/test split, initialization, random drawing of some parameter, or overall
run with given experimental conditions).
â€¢The method for calculating the error bars should be explained (closed form formula,
call to a library function, bootstrap, etc.)
28â€¢ The assumptions made should be given (e.g., Normally distributed errors).
â€¢It should be clear whether the error bar is the standard deviation or the standard error
of the mean.
â€¢It is OK to report 1-sigma error bars, but one should state it. The authors should
preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis
of Normality of errors is not verified.
â€¢For asymmetric distributions, the authors should be careful not to show in tables or
figures symmetric error bars that would yield results that are out of range (e.g. negative
error rates).
â€¢If error bars are reported in tables or plots, The authors should explain in the text how
they were calculated and reference the corresponding figures or tables in the text.
8.Experiments Compute Resources
Question: For each experiment, does the paper provide sufficient information on the com-
puter resources (type of compute workers, memory, time of execution) needed to reproduce
the experiments?
Answer: [Yes]
Justification: The paper introduces the configuration of the computer in Experiment section.
Guidelines:
â€¢ The answer NA means that the paper does not include experiments.
â€¢The paper should indicate the type of compute workers CPU or GPU, internal cluster,
or cloud provider, including relevant memory and storage.
â€¢The paper should provide the amount of compute required for each of the individual
experimental runs as well as estimate the total compute.
â€¢The paper should disclose whether the full research project required more compute
than the experiments reported in the paper (e.g., preliminary or failed experiments that
didnâ€™t make it into the paper).
9.Code Of Ethics
Question: Does the research conducted in the paper conform, in every respect, with the
NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines ?
Answer: [Yes]
Justification: We have read the NeurIPS Code of Ethics and confirm that the research
conforms in every respect.
Guidelines:
â€¢The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.
â€¢If the authors answer No, they should explain the special circumstances that require a
deviation from the Code of Ethics.
â€¢The authors should make sure to preserve anonymity (e.g., if there is a special consid-
eration due to laws or regulations in their jurisdiction).
10.Broader Impacts
Question: Does the paper discuss both potential positive societal impacts and negative
societal impacts of the work performed?
Answer: [NA]
Justification: There is no societal impact of the work performed. This is a theoretical paper
to understand existing ML methods.
Guidelines:
â€¢ The answer NA means that there is no societal impact of the work performed.
â€¢If the authors answer NA or No, they should explain why their work has no societal
impact or why the paper does not address societal impact.
â€¢Examples of negative societal impacts include potential malicious or unintended uses
(e.g., disinformation, generating fake profiles, surveillance), fairness considerations
(e.g., deployment of technologies that could make decisions that unfairly impact specific
groups), privacy considerations, and security considerations.
29â€¢The conference expects that many papers will be foundational research and not tied
to particular applications, let alone deployments. However, if there is a direct path to
any negative applications, the authors should point it out. For example, it is legitimate
to point out that an improvement in the quality of generative models could be used to
generate deepfakes for disinformation. On the other hand, it is not needed to point out
that a generic algorithm for optimizing neural networks could enable people to train
models that generate Deepfakes faster.
â€¢The authors should consider possible harms that could arise when the technology is
being used as intended and functioning correctly, harms that could arise when the
technology is being used as intended but gives incorrect results, and harms following
from (intentional or unintentional) misuse of the technology.
â€¢If there are negative societal impacts, the authors could also discuss possible mitigation
strategies (e.g., gated release of models, providing defenses in addition to attacks,
mechanisms for monitoring misuse, mechanisms to monitor how a system learns from
feedback over time, improving the efficiency and accessibility of ML).
11.Safeguards
Question: Does the paper describe safeguards that have been put in place for responsible
release of data or models that have a high risk for misuse (e.g., pretrained language models,
image generators, or scraped datasets)?
Answer: [NA]
Justification: The paper poses no such risks.
Guidelines:
â€¢ The answer NA means that the paper poses no such risks.
â€¢Released models that have a high risk for misuse or dual-use should be released with
necessary safeguards to allow for controlled use of the model, for example by requiring
that users adhere to usage guidelines or restrictions to access the model or implementing
safety filters.
â€¢Datasets that have been scraped from the Internet could pose safety risks. The authors
should describe how they avoided releasing unsafe images.
â€¢We recognize that providing effective safeguards is challenging, and many papers do
not require this, but we encourage authors to take this into account and make a best
faith effort.
12.Licenses for existing assets
Question: Are the creators or original owners of assets (e.g., code, data, models), used in
the paper, properly credited and are the license and terms of use explicitly mentioned and
properly respected?
Answer: [Yes]
Justification: We have cited the original paper that produced the code package or dataset
properly.
Guidelines:
â€¢ The answer NA means that the paper does not use existing assets.
â€¢ The authors should cite the original paper that produced the code package or dataset.
â€¢The authors should state which version of the asset is used and, if possible, include a
URL.
â€¢ The name of the license (e.g., CC-BY 4.0) should be included for each asset.
â€¢For scraped data from a particular source (e.g., website), the copyright and terms of
service of that source should be provided.
â€¢If assets are released, the license, copyright information, and terms of use in the
package should be provided. For popular datasets, paperswithcode.com/datasets
has curated licenses for some datasets. Their licensing guide can help determine the
license of a dataset.
â€¢For existing datasets that are re-packaged, both the original license and the license of
the derived asset (if it has changed) should be provided.
30â€¢If this information is not available online, the authors are encouraged to reach out to
the assetâ€™s creators.
13.New Assets
Question: Are new assets introduced in the paper well documented and is the documentation
provided alongside the assets?
Answer: [NA]
Justification: The paper does not release new assets.
Guidelines:
â€¢ The answer NA means that the paper does not release new assets.
â€¢Researchers should communicate the details of the dataset/code/model as part of their
submissions via structured templates. This includes details about training, license,
limitations, etc.
â€¢The paper should discuss whether and how consent was obtained from people whose
asset is used.
â€¢At submission time, remember to anonymize your assets (if applicable). You can either
create an anonymized URL or include an anonymized zip file.
14.Crowdsourcing and Research with Human Subjects
Question: For crowdsourcing experiments and research with human subjects, does the paper
include the full text of instructions given to participants and screenshots, if applicable, as
well as details about compensation (if any)?
Answer: [NA]
Justification: The paper does not involve crowdsourcing nor research with human subjects.
Guidelines:
â€¢The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
â€¢Including this information in the supplemental material is fine, but if the main contribu-
tion of the paper involves human subjects, then as much detail as possible should be
included in the main paper.
â€¢According to the NeurIPS Code of Ethics, workers involved in data collection, curation,
or other labor should be paid at least the minimum wage in the country of the data
collector.
15.Institutional Review Board (IRB) Approvals or Equivalent for Research with Human
Subjects
Question: Does the paper describe potential risks incurred by study participants, whether
such risks were disclosed to the subjects, and whether Institutional Review Board (IRB)
approvals (or an equivalent approval/review based on the requirements of your country or
institution) were obtained?
Answer: [NA]
Justification: The paper does not involve crowdsourcing nor research with human subjects.
Guidelines:
â€¢The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
â€¢Depending on the country in which research is conducted, IRB approval (or equivalent)
may be required for any human subjects research. If you obtained IRB approval, you
should clearly state this in the paper.
â€¢We recognize that the procedures for this may vary significantly between institutions
and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the
guidelines for their institution.
â€¢For initial submissions, do not include any information that would break anonymity (if
applicable), such as the institution conducting the review.
31